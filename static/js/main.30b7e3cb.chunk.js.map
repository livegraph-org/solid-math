{"version":3,"sources":["components/Visualization.tsx","contexts/session.ts","components/LoginPrompt.tsx","components/Login.tsx","helpers/draw.ts","hooks/graph.ts","simulation/index.ts","simulation/gravity.ts","algorithms.ts","components/Math.tsx","components/Statement.tsx","dataTest.ts","components/VisualizationContainer.tsx","components/DataContainer.tsx","components/PeopleList.tsx","components/About.tsx","components/Layout.tsx","App.tsx","reportWebVitals.ts","components/SessionProvider.tsx","index.tsx"],"names":["old","SessionContext","createContext","LoginPrompt","onLogin","props","useState","promptOpen","setPromptOpen","localStorage","getItem","idp","setIdp","isOpen","onRequestClose","contentLabel","overlayClassName","base","afterOpen","beforeClose","className","closeTimeoutMS","onClick","onSubmit","e","preventDefault","setItem","id","type","value","onChange","newValue","currentTarget","placeholder","Login","loading","setLoading","useContext","info","setInfo","useEffect","handleIncomingRedirect","url","window","location","href","restorePreviousSession","then","newInfo","catch","console","log","finally","handleLogin","oidcIssuer","a","login","redirectUrl","clientName","alert","removeItem","handleLogout","logout","commonProps","disabled","isLoggedIn","webId","drawText","context","text","options","x","y","font","textBaseline","textAlign","Object","assign","fillText","drawCircle","radius","beginPath","arc","Math","PI","fill","drawLine","start","end","moveTo","lineTo","stroke","Visualization","graph","grid","onTransform","onHover","onSelectNode","canvasEl","useRef","width","height","setVisualizationSize","current","getContext","offset","save","translate","clearRect","strokeStyle","min1","max1","min0","max0","getLineWidth","i","highlight","distance","origin","lineWidth","drawGrid","links","forEach","link","s","source","t","target","v","numeric","sub","size","sqrt","div","add","mul","r","accentedColor","accented","nodes","filter","style","focused","rest","fillStyle","label","restore","updateCanvasSize","elementRef","clientHeight","clientWidth","getElementSize","addEventListener","removeEventListener","select","call","drag","clickDistance","on","dx","dy","zoom","scaleExtent","transform","k","dot","inv","withCanvasPosition","func","rect","getBoundingClientRect","clientX","left","clientY","top","handleMouseMove","handleClick","ref","onMouseMove","onMouseOut","Infinity","classnames","ensureNode","uri","description","dependencies","dependents","fetchGraph","getSolidDataset","fetch","dataset","things","getThingAll","thing","asUrl","getTerm","rdf","dct","rdfs","getTermAll","reduce","dependency","keys","dependencyUri","useGraph","uris","setGraph","data","Simulation","runs","simulation","forceSimulation","alphaDecay","force","forceLink","node","strength","alpha","d","vy","optimumDifference","_","forceGravity","forceManyBody","distanceMax","forceX","forceY","forceCollide","forceCenter","stop","onTick","map","restart","update","thisNodeDict","fromEntries","updatedNodes","random","selectNode","find","prune","input","graphlib","Graph","values","setNode","setEdge","output","entries","alg","isAcyclic","Error","edges","edge","removeEdge","dijkstra","w","pruneCore","Styler","styled","children","remarkPlugins","remarkMath","rehypePlugins","rehypeKatex","Statement","position","bottom","pointerEvents","overflowY","overflowX","length","dependent","findMathDocumentsOfPerson","me","getThing","publicTypeIndex","solid","index","mathDocuments","forClass","includes","instance","flat","findFriends","getResourceUrl","person","friends","foaf","knows","resourceUrl","URL","hash","matrix","vector","raw","transpose","nodeRadius","count","basicGrid","VisualizationContainer","documents","setDocuments","layout","setLayout","highlightedNode","setHighlightedNode","selectedNode","setSelectedNode","docs","setMatrix","lastUpdate","Date","now","prunedOrFullGraph","pruneGraph","push","withNode","action","handleHover","handleSelect","selectedNodeDependencies","selectedNodeUri","selectNodeDependencies","transformedLayout","highlighted","selected","selectedDependencies","transformedNodesDict","sourceUri","targetUri","transformLayout","transformGrid","prevMatrix","PeopleContext","DocumentsContext","DataContainer","people","setPeople","setMathDocuments","state","notAddedYet","doc","stateDoc","owner","access","Provider","PeopleList","Link","Footer","footer","About","PositionedLogin","PositionedAbout","PositionedPeopleList","FullSizeVisualization","Layout","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","SessionProvider","sessionInfo","setSessionInfo","document","appElement","querySelector","Modal","setAppElement","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.30b7e3cb.chunk.js","sourcesContent":["import React, { useRef, useEffect, useState } from 'react'\nimport {\n  Vector,\n  Grid,\n  drawGrid,\n  drawCircle,\n  drawLine,\n  drawText,\n} from '../helpers/draw'\nimport classnames from 'classnames'\nimport { drag } from 'd3-drag'\nimport { zoom } from 'd3-zoom'\nimport { select } from 'd3-selection'\nimport numeric from 'numeric'\nimport { VisualizationGraph } from './VisualizationContainer'\n\ntype Props = Partial<React.CanvasHTMLAttributes<HTMLCanvasElement>> & {\n  graph: VisualizationGraph\n  grid: Grid\n  onTransform: (matrix: number[][]) => void\n  onHover: (position: Vector) => void\n  onSelectNode: (position: Vector) => void\n}\n\nlet old: number[][]\n\nconst Visualization: React.FC<Props> = ({\n  graph,\n  grid,\n  onTransform,\n  onHover,\n  onSelectNode,\n  ...props\n}: Props) => {\n  const canvasEl = useRef<HTMLCanvasElement>(null)\n  const [{ width, height }, setVisualizationSize] = useState({\n    width: 0,\n    height: 0,\n  })\n\n  useEffect(() => {\n    if (canvasEl && canvasEl.current) {\n      const context = canvasEl.current.getContext('2d')\n      if (context) {\n        const offset: Vector = [width / 2, height / 2]\n        context.save()\n        context.translate(...offset)\n        context.clearRect(-offset[0], -offset[1], width, height)\n        drawGrid(context, grid, width, height, offset)\n        graph.links.forEach(link => {\n          // we're counting a unit vector to make links that don't overlap nodes\n          // source point\n          const s = [link.source.x, link.source.y]\n          // target point\n          const t = [link.target.x, link.target.y]\n          // vector\n          const v = numeric.sub(t, s)\n          // vector size\n          const size = Math.sqrt(v[0] ** 2 + v[1] ** 2)\n          // unit vector\n          const i = numeric.div(v, size)\n          drawLine(\n            context,\n            // links don't overlap circles\n            numeric.add(s, numeric.mul(i, link.source.r)) as Vector,\n            numeric.sub(t, numeric.mul(i, link.target.r)) as Vector,\n            {\n              strokeStyle: 'white',\n              lineWidth: 0.5,\n            },\n          )\n        })\n\n        const accentedColor = 'violet' // '#ff5d'\n        const focusedColor = 'red'\n        const accented = graph.nodes.filter(({ style }) => style === 'accent')\n        const focused = graph.nodes.filter(({ style }) => style === 'focus')\n        const rest = graph.nodes.filter(({ style }) => !style)\n\n        // draw all the nodes which are not special\n        rest.forEach(({ x, y, r }) =>\n          drawCircle(context, [x, y], r, { fillStyle: '#fff8' }),\n        )\n\n        rest.forEach(({ x, y, r, label }) =>\n          drawText(context, [x + r + 5, y], label, { fillStyle: '#fff4' }),\n        )\n\n        // draw accented nodes\n        accented.forEach(({ x, y, r }) =>\n          drawCircle(context, [x, y], r, { fillStyle: accentedColor }),\n        )\n\n        accented.forEach(({ x, y, r, label }) =>\n          drawText(context, [x + r + 5, y], label, {\n            fillStyle: accentedColor,\n          }),\n        )\n\n        // draw accented nodes\n        focused.forEach(({ x, y, r }) =>\n          drawCircle(context, [x, y], r, { fillStyle: focusedColor }),\n        )\n\n        focused.forEach(({ x, y, r, label }) =>\n          drawText(context, [x + r + 5, y], label, { fillStyle: focusedColor }),\n        )\n\n        return () => context.restore()\n      }\n    }\n  }, [width, height, graph, canvasEl, grid])\n\n  useEffect(() => {\n    const updateCanvasSize = () => {\n      if (canvasEl && canvasEl.current) {\n        const size = getElementSize(canvasEl)\n        setVisualizationSize(size)\n      }\n    }\n\n    updateCanvasSize()\n    window.addEventListener('load', updateCanvasSize)\n    window.addEventListener('resize', updateCanvasSize)\n\n    return () => {\n      window.removeEventListener('resize', updateCanvasSize)\n      window.removeEventListener('load', updateCanvasSize)\n    }\n  }, [width, height, canvasEl])\n\n  useEffect(() => {\n    if (canvasEl && canvasEl.current) {\n      select(canvasEl.current).call(\n        drag<HTMLCanvasElement, unknown>()\n          .clickDistance(2)\n          //.on('start', console.log)\n          .on('drag', e => {\n            onTransform([\n              [1, 0, e.dx],\n              [0, 1, e.dy],\n              [0, 0, 1],\n            ])\n          }),\n        //.on('end', console.log),\n      )\n\n      select(canvasEl.current).call(\n        zoom<HTMLCanvasElement, unknown>()\n          .clickDistance(2)\n          .scaleExtent([0.05, 3])\n          .on('zoom', e => {\n            old = old ?? [\n              [1, 0, -width / 2],\n              [0, 1, -height / 2],\n              [0, 0, 1],\n            ]\n            const { x, y, k } = e.transform\n\n            const zoom = [\n              [k, 0, x - width / 2],\n              [0, k, y - height / 2],\n              [0, 0, 1],\n            ]\n\n            const transform = numeric.dot(zoom, numeric.inv(old)) as number[][]\n            old = zoom\n\n            onTransform(transform)\n          }),\n      )\n    }\n  }, [canvasEl, onTransform, height, width])\n\n  const withCanvasPosition =\n    (\n      func: (position: Vector) => void,\n    ): React.MouseEventHandler<HTMLCanvasElement> =>\n    e => {\n      // https://stackoverflow.com/a/42111623\n      if (canvasEl && canvasEl.current) {\n        const rect = canvasEl.current.getBoundingClientRect()\n        const x = e.clientX - rect.left //x position within the element.\n        const y = e.clientY - rect.top //y position within the element.\n        func([x - width / 2, y - height / 2])\n      }\n    }\n\n  const handleMouseMove = withCanvasPosition(onHover)\n  const handleClick = withCanvasPosition(onSelectNode)\n\n  return (\n    <canvas\n      {...props}\n      ref={canvasEl}\n      onMouseMove={handleMouseMove}\n      // @TODO this piece is very inefficient, we search for a nonexistent node, just to unhighlight everything; but it works\n      onMouseOut={() => onHover([Infinity, Infinity])}\n      width={width}\n      height={height}\n      className={classnames(props.className, 'has-background-dark')}\n      onClick={handleClick}\n    />\n  )\n}\n\nexport default Visualization\n\nfunction getElementSize(elementRef: React.RefObject<HTMLCanvasElement>) {\n  if (elementRef && elementRef.current) {\n    const { clientHeight: height, clientWidth: width } = elementRef.current\n    return { height, width }\n  } else return { height: 0, width: 0 }\n}\n","import { ISessionInfo } from '@inrupt/solid-client-authn-browser'\nimport React, { createContext } from 'react'\n\nexport type SessionInfo = Required<ISessionInfo>\nexport const SessionContext = createContext<\n  [SessionInfo | null, React.Dispatch<React.SetStateAction<SessionInfo | null>>]\n>([\n  null,\n  () => {\n    return\n  },\n])\n","import React, { useState } from 'react'\nimport Modal from 'react-modal'\n\ninterface Props {\n  onLogin: (oidcIssuer: string) => void\n}\n\nconst LoginPrompt: React.FC<Props> = ({ onLogin, ...props }: Props) => {\n  const [promptOpen, setPromptOpen] = useState(false)\n  const [idp, setIdp] = useState(\n    localStorage.getItem('idp') ?? 'https://solidcommunity.net',\n  )\n\n  const onSubmit: React.FormEventHandler = e => {\n    e.preventDefault()\n    localStorage.setItem('idp', idp)\n    onLogin(idp)\n  }\n\n  const onChangeInput = (e: React.FormEvent<HTMLInputElement>) => {\n    e.preventDefault()\n    const newValue = e.currentTarget.value\n    setIdp(newValue)\n  }\n\n  if (!promptOpen) {\n    return (\n      <>\n        <button\n          {...props}\n          onClick={e => {\n            e.preventDefault()\n            setPromptOpen(true)\n          }}\n        >\n          Login\n        </button>\n      </>\n    )\n  }\n\n  return (\n    <>\n      <Modal\n        isOpen={promptOpen}\n        onRequestClose={() => setPromptOpen(false)}\n        contentLabel=\"Connect your Solid Pod\"\n        overlayClassName={{\n          base: 'modal modal-background is-active',\n          afterOpen: '',\n          beforeClose: '',\n        }}\n        className={{\n          base: 'modal-content',\n          afterOpen: '',\n          beforeClose: '',\n        }}\n        closeTimeoutMS={50}\n      >\n        <button className=\"modal-close\" onClick={() => setPromptOpen(false)}>\n          close\n        </button>\n\n        <div className=\"card\">\n          <header className=\"card-header\">\n            <p className=\"card-header-title\">\n              Select your Solid identity provider\n            </p>\n          </header>\n          <div className=\"card-content\">\n            <form onSubmit={onSubmit}>\n              <div className=\"field\">\n                <div className=\"control\">\n                  <input\n                    id=\"idp\"\n                    className=\"input\"\n                    type=\"url\"\n                    value={idp}\n                    onChange={onChangeInput}\n                    placeholder=\"Where is your Solid Pod?\"\n                  />\n                </div>\n              </div>\n              <div className=\"field\">\n                <div className=\"control\">\n                  <input\n                    type=\"submit\"\n                    value=\"Connect\"\n                    className=\"button is-link\"\n                  />\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </Modal>\n    </>\n  )\n}\n\nexport default LoginPrompt\n","import React, { useState, useEffect, useContext } from 'react'\nimport {\n  login,\n  logout,\n  handleIncomingRedirect,\n} from '@inrupt/solid-client-authn-browser'\nimport { SessionContext, SessionInfo } from '../contexts/session'\nimport LoginPrompt from './LoginPrompt'\n\ninterface Props {\n  className?: string\n}\n\nconst Login: React.FC<Props> = (\n  { className, ...props }: Props = { className: '' },\n) => {\n  const [loading, setLoading] = useState(true)\n  const [info, setInfo] = useContext(SessionContext)\n  useEffect(() => {\n    setLoading(true)\n    handleIncomingRedirect({\n      url: window.location.href,\n      restorePreviousSession: true,\n    })\n      .then(newInfo => {\n        if (newInfo) setInfo(newInfo as SessionInfo)\n      })\n      .catch(e => {\n        console.log(e)\n        setInfo(null)\n      })\n      .finally(() => {\n        setLoading(false)\n      })\n  }, [setInfo])\n\n  const handleLogin = async (oidcIssuer: string) => {\n    setLoading(true)\n    try {\n      await login({\n        oidcIssuer,\n        redirectUrl: window.location.href,\n        clientName: 'Friends Crawler',\n      })\n    } catch (error) {\n      alert(`Could not find a Solid Pod at ${oidcIssuer}`)\n      localStorage.removeItem('idp')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleLogout = async () => {\n    setLoading(true)\n    await logout()\n    if (setInfo) setInfo(null)\n    setLoading(false)\n  }\n\n  const commonProps = {\n    ...props,\n    className: `${className} button`,\n  }\n\n  return loading ? (\n    <button {...commonProps} disabled>\n      Loading\n    </button>\n  ) : info?.isLoggedIn ? (\n    <button {...commonProps} onClick={handleLogout}>\n      {info?.webId} Logout\n    </button>\n  ) : (\n    <LoginPrompt {...commonProps} onLogin={handleLogin} />\n  )\n}\n\nexport default Login\n","export type Vector = [number, number]\n\nexport type Grid = {\n  origin: Vector // coordinate of the origin\n  distance: number // distance between lines\n  highlight: number // which lines should be highlighted\n}\n\ntype Options = Partial<CanvasRenderingContext2D>\n\nexport const drawText = (\n  context: CanvasRenderingContext2D,\n  [x, y]: Vector,\n  text: string,\n  options: Options,\n) => {\n  context.font = '20px Arial'\n  context.textBaseline = 'middle'\n  context.textAlign = 'left'\n  // context.fillStyle = '#fff7'\n  Object.assign(context, options)\n  context.fillText(text, x, y)\n}\n\nexport const drawCircle = (\n  context: CanvasRenderingContext2D,\n  [x, y]: Vector,\n  radius: number,\n  options: Options,\n) => {\n  Object.assign(context, options)\n  context.beginPath()\n  context.arc(x, y, radius, 0, 2 * Math.PI)\n  context.fill()\n}\n\nexport const drawLine = (\n  context: CanvasRenderingContext2D,\n  start: Vector,\n  end: Vector,\n  options: Options,\n) => {\n  Object.assign(context, options)\n\n  context.beginPath()\n  context.moveTo(...start)\n  context.lineTo(...end)\n  context.stroke()\n}\n\nexport const drawGrid = (\n  context: CanvasRenderingContext2D,\n  grid: Grid,\n  width: number,\n  height: number,\n  offset: Vector = [0, 0],\n) => {\n  const strokeStyle = '#fff2'\n  const min1 = -offset[1]\n  const max1 = height - offset[1]\n  const min0 = -offset[0]\n  const max0 = width - offset[0]\n\n  const getLineWidth = (i: number) =>\n    i === 0 ? 2 : i % grid.highlight === 0 ? 1 : 0.5\n\n  let i = 0\n  while (i * grid.distance + grid.origin[0] <= max0) {\n    const x = i * grid.distance + grid.origin[0]\n    if (x >= min0) {\n      drawLine(context, [x, min1], [x, max1], {\n        strokeStyle,\n        lineWidth: getLineWidth(i),\n      })\n    }\n    i++\n  }\n\n  i = -1\n  while (i * grid.distance + grid.origin[0] >= min0) {\n    const x = i * grid.distance + grid.origin[0]\n    if (x <= max0) {\n      drawLine(context, [x, min1], [x, max1], {\n        strokeStyle,\n        lineWidth: getLineWidth(i),\n      })\n    }\n    i--\n  }\n\n  i = 0\n  while (i * grid.distance + grid.origin[1] <= max1) {\n    const y = i * grid.distance + grid.origin[1]\n    if (y >= min1) {\n      drawLine(context, [min0, y], [max0, y], {\n        strokeStyle,\n        lineWidth: getLineWidth(i),\n      })\n    }\n    i++\n  }\n\n  i = -1\n  while (i * grid.distance + grid.origin[1] >= min1) {\n    const y = i * grid.distance + grid.origin[1]\n    if (y <= max1) {\n      drawLine(context, [min0, y], [max0, y], {\n        strokeStyle,\n        lineWidth: getLineWidth(i),\n      })\n    }\n    i--\n  }\n}\n","import { useState, useEffect } from 'react'\nimport {\n  getSolidDataset,\n  UrlString,\n  getThingAll,\n  getTermAll,\n  getTerm,\n  asUrl,\n} from '@inrupt/solid-client'\nimport { fetch } from '@inrupt/solid-client-authn-browser'\nimport { rdf, dct, rdfs } from 'rdf-namespaces'\n\nexport type GraphNode = {\n  type: UrlString\n  uri: UrlString\n  description: string\n  label: string\n  dependencies: {\n    [uri: string]: GraphNode\n  }\n  dependents: {\n    [uri: string]: GraphNode\n  }\n}\n\nexport type Graph = {\n  [uri: string]: GraphNode\n}\n\n// function: Make sure the given Graph has a node with given uri\n// it checks whether the node exists and creates a node if it doesn't exist\nconst ensureNode = (graph: Graph, uri: UrlString): GraphNode => {\n  graph[uri] = graph[uri] ?? {\n    type: '',\n    description: '',\n    dependencies: {},\n    dependents: {},\n    label: '',\n  }\n  return graph[uri]\n}\n\nconst fetchGraph = async (uri: UrlString): Promise<Graph> => {\n  const dataset = await getSolidDataset(uri, { fetch })\n  const things = getThingAll(dataset)\n  const graph: Graph = {}\n  things.forEach(thing => {\n    const uri = asUrl(thing)\n    const type = getTerm(thing, rdf.type)?.value ?? ''\n    const description = getTerm(thing, dct.description)?.value ?? ''\n    const label = getTerm(thing, rdfs.label)?.value ?? ''\n    const dependencies: GraphNode['dependencies'] = getTermAll(\n      thing,\n      'https://terms.math.livegraph.org#depends_on',\n    ).reduce((dependencies, dependency) => {\n      dependencies[dependency.value] = ensureNode(graph, dependency.value)\n      return dependencies\n    }, {} as GraphNode['dependencies'])\n    Object.assign(ensureNode(graph, uri), {\n      type,\n      description,\n      dependencies,\n      label,\n      uri,\n    })\n\n    Object.keys(dependencies).forEach(dependencyUri => {\n      ensureNode(graph, dependencyUri)\n      graph[dependencyUri].dependents[uri] = graph[uri]\n    })\n  })\n  return graph\n}\n\nconst useGraph = (uris: UrlString[]) => {\n  const [graph, setGraph] = useState<Graph>({})\n\n  useEffect(() => {\n    uris.forEach(async uri => {\n      const data = await fetchGraph(uri)\n      setGraph(graph => ({\n        ...graph,\n        ...data,\n      }))\n    })\n  }, [uris])\n  return graph\n}\n\nexport default useGraph\n\n/*\nconst fetcher = async (\n  uris: UrlString[],\n): Promise<(SolidDataset & WithResourceInfo)[]> => {\n  return await Promise.all(uris.map(url => getSolidDataset(url, { fetch })))\n}\n\nexport default function useGraph(uris: UrlString[]): [Graph, () => void] {\n  // download graph\n  const { data, revalidate } = useSwr(() => uris, fetcher)\n\n  const [response, setResponse] = useState<Graph>({})\n\n  // whenever data change, we process them into an object of type Graph\n  useEffect(() => {\n    const graph: Graph = {}\n\n    if (data) {\n      for (const datum of data) {\n        const things = getThingAll(datum)\n        things.forEach(thing => {\n          const uri = asUrl(thing)\n          const type = getTerm(thing, rdf.type)?.value ?? ''\n          const description = getTerm(thing, dct.description)?.value ?? ''\n          const label = getTerm(thing, rdfs.label)?.value ?? ''\n          const dependencies = getTermAll(\n            thing,\n            'https://terms.math.livegraph.org#depends_on',\n          )\n          const dependencies: GraphNode['dependencies'] = dependencies.reduce(\n            (dependencies, dependency) => {\n              dependencies[dependency.value] = ensureNode(graph, dependency.value)\n              return dependencies\n            },\n            {} as GraphNode['dependencies'],\n          )\n          Object.assign(ensureNode(graph, uri), {\n            type,\n            description,\n            dependencies,\n            label,\n            uri,\n          })\n        })\n      }\n    }\n\n    setResponse(graph)\n  }, [data])\n\n  return [response, revalidate]\n}\n*/\n","import {\n  forceSimulation,\n  forceCollide,\n  forceLink,\n  forceManyBody,\n  forceCenter,\n  forceX,\n  forceY,\n  SimulationNodeDatum,\n  SimulationLinkDatum,\n  ForceLink,\n} from 'd3-force'\nimport forceGravity from './gravity'\nimport { Coords, Uri, SimulationNode, SimulationLink, Node } from './types'\n\ninterface SimulationNodeExt extends SimulationNodeDatum {\n  uri: Uri\n  r: number\n}\n\nexport type SimulationLinkExt = SimulationLinkDatum<SimulationNodeExt>\n\nexport default class Simulation {\n  nodes: SimulationNodeExt[] = []\n  links: SimulationLinkExt[] = []\n\n  runs = false\n\n  simulation = forceSimulation()\n    .alphaDecay(0.005)\n    .force(\n      'link',\n      forceLink()\n        .id(node => (node as SimulationNodeExt).uri)\n        .distance(50)\n        .strength(0.1),\n    )\n    .force('linkGravity', forceGravity().strength(50))\n    .force('charge', forceManyBody().strength(-150).distanceMax(500))\n    .force('gravityX', forceX(0).strength(0.01))\n    .force('gravityY', forceY(0).strength(0.01))\n    .force(\n      'collide',\n      forceCollide(({ r }: SimulationNodeExt) => r + 5),\n    )\n    .force('center', forceCenter(0, 0))\n    .stop()\n\n  start = ({\n    nodes,\n    links,\n    onTick,\n  }: {\n    nodes: SimulationNode[]\n    links: SimulationLink[]\n    onTick: (simulation: {\n      nodes: SimulationNode[]\n      links: SimulationLinkExt[]\n    }) => void\n  }) => {\n    this.nodes = nodes as SimulationNodeExt[]\n    this.links = links.map(link => ({ ...link })) as SimulationLinkExt[]\n\n    this.simulation.nodes(this.nodes)\n    ;(\n      this.simulation.force('link') as ForceLink<\n        SimulationNodeExt,\n        SimulationLinkExt\n      >\n    ).links(this.links)\n    ;(\n      this.simulation.force('linkGravity') as ForceLink<\n        SimulationNodeExt,\n        SimulationLinkExt\n      >\n    ).links(this.links)\n\n    this.simulation.on('tick', () => {\n      onTick({\n        nodes: this.nodes as SimulationNode[],\n        links: this.links,\n      })\n    })\n\n    this.simulation.restart()\n    this.runs = true\n  }\n\n  stop = () => {\n    this.runs = false\n    return this.simulation.stop()\n  }\n\n  update = ({ nodes, links }: { nodes: Node[]; links: SimulationLink[] }) => {\n    this.simulation.stop()\n    // combine current nodes and the old nodes\n    const thisNodeDict: { [uri: string]: SimulationNodeExt } =\n      Object.fromEntries(this.nodes.map(node => [node.uri, node]))\n    const updatedNodes: SimulationNodeExt[] = nodes.map(node => ({\n      ...node,\n      x: (0.5 - Math.random()) * 800,\n      y: (0.5 - Math.random()) * 800,\n      ...thisNodeDict[node.uri],\n      r: node.r,\n    }))\n    this.nodes = updatedNodes\n    this.links = links.map(link => ({ ...link })) as SimulationLinkExt[]\n\n    this.simulation.nodes(this.nodes)\n    ;(\n      this.simulation.force('link') as ForceLink<\n        SimulationNodeExt,\n        SimulationLinkExt\n      >\n    ).links(this.links)\n    ;(\n      this.simulation.force('linkGravity') as ForceLink<\n        SimulationNodeExt,\n        SimulationLinkExt\n      >\n    ).links(this.links)\n\n    this.simulation.alpha(1).restart()\n  }\n\n  selectNode = ({ x, y }: Coords) =>\n    this.simulation.find(x, y, 40) as SimulationNodeExt\n}\n","import { SimulationLinkExt } from './index'\n\nexport default function gravity() {\n  let links: SimulationLinkExt[] = []\n  let strength = 3\n  function force(alpha: number) {\n    const k = strength * alpha\n    links.forEach(function (d) {\n      //// this works\n      // d.source.y = Math.max(d.target.y + 50, d.source.y);\n      //// this is original\n      // d.source.vy += k;\n      // d.target.vy -= k;\n      //\n      //// this works with velocities, so the graph looks less layered\n      const { source, target } = d\n      if (typeof source === 'object' && typeof target === 'object') {\n        if (\n          source.y &&\n          target.y &&\n          source.vy &&\n          target.vy &&\n          source.y < target.y + 50\n        ) {\n          const optimumDifference = (target.y + 50 - source.y) / 50\n          source.vy += k * optimumDifference\n          target.vy -= k * optimumDifference\n        }\n      }\n    })\n  }\n\n  force.links = (_: SimulationLinkExt[]) => {\n    links = _\n    return force\n  }\n\n  force.strength = (_: number) => {\n    strength = _\n    return force\n  }\n\n  return force\n}\n","import graphlib, { Graph } from 'graphlib'\n// import { Dependency } from './simulation/types'\n// import findCyclesAdjacency from 'elementary-circuits-directed-graph'\nimport { Graph as AbstractGraph } from './hooks/graph'\n\nfunction pruneCore(graph: Graph) {\n  if (!graphlib.alg.isAcyclic(graph)) {\n    // const cycles = graphlib.alg.findCycles(graph);\n    throw new Error('pruning is possible on DAG only')\n  }\n  const edges = graph.edges()\n  edges.forEach(edge => {\n    // remove edge\n    graph.removeEdge(edge)\n    // see if another path exists\n    const paths = graphlib.alg.dijkstra(graph, edge.v)\n    // if the other path doesn't exist, add the node back\n    if (paths[edge.w].distance === Infinity) {\n      graph.setEdge(edge)\n    }\n  })\n  return graph\n}\n\nexport const prune = (input: AbstractGraph): AbstractGraph => {\n  const graph = new graphlib.Graph()\n\n  Object.values(input).forEach(node => {\n    graph.setNode(node.uri)\n\n    Object.values(node.dependencies).forEach(dependency =>\n      graph.setEdge(node.uri, dependency.uri),\n    )\n  })\n\n  const output: AbstractGraph = Object.fromEntries(\n    Object.entries(input).map(([uri, node]) => [\n      uri,\n      { ...node, dependencies: {} },\n    ]),\n  )\n\n  const prunedEdges = pruneCore(graph)\n    .edges()\n    .map(({ v: source, w: target }) => ({ source, target }))\n\n  prunedEdges.forEach(({ source, target }) => {\n    output[source].dependencies[target] = output[target]\n  })\n\n  return output\n}\n\n/*\nexport function getCycles(dependencies: Dependency[]): Dependency[][] {\n  const nodes = Array.from(\n    new Set([\n      ...dependencies.map(d => d.dependent),\n      ...dependencies.map(d => d.dependency),\n    ]),\n  )\n  const nodeIndexes = Object.fromEntries(\n    Object.entries(nodes).map(([key, value]) => [value, +key]),\n  )\n\n  const adjacency = Array(nodes.length)\n    .fill(null)\n    .map(() => [] as number[])\n  dependencies.forEach(({ dependent, dependency }) => {\n    const dependentIndex = nodeIndexes[dependent]\n    const dependencyIndex = nodeIndexes[dependency]\n    adjacency[dependentIndex].push(dependencyIndex)\n  })\n\n  // try to detect loops (cycles of length 1)\n  // this is due to the limits of the findCyclesAdjacency, which fails to detect loops\n  // https://github.com/antoinerg/elementary-circuits-directed-graph/issues/13\n  // @TODO remove loop detection when the issue is fixed\n  const loops = adjacency.reduce((loops, adj, i) => {\n    if (adj.includes(i)) loops.push([i, i])\n    return loops\n  }, [] as number[][])\n\n  const rawCycles = loops.length > 0 ? loops : findCyclesAdjacency(adjacency)\n\n  const simpleCycles = rawCycles.map(cycle =>\n    cycle.slice(0, -1).map(i => nodes[i]),\n  )\n\n  return simpleCycles\n    .map(cycle => simpleCycleToCycle(cycle, dependencies))\n    .sort((a, b) => a.length - b.length)\n    .slice(0, 5)\n}\n\nfunction simpleCycleToCycle(\n  simpleCycle: string[],\n  dependencies: Dependency[],\n): Dependency[] {\n  return simpleCycle.map((uri, index) => {\n    const dependent = simpleCycle[index]\n    const dependency = simpleCycle[(index + 1) % simpleCycle.length]\n    return (\n      dependencies.find(\n        d => d.dependency === dependency && d.dependent === dependent,\n      ) || {\n        dependent,\n        dependency,\n        doc: '',\n      }\n    )\n  })\n  }\n  */\n","/*\n * based on the following example\n * https://github.com/rexxars/react-markdown/issues/10#issuecomment-347763068\n */\n\nimport React from 'react'\nimport 'katex/dist/katex.min.css'\nimport ReactMarkdown from 'react-markdown'\nimport remarkMath from 'remark-math'\nimport styled from 'styled-components'\nimport rehypeKatex from 'rehype-katex'\n\nconst Styler = styled.div`\n  img {\n    max-width: 100%;\n  }\n`\n\nexport default function Math({ children }: { children: string }) {\n  const props = {\n    children,\n    remarkPlugins: [remarkMath],\n    rehypePlugins: [rehypeKatex],\n  }\n  return (\n    <Styler>\n      <ReactMarkdown {...props} />\n    </Styler>\n  )\n}\n","import React from 'react'\nimport { GraphNode } from '../hooks/graph'\nimport Math from './Math'\n\ninterface Props {\n  node: GraphNode\n  onSelectNode: (uri: string) => void\n}\n\nconst Statement = ({ node, onSelectNode }: Props) => {\n  const dependencies: GraphNode[] = Object.values(node.dependencies)\n  const dependents: GraphNode[] = Object.values(node.dependents)\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        width: '100%',\n        top: '0',\n        bottom: 0,\n        pointerEvents: 'none',\n        overflowY: 'auto',\n        overflowX: 'hidden',\n      }}\n    >\n      <div className=\"columns mr-1 mt-6\">\n        <div className=\"column is-one-quarter is-offset-three-quarters\">\n          <div\n            className=\"card\"\n            style={{ pointerEvents: 'all', overflowX: 'auto', width: '100%' }}\n          >\n            <header className=\"card-header\">\n              <p className=\"card-header-title\">{node.label}</p>\n            </header>\n            <section className=\"card-content\">\n              <Math>{node.description}</Math>\n            </section>\n            <header className=\"card-header\">\n              <p className=\"card-header-title\">\n                dependencies: {dependencies.length}\n              </p>\n            </header>\n            <section className=\"card-content\">\n              <ul className=\"buttons are-small\">\n                {dependencies.map(dependency => (\n                  <li\n                    onClick={() => onSelectNode(dependency.uri)}\n                    key={dependency.uri}\n                    className=\"button is-link is-inverted\"\n                  >\n                    {dependency.label}\n                  </li>\n                ))}\n              </ul>\n            </section>\n            <header className=\"card-header\">\n              <p className=\"card-header-title\">\n                dependents: {dependents.length}\n              </p>\n            </header>\n            <section className=\"card-content\">\n              <ul className=\"buttons are-small\">\n                {dependents.map(dependent => (\n                  <li\n                    onClick={() => onSelectNode(dependent.uri)}\n                    key={dependent.uri}\n                    className=\"button is-link is-inverted\"\n                  >\n                    {dependent.label}\n                  </li>\n                ))}\n              </ul>\n            </section>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default Statement\n","import { fetch } from '@inrupt/solid-client-authn-browser'\nimport {\n  getSolidDataset,\n  getTerm,\n  getThing,\n  getThingAll,\n  getTermAll,\n  IriString,\n} from '@inrupt/solid-client'\nimport { solid, foaf } from 'rdf-namespaces'\n\n// following https://github.com/solid/solid/blob/main/proposals/data-discovery.md to discover math documents of a user\nexport const findMathDocumentsOfPerson = async (\n  webId: IriString,\n): Promise<IriString[]> => {\n  if (webId) {\n    const dataset = await getSolidDataset(webId, { fetch })\n    const me = getThing(dataset, webId)\n    if (me) {\n      const publicTypeIndex = getTerm(me, solid.publicTypeIndex)?.value\n      if (publicTypeIndex) {\n        const index = await getSolidDataset(publicTypeIndex, { fetch })\n        const things = getThingAll(index)\n        const mathDocuments = things\n          .filter(thing =>\n            getTermAll(thing, solid.forClass)\n              .map(a => a.value)\n              .includes('https://terms.math.livegraph.org#concept'),\n          )\n          .map(thing => getTermAll(thing, solid.instance))\n          .flat()\n          .map(a => a.value)\n        return mathDocuments\n      }\n    }\n  }\n  return ['https://mrkvon.solidcommunity.net/public/math/index.ttl']\n}\n\nexport const findFriends = async (webId: IriString): Promise<IriString[]> => {\n  if (webId) {\n    const dataset = await getSolidDataset(getResourceUrl(webId), { fetch })\n    const person = getThing(dataset, webId)\n    if (person) {\n      const friends = getTermAll(person, foaf.knows).map(a => a.value)\n      return friends\n    }\n  }\n\n  return []\n}\n\ntype BFSPerson = {\n  uri: IriString\n  visited: boolean\n}\n\n// We'll need to figure out how to stop this\nexport const BFSFriends = async (\n  webId: IriString,\n  onChange: (people: IriString[]) => void,\n): Promise<void> => {\n  webId = fixUri(webId)\n  const timbl = 'https://timbl.solidcommunity.net/profile/card#me'\n  const people: { [iri: string]: BFSPerson } = {\n    [webId]: { uri: webId, visited: false },\n    [timbl]: { uri: timbl, visited: false },\n  }\n\n  let length = Object.keys(people).length\n  onChange(Object.keys(people))\n\n  while (\n    Object.values(people)\n      .map(person => person.visited)\n      .includes(false)\n  ) {\n    // take a first unvisited person\n    const unvisitedPerson = Object.values(people).find(\n      person => !person.visited,\n    )\n    if (unvisitedPerson) {\n      // set them visited\n      unvisitedPerson.visited = true\n      // fetch their friends\n      try {\n        const friends = await findFriends(unvisitedPerson.uri)\n        // add their friends\n        friends.forEach(uri => {\n          uri = fixUri(uri)\n          people[uri] = people?.[uri] ?? { uri, visited: false }\n        })\n      } catch (e) {\n        e\n      } finally {\n        if (length !== Object.keys(people).length) {\n          onChange(Object.keys(people))\n          length = Object.keys(people).length\n        }\n      }\n    } else break\n  }\n}\n\nconst getResourceUrl = (url: string): string => {\n  const resourceUrl = new URL(url)\n  resourceUrl.hash = ''\n  return resourceUrl.href\n}\n\nconst fixUri = (uri: IriString) => {\n  const regex = /^(.+)\\.solid.community(.*)$/\n  const match = uri.match(regex)\n  if (match) {\n    const [, begin, end] = match\n    uri = `${begin}.solidcommunity.net${end}`\n  }\n\n  return uri\n}\n","import React, { useEffect, useState, useContext } from 'react'\nimport Visualization from './Visualization'\nimport useGraph, { Graph, GraphNode } from '../hooks/graph'\nimport Simulation, { SimulationLinkExt } from '../simulation'\nimport { SimulationNode, SimulationLink } from '../simulation/types'\nimport { Vector } from '../helpers/draw'\nimport { SessionContext } from '../contexts/session'\nimport { Grid } from '../helpers/draw'\nimport { prune as pruneGraph } from '../algorithms'\nimport numeric from 'numeric'\nimport Statement from './Statement'\n// import useSimulation from '../hooks/simulation'\nimport { findMathDocumentsOfPerson, findFriends } from '../dataTest'\nimport { UrlString } from '@inrupt/solid-client'\n\nconst transform = (matrix: number[][], vector: Vector): Vector => {\n  const raw = numeric.dot(\n    matrix,\n    numeric.transpose([[...vector, 1]]),\n  ) as number[][]\n  const [[x], [y]] = raw\n  return [x, y]\n}\n\ntype VisualizationNode = {\n  x: number\n  y: number\n  r: number\n  uri: string\n  label: string\n  style: string\n}\n\nfunction nodeRadius(node: GraphNode) {\n  let count = Object.entries(node.dependents).length ?? 0\n  count = count < 1 ? 1 : count\n  return count ** 0.42 * 5\n}\n\ntype VisualizationLink = {\n  source: VisualizationNode\n  target: VisualizationNode\n}\n\nexport type VisualizationGraph = {\n  nodes: VisualizationNode[]\n  links: VisualizationLink[]\n}\n\ninterface SimulationGraph {\n  nodes: SimulationNode[]\n  links: SimulationLinkExt[]\n}\n\nconst basicGrid: Grid = {\n  origin: [0, 0],\n  distance: 20,\n  highlight: 5,\n}\n\nconst transformGrid = (matrix: number[][], grid: Grid): Grid => {\n  let distance = grid.distance * matrix[0][0]\n  while (distance < 20) {\n    distance *= 5\n  }\n  return {\n    origin: transform(matrix, grid.origin),\n    distance,\n    highlight: grid.highlight,\n  }\n}\n\nconst transformLayout = (\n  matrix: number[][],\n  graph: SimulationGraph,\n  highlighted: string | undefined,\n  selected: string | undefined,\n  selectedDependencies: string[],\n): VisualizationGraph => {\n  const transformedNodesDict = Object.fromEntries(\n    graph.nodes.map(node => {\n      const [x, y] = transform(matrix, [node.x, node.y])\n      const r = matrix[0][0] * node.r\n      return [node.uri, { ...node, x, y, r, style: '' }]\n    }),\n  )\n\n  if (highlighted) {\n    transformedNodesDict[highlighted].style = 'accent'\n  }\n\n  if (selected) {\n    transformedNodesDict[selected].style = 'focus'\n  }\n\n  selectedDependencies.forEach(\n    uri => (transformedNodesDict[uri].style = 'accent'),\n  )\n\n  const links = graph.links.map(link => {\n    const sourceUri =\n      typeof link.source === 'string'\n        ? link.source\n        : typeof link.source === 'number'\n        ? graph.nodes[link.source].uri\n        : link.source.uri\n    const targetUri =\n      typeof link.target === 'string'\n        ? link.target\n        : typeof link.target === 'number'\n        ? graph.nodes[link.target].uri\n        : link.target.uri\n    const source = transformedNodesDict[sourceUri]\n    const target = transformedNodesDict[targetUri]\n    return { source, target }\n  })\n\n  return { nodes: Object.values(transformedNodesDict), links }\n}\n\nconst selectNodeDependencies = (\n  selectedNodeUri: string | undefined,\n  graph: Graph,\n): string[] => {\n  if (!selectedNodeUri) return []\n  return Object.values(graph[selectedNodeUri]?.dependencies ?? {}).map(\n    node => node.uri,\n  )\n}\n\nconst VisualizationContainer: React.FC = props => {\n  const [simulation] = useState(new Simulation())\n  const [documents, setDocuments] = useState<UrlString[]>([\n    'https://mrkvon.solidcommunity.net/public/math/index.ttl',\n  ])\n\n  const [layout, setLayout] = useState<SimulationGraph>({\n    nodes: [],\n    links: [],\n  })\n\n  const [highlightedNode, setHighlightedNode] = useState<string | undefined>()\n  const [selectedNode, setSelectedNode] = useState<string | undefined>()\n\n  const [info] = useContext(SessionContext)\n  // abstract graph\n  const graph = useGraph(documents)\n\n  useEffect(() => {\n    findMathDocumentsOfPerson(info?.webId ?? '').then(docs => {\n      setDocuments(docs)\n    })\n    findFriends(info?.webId ?? '').then(console.log)\n  }, [info])\n\n  // transformation matrix\n  const [matrix, setMatrix] = useState<number[][]>([\n    [1, 0, 0],\n    [0, 1, 0],\n    [0, 0, 1],\n  ])\n\n  // initialize simulation\n  useEffect(() => {\n    let lastUpdate = Date.now() - 20\n    simulation.start({\n      nodes: [],\n      links: [],\n      onTick: ({ nodes, links }) => {\n        const now = Date.now()\n        if (now > lastUpdate + 20) {\n          setLayout({ nodes: [...nodes], links: [...links] })\n          lastUpdate = now\n        }\n      },\n    })\n    return () => {\n      simulation.stop()\n    }\n  }, [simulation])\n\n  /*/ refetch graph data when user gets logged in or out\n  useEffect(() => {\n    ;(async () => {\n      await revalidate()\n    })()\n  }, [info, revalidate])\n  */\n\n  // when graph changes, update simulation\n  useEffect(() => {\n    let prunedOrFullGraph\n    try {\n      prunedOrFullGraph = pruneGraph(graph)\n    } catch {\n      prunedOrFullGraph = graph\n    }\n\n    const nodes = Object.values(prunedOrFullGraph).map(node => ({\n      label: node.label,\n      x: Math.random() * 400,\n      y: Math.random() * 400,\n      r: nodeRadius(node),\n      uri: node.uri,\n    }))\n\n    const links = Object.values(prunedOrFullGraph).reduce(\n      (nodes, { uri: source, dependencies }) => {\n        Object.keys(dependencies).forEach(target =>\n          nodes.push({ source, target }),\n        )\n        return nodes\n      },\n      [] as SimulationLink[],\n    )\n\n    simulation.update({ nodes, links })\n  }, [graph, simulation])\n\n  const handleTransform = (matrix: number[][]): void => {\n    setMatrix(prevMatrix => numeric.dot(matrix, prevMatrix) as number[][])\n  }\n\n  const withNode = (action: (uri: string) => unknown) => {\n    return (position: Vector): void => {\n      // first transform to local coordinates\n      const [x, y] = transform(numeric.inv(matrix), position)\n      // then find the node in simulation\n      action(simulation.selectNode({ x, y })?.uri)\n    }\n  }\n\n  const handleHover = withNode(setHighlightedNode)\n  const handleSelect = withNode(setSelectedNode)\n\n  const selectedNodeDependencies = selectNodeDependencies(selectedNode, graph)\n  // transform layout to TransformedLayout\n  const transformedLayout = transformLayout(\n    matrix,\n    layout,\n    highlightedNode,\n    selectedNode,\n    selectedNodeDependencies,\n  )\n\n  const grid = transformGrid(matrix, basicGrid)\n\n  return (\n    <>\n      <Visualization\n        graph={transformedLayout}\n        grid={grid}\n        onTransform={handleTransform}\n        onHover={handleHover}\n        onSelectNode={handleSelect}\n        {...props}\n      />\n\n      {selectedNode && (\n        <Statement\n          node={graph[selectedNode]}\n          onSelectNode={uri => setSelectedNode(uri)}\n        />\n      )}\n    </>\n  )\n}\n\nexport default VisualizationContainer\n","import React, { createContext, useContext, useState, useEffect } from 'react'\nimport { SessionContext } from '../contexts/session'\nimport { /*BFSFriends,*/ findMathDocumentsOfPerson } from '../dataTest'\nimport { IriString } from '@inrupt/solid-client'\n\nexport const PeopleContext = createContext<string[]>([])\n\ninterface Props {\n  children: React.ReactNode\n}\n\ntype MathDocument = {\n  uri: IriString\n  owner: IriString\n  access: string\n}\n\nexport const DocumentsContext = createContext<MathDocument[]>([])\n\nconst DataContainer = ({ children }: Props) => {\n  const [info] = useContext(SessionContext)\n  const [people, setPeople] = useState<string[]>([])\n  const [mathDocuments, setMathDocuments] = useState<MathDocument[]>([])\n\n  useEffect(() => {\n    // here we lookup people connected to us\n    if (info?.isLoggedIn) {\n      // BFSFriends(info.webId, setPeople)\n      setPeople([info.webId])\n    } else {\n      setPeople([])\n    }\n  }, [info])\n\n  // we lookup math documents of found people\n  useEffect(() => {\n    people.forEach(person =>\n      findMathDocumentsOfPerson(person)\n        .then(documents =>\n          setMathDocuments(state => {\n            const notAddedYet = documents.filter(\n              doc => !state.find(stateDoc => doc === stateDoc.uri),\n            )\n            if (notAddedYet.length > 0) {\n              return [\n                ...state,\n                ...notAddedYet.map(uri => ({ uri, owner: person, access: '' })),\n              ]\n            } else return state\n          }),\n        )\n        .catch(e => {\n          e\n        }),\n    )\n  }, [people])\n\n  useEffect(() => {\n    console.log(\n      'documents',\n      mathDocuments.map(doc => doc.uri),\n    )\n  }, [mathDocuments])\n\n  return (\n    <DocumentsContext.Provider value={mathDocuments}>\n      <PeopleContext.Provider value={people}>{children}</PeopleContext.Provider>\n    </DocumentsContext.Provider>\n  )\n}\n\nexport default DataContainer\n","import React, { useContext } from 'react'\nimport { PeopleContext } from './DataContainer'\n\ninterface Props {\n  people: string[]\n}\n\nexport const PeopleList = ({ people, ...props }: Props) => (\n  <div {...props}>\n    <div>{people.length}</div>\n    {/*\n    <ul>\n      {people.map(person => (\n        <li key={person}>{person}</li>\n      ))}\n    </ul>*/}\n  </div>\n)\n\ntype ULProps = Partial<React.HTMLAttributes<HTMLUListElement>>\n\nexport const PeopleListContainer = (props: ULProps) => {\n  const people = useContext(PeopleContext)\n  return <PeopleList people={people} {...props} />\n}\n","import React from 'react'\nimport styled from 'styled-components'\n\nconst Link = styled.a`\n  color: lightgray;\n  &:hover {\n    color: white;\n  }\n`\nconst Footer = styled.footer`\n  color: gray;\n`\n\nconst About: React.FC = props => (\n  <div {...props}>\n    <Footer>\n      powered by <Link href=\"https://solidproject.org\">Solid</Link> &middot;{' '}\n      <Link href=\"https://github.com/livegraph-org/solid-math\">source</Link>\n    </Footer>\n  </div>\n)\n\nexport default About\n","import React from 'react'\nimport Login from './Login'\nimport VisualizationContainer from './VisualizationContainer'\nimport styled from 'styled-components'\nimport { PeopleListContainer } from './PeopleList'\nimport About from './About'\n\nconst PositionedLogin = styled(Login)`\n  position: fixed;\n  top: 1rem;\n  right: 1rem;\n  display: block;\n`\n\nconst PositionedAbout = styled(About)`\n  position: fixed;\n  bottom: 1rem;\n  right: 1rem;\n`\n\nconst PositionedPeopleList = styled(PeopleListContainer)`\n  position: fixed;\n  top: 1rem;\n  left: 1rem;\n  display: block;\n  background-color: white;\n  padding: 0.25rem;\n`\n\nconst FullSizeVisualization = styled(VisualizationContainer)`\n  height: 100vh;\n  width: 100vw;\n  display: block;\n`\n\nconst Layout: React.FC = () => {\n  return (\n    <>\n      <PositionedPeopleList />\n\n      <PositionedLogin />\n\n      <PositionedAbout />\n\n      <FullSizeVisualization />\n    </>\n  )\n}\n\nexport default Layout\n","import React from 'react'\nimport Layout from './components/Layout'\nimport DataContainer from './components/DataContainer'\n\nconst App: React.FC = () => (\n  <DataContainer>\n    <Layout />\n  </DataContainer>\n)\n\nexport default App\n","import { ReportHandler } from 'web-vitals'\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry)\n      getFID(onPerfEntry)\n      getFCP(onPerfEntry)\n      getLCP(onPerfEntry)\n      getTTFB(onPerfEntry)\n    })\n  }\n}\n\nexport default reportWebVitals\n","import React, { useState, ReactNode } from 'react'\nimport { SessionContext, SessionInfo } from '../contexts/session'\n\ninterface Props {\n  children: ReactNode\n}\n\nconst SessionProvider: React.FC<Props> = (props: Props) => {\n  const [sessionInfo, setSessionInfo] = useState<SessionInfo | null>(null)\n\n  return (\n    <SessionContext.Provider value={[sessionInfo, setSessionInfo]}>\n      {props.children}\n    </SessionContext.Provider>\n  )\n}\n\nexport default SessionProvider\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.scss'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\nimport SessionProvider from './components/SessionProvider'\nimport Modal from 'react-modal'\n\nif (typeof document === 'object') {\n  const appElement = document.querySelector('#root') as HTMLElement\n\n  Modal.setAppElement(appElement)\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <SessionProvider>\n      <App />\n    </SessionProvider>\n  </React.StrictMode>,\n  document.getElementById('root'),\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}