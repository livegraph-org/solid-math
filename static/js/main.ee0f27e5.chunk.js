(this.webpackJsonpmath=this.webpackJsonpmath||[]).push([[0],{261:function(e,t,n){},262:function(e,t,n){},263:function(e,t,n){},464:function(e,t){},499:function(e,t,n){},500:function(e,t,n){"use strict";n.r(t);var c,r=n(3),a=n.n(r),i=n(77),s=n.n(i),o=(n(261),n(262),n(263),n(28)),u=n(6),l=n(7),d=n(36),b=n(29),f=n(43),j=n.n(f),h=n(1),p=["children","className"],O=Object(b.a)((function(e){var t=e.children,n=e.className,c=Object(d.a)(e,p);return Object(h.jsx)("button",Object(u.a)(Object(u.a)({className:j()(n,"button")},c),{},{children:t}))}))(c||(c=Object(o.a)(["\n  &:not(:hover) {\n    background-color: #0000;\n    border-color: #0000;\n    color: #fff;\n  }\n  &:hover {\n  }\n  &:active {\n    background-color: #eee;\n  }\n"]))),v=n(109),m=n.n(v),g=["buttonProps","contentProps","title"];function x(e){return e.displayName||e.name||"Component"}var y=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",c=function(c){var a=c.buttonProps,i=void 0===a?{}:a,s=c.contentProps,o=void 0===s?{}:s,b=c.title,f=void 0===b?"":b,p=Object(d.a)(c,g),O=Object(r.useState)(!1),v=Object(l.a)(O,2),x=v[0],y=v[1],w=f||n||"";return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(e,Object(u.a)(Object(u.a)(Object(u.a)({},i),p),{},{className:j()(null===i||void 0===i?void 0:i.className,null===p||void 0===p?void 0:p.className),onClick:function(e){e.preventDefault(),y(!0),i.onClick&&i.onClick(e)}})),x&&Object(h.jsxs)(m.a,{isOpen:x,onRequestClose:function(){return y(!1)},contentLabel:w,overlayClassName:{base:"modal modal-background is-active",afterOpen:"",beforeClose:""},className:{base:"modal-content",afterOpen:"",beforeClose:""},closeTimeoutMS:50,children:[Object(h.jsx)("button",{className:"modal-close",onClick:function(){return y(!1)},children:"close"}),Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("header",{className:"card-header",children:Object(h.jsx)("p",{className:"card-header-title",children:w})}),Object(h.jsx)("div",{className:"card-content",children:Object(h.jsx)(t,Object(u.a)(Object(u.a)({},o),{},{onFinish:function(){return y(!1)}}))})]})]})]})};return c.displayName="WithModal(".concat(x(e),")"),c},w=y((function(e){var t=Object.assign({},e);return Object(h.jsx)(O,Object(u.a)(Object(u.a)({},t),{},{children:"Login"}))}),(function(e){var t,n=e.onLogin,c=Object(r.useState)(null!==(t=localStorage.getItem("idp"))&&void 0!==t?t:"https://solidcommunity.net"),a=Object(l.a)(c,2),i=a[0],s=a[1];return Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),localStorage.setItem("idp",i),n(i)},children:[Object(h.jsx)("div",{className:"field",children:Object(h.jsx)("div",{className:"control",children:Object(h.jsx)("input",{id:"idp",className:"input",type:"url",value:i,onChange:function(e){e.preventDefault();var t=e.currentTarget.value;s(t)},placeholder:"Where is your Solid Pod?"})})}),Object(h.jsx)("div",{className:"field",children:Object(h.jsx)("div",{className:"control",children:Object(h.jsx)("input",{type:"submit",value:"Connect",className:"button is-link"})})})]})}),"Select your Solid identity provider"),k=n(85),N=function(){return Object(k.b)()},C=k.c,E=n(230),I=n(0),S=n.n(I),L=n(5),D=n(17),M=n(106),P={message:"",type:"info"},A=function(e){return function(){var t=Object(L.a)(S.a.mark((function t(n,c){var r;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(q(e)),t.next=3,new Promise((function(e){setTimeout(e,5e3)}));case 3:(r=_(c())).message===e.message&&r.type===e.type&&n(R());case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},F=Object(D.c)({name:"info",initialState:P,reducers:{setInfo:function(e,t){return t.payload},clearInfo:function(){return P}}}),T=F.actions,q=T.setInfo,R=T.clearInfo,_=function(e){return e.info},W=F.reducer,U=n(24),z=n(12),B=n(118),$=n.n(B),G=n(231),Y=n.n(G),J=n(232),X=n.n(J);var H,Z=function(e){var t=new $.a.Graph;Object.values(e).forEach((function(e){t.setNode(e.uri),Object.values(e.dependencies).forEach((function(n){return t.setEdge(e.uri,n.uri)}))}));var n=Object.fromEntries(Object.entries(e).map((function(e){var t=Object(l.a)(e,2),n=t[0],c=t[1];return[n,Object(u.a)(Object(u.a)({},c),{},{dependencies:{},dependents:{}})]}))),c=function(e){if(!$.a.alg.isAcyclic(e))throw new Error("pruning is possible on DAG only");return e.edges().forEach((function(t){e.removeEdge(t),$.a.alg.dijkstra(e,t.v)[t.w].distance===1/0&&e.setEdge(t)})),e}(t).edges().map((function(e){return{source:e.v,target:e.w}}));return c.forEach((function(e){var t=e.source,c=e.target;n[t].dependencies[c]=n[c],n[c].dependents[t]=n[t]})),n},K=function(e){var t=function(e){var t=Object.keys(e).sort(),n=Array(t.length).fill(null).map((function(){return[]}));return t.forEach((function(c,r){n[r]=Object.keys(e[c].dependencies).map((function(e){return t.findIndex((function(t){return t===e}))}))})),[n,t]}(e),n=Object(l.a)(t,2),c=n[0],r=n[1],a=function(e){return e.map((function(e,t){return[e,t]})).filter((function(e){var t=Object(l.a)(e,2),n=t[0],c=t[1];return n.includes(c)})).map((function(e){return[Object(l.a)(e,2)[1]]}))}(c),i=Y()(c).filter((function(e){return e.length>2})).map((function(e){return e.slice(0,-1)}));return[].concat(Object(z.a)(a),Object(z.a)(i)).map((function(e){return e.map((function(e){return r[e]}))}))},Q=function(e){return e.map((function(e,t,n){return[n[t],n[(t+1)%n.length]]}))},V=function(e,t){return t.forEach((function(t){var n=Object(l.a)(t,2),c=n[0],r=n[1];delete e[c].dependencies[r],delete e[r].dependents[c]})),e},ee=function(e,t){return t.forEach((function(t){var n=Object(l.a)(t,2),c=n[0],r=n[1];e[c].dependencies[r]=e[r],e[r].dependents[c]=e[c]})),e},te=n(10),ne=n(18),ce=n(19),re={definition:"https://terms.math.livegraph.org#Definition",statement:"https://terms.math.livegraph.org#Statement",dependsOn:"https://terms.math.livegraph.org#dependsOn"},ae=function(){var e=Object(L.a)(S.a.mark((function e(t){var n,c,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.g)(t,{fetch:ne.fetch});case 2:return n=e.sent,c=Object(te.k)(n),r={nodes:[],links:[]},c.forEach((function(e){var n=le(e,t);r.nodes.push(n),Object(te.i)(e,re.dependsOn).forEach((function(e){r.links.push([n.id,e.value])}))})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(L.a)(S.a.mark((function e(t){var n,c,r,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.g)(t.document,{fetch:ne.fetch});case 2:if(n=e.sent,!(c=Object(te.j)(n,t.id))){e.next=15;break}if(r=c,t.label&&(r=Object(te.r)(r,ce.c.label,t.label.en,"en")),t.type&&(r=Object(te.t)(r,ce.b.type,re[t.type])),t.description&&(r=Object(te.r)(r,ce.b.value,t.description.en,"en")),t.dependencies&&(r=Object(te.n)(r,re.dependsOn),t.dependencies.forEach((function(e){r=Object(te.a)(r,re.dependsOn,e)}))),r===c){e.next=14;break}return a=Object(te.s)(n,r),e.next=14,Object(te.q)(t.document,a,{fetch:ne.fetch});case 14:return e.abrupt("return",le(r,t.document));case 15:throw new Error("node to update not found");case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(L.a)(S.a.mark((function e(t){var n,c,r,a,i;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.g)(t.document,{fetch:ne.fetch});case 2:return n=e.sent,c=oe(t.document,n,t.label.en),r=Object(te.c)({url:c}).setStringWithLocale(ce.c.label,t.label.en,"en").setUrl(ce.b.type,re[t.type]).setStringWithLocale(ce.b.value,t.description.en,"en"),t.dependencies.forEach((function(e){r.addUrl(re.dependsOn,e)})),a=r.build(),i=Object(te.s)(n,a),e.next=10,Object(te.q)(t.document,i,{fetch:ne.fetch});case 10:return e.abrupt("return",le(a,t.document));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(e,t,n){for(var c="".concat(e,"#").concat(function(e){return e.toLowerCase().trim().replace(/[^a-z0-9.\s_-]/g,"").trim().replace(/\s/g,"_").replace(/\./g,"_")}(n)),r=function(e){return e>0?"".concat(c,"_").concat(e):c},a=0;Object(te.j)(t,r(a));)a++;return r(a)},ue=function(){var e=Object(L.a)(S.a.mark((function e(t){var n,c,r,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.g)(t.document.uri,{fetch:ne.fetch});case 2:if(n=e.sent,c=Object(te.j)(n,t.uri),r=Object(te.k)(n).filter((function(e){return e.url!==t.uri})).filter((function(e){return Object(te.l)(e,re.dependsOn)})).map((function(e){return Object(te.p)(e,re.dependsOn,t.uri)})),!c){e.next=10;break}return a=Object(te.o)(n,c),r.forEach((function(e){a=Object(te.s)(a,e)})),e.next=10,Object(te.q)(t.document.uri,a,{fetch:ne.fetch});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(e,t){var n,c,r,a,i,s,o=Object(te.b)(e),u=null!==(n=null===(c=Object(te.h)(e,ce.b.type))||void 0===c?void 0:c.value)&&void 0!==n?n:"",l=null!==(r=null===(a=Object(te.h)(e,ce.b.value))||void 0===a?void 0:a.value)&&void 0!==r?r:"",d=null!==(i=null===(s=Object(te.h)(e,ce.c.label))||void 0===s?void 0:s.value)&&void 0!==i?i:"",b=Object(te.m)(e,re.dependsOn);switch(u){case re.definition:return{id:o,type:"definition",label:{en:d},description:{en:l},dependencies:b,dependents:[],examples:[],created:0,updated:0,document:t};case re.statement:return{id:o,type:"statement",label:{en:d},description:{en:l},dependencies:b,dependents:[],examples:[],proofs:[],created:0,updated:0,document:t};default:throw new Error("thing is not a Definition or Statement")}},de=["id","document"],be=Object(D.b)("math/addGraph",function(){var e=Object(L.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),fe=Object(D.b)("math/updateNode",function(){var e=Object(L.a)(S.a.mark((function e(t,n){var c,r,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=n.dispatch)(A({type:"info",message:"saving ..."})),e.prev=2,e.next=5,ie(t);case 5:return r=e.sent,c(A({type:"success",message:"... saved"})),e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(2),a="updating failed",e.t0 instanceof Error&&(a+=": ".concat(e.t0.message)),c(A({type:"error",message:a})),e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n){return e.apply(this,arguments)}}()),je=Object(D.b)("math/createNode",function(){var e=Object(L.a)(S.a.mark((function e(t,n){var c,r,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=n.dispatch)(A({type:"info",message:"saving ..."})),e.prev=2,e.next=5,se(t);case 5:return r=e.sent,c(A({type:"success",message:"... saved"})),e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(2),a="creating failed",e.t0 instanceof Error&&(a+=": ".concat(e.t0.message)),c(A({type:"error",message:a})),e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n){return e.apply(this,arguments)}}()),he=Object(D.b)("math/deleteNode",function(){var e=Object(L.a)(S.a.mark((function e(t,n){var c,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=n.dispatch)(A({type:"info",message:"deleting ..."})),e.prev=2,e.next=5,ue(t);case 5:return c(A({type:"success",message:"... deleted"})),e.abrupt("return",Object(u.a)(Object(u.a)({},t),{},{id:t.uri,dependencies:Object.keys(t.dependencies),dependents:Object.keys(t.dependents),document:t.document.uri}));case 9:throw e.prev=9,e.t0=e.catch(2),r="deleting failed",e.t0 instanceof Error&&(r+=": ".concat(e.t0.message)),c(A({type:"error",message:r})),e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}()),pe=Object(D.c)({name:"math",initialState:{entities:{node:{byId:{},allIds:[]}},ui:{highlighted:"",selected:"",create:!1}},reducers:{highlight:function(e,t){e.ui.highlighted=t.payload},select:function(e,t){e.ui.selected=t.payload},createMath:function(e,t){e.ui.create=t.payload}},extraReducers:function(e){e.addCase(be.fulfilled,(function(e,t){var n=t.payload,c=n.nodes,r=n.links;c.forEach((function(t){e.entities.node.byId[t.id]=Object(u.a)(Object(u.a)({},t),{},{dependencies:[]}),e.entities.node.allIds.push(t.id)})),r.forEach((function(t){var n=Object(l.a)(t,2),c=n[0],r=n[1];e.entities.node.byId[r]&&e.entities.node.byId[c]&&(e.entities.node.byId[r].dependents.push(c),e.entities.node.byId[c].dependencies.push(r))}))})).addCase(he.fulfilled,(function(e,t){var n=t.payload,c=n.dependents,r=n.dependencies,a=n.id;c.forEach((function(t){var n=e.entities.node.byId[t].dependencies.filter((function(e){return e!==a}));e.entities.node.byId[t].dependencies=n})),r.forEach((function(t){e.entities.node.byId[t].dependents=e.entities.node.byId[t].dependents.filter((function(e){return e!==a}))})),delete e.entities.node.byId[a],e.entities.node.allIds=e.entities.node.allIds.filter((function(e){return e!==a})),e.ui.selected=""})).addMatcher(Object(D.d)(fe.fulfilled,je.fulfilled),(function(e,t){var n,c,r,a=t.payload;e.entities.node.allIds.includes(a.id)||(e.entities.node.allIds.push(a.id),e.entities.node.byId[a.id]=a),e.entities.node.byId[a.id].label=a.label,e.entities.node.byId[a.id].type=a.type,e.entities.node.byId[a.id].description=a.description,e.entities.node.byId[a.id].dependencies=a.dependencies;var i=null!==(n=null===(c=Object(U.f)(e))||void 0===c||null===(r=c.entities.node.byId[a.id])||void 0===r?void 0:r.dependencies)&&void 0!==n?n:[],s=i.filter((function(e){return!a.dependencies.includes(e)}));a.dependencies.filter((function(e){return!i.includes(e)})).forEach((function(t){e.entities.node.byId[t].dependents.push(a.id)})),s.forEach((function(t){e.entities.node.byId[t].dependents=e.entities.node.byId[t].dependents.filter((function(e){return e!==a.id}))})),e.ui.selected=a.id}))}}),Oe=pe.actions,ve=Oe.highlight,me=Oe.select,ge=Oe.createMath,xe=Object(M.a)((function(e){return e.math.entities.node}),(function(e){return e.document.entities.document}),(function(e,t){var n=e.byId,c=t.byId,r=Object.fromEntries(Object.entries(n).map((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1],a=r.id,i=r.document,s=Object(d.a)(r,de);return[n,Object(u.a)(Object(u.a)({},s),{},{uri:a,dependencies:{},dependents:{},document:c[i]})]})));return Object.entries(r).forEach((function(e){var t=Object(l.a)(e,2),c=t[0],a=t[1];a.dependencies=Object.fromEntries(n[c].dependencies.map((function(e){return[e,r[e]]}))),a.dependents=Object.fromEntries(n[c].dependents.map((function(e){return[e,r[e]]})))})),r})),ye=Object(M.a)(xe,(function(e){return function(e){e=X()(e);var t=K(e),n=t.map((function(e){return Q(e)})).flat().filter((function(e,t,n){var c=Object(l.a)(e,2),r=c[0],a=c[1];return n.findIndex((function(e){var t=Object(l.a)(e,2),n=t[0],c=t[1];return r===n&&a===c}))===t})),c=V(e,n),r=Z(c);return[ee(r,n),t]}(e)})),we=(Object(M.a)(xe,(function(e){return Z(e)})),function(e){return e.math.ui.highlighted}),ke=function(e){return e.math.ui.selected},Ne=function(e){return e.math.ui.create},Ce=Object(M.a)(ke,xe,(function(e,t){var n,c;return e?Object.values(null!==(n=null===(c=t[e])||void 0===c?void 0:c.dependencies)&&void 0!==n?n:{}).map((function(e){return e.uri})):[]})),Ee=Object(M.a)(ke,xe,(function(e,t){return t[e]})),Ie=pe.reducer,Se=function(){var e=Object(L.a)(S.a.mark((function e(t){var n,c,r,a,i,s,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],!t){e.next=13;break}return e.next=4,De(t);case 4:if(c=e.sent,!(r=c.public)){e.next=13;break}return e.next=9,Object(te.g)(r,{fetch:ne.fetch});case 9:a=e.sent,i=Object(te.k)(a),s=i.filter((function(e){return Object(te.i)(e,ce.d.forClass).map((function(e){return e.value})).includes("https://terms.math.livegraph.org#Definition")})).map((function(e){return Object(te.i)(e,ce.d.instance)})).flat().map((function(e){return e.value})),n=s;case 13:return 0===n.length&&(n=["https://mrkvon.solidcommunity.net/public/math/graph-theory.ttl"]),e.t0=Object,e.next=17,Promise.all(n.map(function(){var e=Object(L.a)(S.a.mark((function e(t){var n,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.g)(t,{fetch:ne.fetch});case 2:return n=e.sent,c=Object(te.f)(n),e.abrupt("return",[t,c]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 17:return e.t1=e.sent,o=e.t0.fromEntries.call(e.t0,e.t1),e.abrupt("return",n.map((function(e){return{id:e,uri:e,access:o[e]}})));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Le=function(){var e=Object(L.a)(S.a.mark((function e(t,n,c){var r,a,i,s,o,u,l,d,b,f,j;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.g)(t,{fetch:ne.fetch});case 3:e.next=29;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=9,Object(te.q)(t,Object(te.d)(),{fetch:ne.fetch});case 9:return e.next=11,Object(te.g)(t,{fetch:ne.fetch});case 11:return r=e.sent,a={id:t,uri:t,access:Object(te.f)(r)},e.next=15,De(n);case 15:if(i=e.sent,!(s=c?i.public:i.private)){e.next=28;break}return e.next=20,Object(te.g)(s,{fetch:ne.fetch});case 20:return u=e.sent,l=null!==(o=Object(te.j)(u,s))&&void 0!==o?o:Object(te.e)({url:s}),d="".concat(s,"#").concat(Date.now()),b=Object(te.c)(l).addUrl(ce.a.references,d).build(),f=Object(te.c)(Object(te.e)({url:d})).addUrl(ce.b.type,ce.d.TypeRegistration).addUrl(ce.d.forClass,"https://terms.math.livegraph.org#Definition").addUrl(ce.d.forClass,"https://terms.math.livegraph.org#Statement").addUrl(ce.d.instance,t).build(),j=Object(te.s)(Object(te.s)(u,b),f),e.next=28,Object(te.q)(s,j,{fetch:ne.fetch});case 28:return e.abrupt("return",a);case 29:throw new Error("document already exists");case 30:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n,c){return e.apply(this,arguments)}}(),De=function(){var e=Object(L.a)(S.a.mark((function e(t){var n,c,r,a,i,s,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.g)(t,{fetch:ne.fetch});case 2:return n=e.sent,c=Object(te.j)(n,t),r={public:"",private:""},c&&(r.public=null!==(a=null===(i=Object(te.h)(c,ce.d.publicTypeIndex))||void 0===i?void 0:i.value)&&void 0!==a?a:"",r.private=null!==(s=null===(o=Object(te.h)(c,ce.d.privateTypeIndex))||void 0===o?void 0:o.value)&&void 0!==s?s:""),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=Object(D.b)("math/addDocuments",function(){var e=Object(L.a)(S.a.mark((function e(t,n){var c,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.dispatch,e.next=3,Se(t);case 3:return(r=e.sent).forEach((function(e){return c(be(e.uri))})),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),Pe=Object(D.b)("math/createDocument",function(){var e=Object(L.a)(S.a.mark((function e(t,n){var c,r,a,i,s,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.uri,r=t.isPublic,a=n.getState,i=n.dispatch,s=Xe(a()),e.prev=3,i(A({type:"info",message:"creating a new document"})),e.next=7,Le(c,s,r);case 7:return o=e.sent,i(A({type:"success",message:"created a new document"})),e.abrupt("return",o);case 12:throw e.prev=12,e.t0=e.catch(3),e.t0 instanceof Error&&i(A({type:"error",message:e.t0.message})),e.t0;case 16:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t,n){return e.apply(this,arguments)}}()),Ae=Object(D.c)({name:"document",initialState:{entities:{document:{byId:{},allIds:[]}},selected:""},reducers:{selectDocument:function(e,t){e.selected=t.payload}},extraReducers:function(e){e.addCase(Me.fulfilled,(function(e,t){e.entities.document={byId:Object.fromEntries(t.payload.map((function(e){return[e.id,e]}))),allIds:t.payload.map((function(e){return e.id}))}})).addCase(Pe.fulfilled,(function(e,t){e.entities.document.allIds.push(t.payload.id),e.entities.document.byId[t.payload.id]=t.payload}))}}),Fe=Ae.actions.selectDocument,Te=Object(M.a)((function(e){return e.document.entities.document}),(function(e){var t=e.byId;return e.allIds.map((function(e){return t[e]}))})),qe=(H=["write","append"],Object(M.a)(Te,(function(e){return e.filter((function(e){return H.some((function(t){return e.access.user[t]}))}))}))),Re=function(e){return e.document.selected},_e=Ae.reducer,We=function(){var e=Object(L.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.handleIncomingRedirect)({url:window.location.href,restorePreviousSession:!0});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(L.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(ne.login)({oidcIssuer:t,redirectUrl:window.location.href,clientName:"Friends Crawler"});case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),alert("Could not find a Solid Pod at ".concat(t)),localStorage.removeItem("idp");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),ze=function(){var e=Object(L.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.logout)();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Be=Object(D.b)("login/init",function(){var e=Object(L.a)(S.a.mark((function e(t,n){var c,r,a,i,s,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.dispatch,e.next=3,We();case 3:return i=e.sent,s=null!==(c=null===i||void 0===i?void 0:i.webId)&&void 0!==c?c:"",o=null!==(r=null===i||void 0===i?void 0:i.isLoggedIn)&&void 0!==r&&r,a(Me(s)),e.abrupt("return",{webId:s,isLoggedIn:o});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),$e=Object(D.b)("login/login",function(){var e=Object(L.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ge=Object(D.b)("login/logout",Object(L.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ze();case 2:case"end":return e.stop()}}),e)})))),Ye=Object(D.c)({name:"login",initialState:{webId:"",isLoggedIn:!1,status:"loading"},reducers:{},extraReducers:function(e){e.addCase(Be.pending,(function(e){e.status="loading"})).addCase(Be.fulfilled,(function(e,t){e.status="idle",e.webId=t.payload.webId,e.isLoggedIn=t.payload.isLoggedIn})).addCase($e.pending,(function(e){e.status="loading"})).addCase($e.fulfilled,(function(e){e.status="idle"})).addCase(Ge.pending,(function(e){e.status="loading"})).addCase(Ge.fulfilled,(function(e){e.status="idle",e.webId="",e.isLoggedIn=!1}))}}),Je=function(e){return{webId:e.login.webId,isLoggedIn:e.login.isLoggedIn}},Xe=function(e){return e.login.webId},He=function(e){return e.login.isLoggedIn},Ze=Object(M.a)(Xe,(function(e){var t=Object(E.a)(/^(.*)profile\/card#me$/g,{storage:1}).exec(e);return(null===t||void 0===t?void 0:t.groups)?t.groups.storage:""})),Ke=function(e){return e.login.status},Qe=Ye.reducer,Ve=["buttonProps","menuProps"];var et=function(e,t){var n,c=function(n){var c=n.buttonProps,a=n.menuProps,i=Object(d.a)(n,Ve),s=Object(r.useState)(!1),o=Object(l.a)(s,2),b=o[0],f=o[1];return Object(h.jsxs)("div",Object(u.a)(Object(u.a)({},i),{},{style:{position:"relative",flexDirection:"column",display:"inline-flex",alignItems:"end",zIndex:3},onMouseLeave:function(){return f(!1)},onBlur:function(e){e.currentTarget.contains(e.relatedTarget)||f(!1)},children:[Object(h.jsx)(e,Object(u.a)(Object(u.a)({},c),{},{onMouseEnter:function(){return f(!0)},onFocus:function(){return f(!0)}})),Object(h.jsx)("div",{style:{position:"relative",width:0,height:0,visibility:b?"visible":"hidden"},children:Object(h.jsx)("div",{className:"box p-0",style:{position:"absolute",right:0,overflow:"hidden"},children:Object(h.jsx)(t,Object(u.a)(Object(u.a)({},a),{},{onClickClose:function(){return f(!1)}}))})})]}))};return c.displayName="WithMenu(".concat((n=e).displayName||n.name||"Component",")"),c},tt=et((function(e){var t=Object.assign({},e);return Object(h.jsx)(O,Object(u.a)(Object(u.a)({},t),{},{children:Object(h.jsx)("i",{className:"icon icon-user"})}))}),(function(e){var t=e.user,n=e.onLogout;return Object(h.jsx)("div",{className:"menu box p-0",children:Object(h.jsxs)("ul",{className:"menu-list",children:[Object(h.jsx)("li",{children:Object(h.jsx)("a",{className:"disabled",children:t.webId})}),Object(h.jsx)("li",{children:Object(h.jsx)("a",{onClick:n,children:"Logout"})})]})})})),nt=function(e){var t=Object.assign({},e),n=N(),c=C(Je);return"loading"===C(Ke)?Object(h.jsx)(O,Object(u.a)(Object(u.a)({},t),{},{disabled:!0,children:Object(h.jsx)("i",{className:"icon icon-spinner animate-pulse"})})):c.isLoggedIn?Object(h.jsx)(tt,{menuProps:{user:c,onLogout:function(){return n(Ge())}},buttonProps:t}):Object(h.jsx)(w,Object(u.a)(Object(u.a)({},t),{},{contentProps:{onLogin:function(e){n($e(e))}},buttonProps:{}}))},ct=n(32),rt=n.n(ct),at=function(e,t){var n=rt.a.dot(e,rt.a.transpose([[].concat(Object(z.a)(t),[1])])),c=Object(l.a)(n,2);return[Object(l.a)(c[0],1)[0],Object(l.a)(c[1],1)[0]]},it=function(e){var t,n=null!==(t=Object.entries(e.dependents).length)&&void 0!==t?t:0;return n=n<1?1:n,5*Math.pow(n,.42)},st={origin:[0,0],distance:20,highlight:5},ot=function(e){var t=Object(r.useState)({width:0,height:0}),n=Object(l.a)(t,2),c=n[0],a=c.width,i=c.height,s=n[1],o=Object(r.useCallback)((function(){var t=function(e){if(e&&e.current){var t=e.current;return{height:t.clientHeight,width:t.clientWidth}}return{height:0,width:0}}(e);s(t)}),[e]);return Object(r.useEffect)((function(){return o(),window.addEventListener("load",o),window.addEventListener("resize",o),function(){window.removeEventListener("resize",o),window.removeEventListener("load",o)}}),[a,i,o]),{width:a,height:i}};var ut=n(22),lt=n(161),dt=n(511),bt=n(512),ft=n(513),jt=n(514),ht=n(515),pt=n(516);var Ot,vt,mt,gt=function e(){var t=this;Object(ut.a)(this,e),this.nodes=[],this.links=[],this.runs=!1,this.simulation=Object(lt.a)().alphaDecay(.005).force("link",Object(dt.a)().id((function(e){return e.uri})).distance(50).strength(.1)).force("linkGravity",function(){var e=[],t=3;function n(n){var c=t*n;e.forEach((function(e){var t=e.source,n=e.target;if("object"===typeof t&&"object"===typeof n&&t.y&&n.y&&t.vy&&n.vy&&t.y<n.y+50){var r=(n.y+50-t.y)/50;t.vy+=c*r,n.vy-=c*r}}))}return n.links=function(t){return e=t,n},n.strength=function(e){return t=e,n},n}().strength(50)).force("charge",Object(bt.a)().strength(-150).distanceMax(500)).force("gravityX",Object(ft.a)(0).strength(.01)).force("gravityY",Object(jt.a)(0).strength(.01)).force("collide",Object(ht.a)((function(e){return e.r+5}))).force("center",Object(pt.a)(0,0)).stop(),this.start=function(e){var n=e.nodes,c=e.links,r=e.onTick;t.nodes=n,t.links=c.map((function(e){return Object(u.a)({},e)})),t.simulation.nodes(t.nodes),t.simulation.force("link").links(t.links),t.simulation.force("linkGravity").links(t.links),t.simulation.on("tick",(function(){r({nodes:t.nodes,links:t.links})})),t.simulation.restart(),t.runs=!0},this.stop=function(){return t.runs=!1,t.simulation.stop()},this.update=function(e){var n=e.nodes,c=e.links;t.simulation.stop();var r=Object.fromEntries(t.nodes.map((function(e){return[e.uri,e]}))),a=n.map((function(e){return Object(u.a)(Object(u.a)(Object(u.a)({},e),{},{x:800*(.5-Math.random()),y:800*(.5-Math.random())},r[e.uri]),{},{r:e.r})}));t.nodes=a,t.links=c.map((function(e){return Object(u.a)({},e)})),t.simulation.nodes(t.nodes),t.simulation.force("link").links(t.links),t.simulation.force("linkGravity").links(t.links),t.simulation.alpha(1).restart()},this.selectNode=function(e){var n=e.x,c=e.y;return t.simulation.find(n,c,40)}},xt=function(e){var t=Object(r.useState)(new gt),n=Object(l.a)(t,1)[0],c=Object(r.useState)({nodes:[],links:[]}),a=Object(l.a)(c,2),i=a[0],s=a[1];return Object(r.useEffect)((function(){var e=Date.now()-20;return n.start({nodes:[],links:[],onTick:function(t){var n=t.nodes,c=t.links,r=Date.now();r>e+20&&(s({nodes:Object(z.a)(n),links:Object(z.a)(c)}),e=r)}}),function(){n.stop()}}),[n]),Object(r.useEffect)((function(){var t=Object.values(e).map((function(e){return{label:e.label.en,x:400*Math.random(),y:400*Math.random(),r:it(e),uri:e.uri}})),c=Object.values(e).reduce((function(e,t){var n=t.uri,c=t.dependencies;return Object.keys(c).forEach((function(t){return e.push({source:n,target:t})})),e}),[]);n.update({nodes:t,links:c})}),[e,n]),{simulation:n,layout:i}},yt=n(517),wt=n(245),kt=function(e,t,n,c){var r=Object(l.a)(t,2),a=r[0],i=r[1];e.font="20px Arial",e.textBaseline="middle",e.textAlign="left",Object.assign(e,c),e.fillText(n,a,i)},Nt=function(e,t,n,c){var r=Object(l.a)(t,2),a=r[0],i=r[1];Object.assign(e,c),e.beginPath(),e.arc(a,i,n,0,2*Math.PI),e.fill()},Ct=function(e,t,n,c){Object.assign(e,c),e.beginPath(),e.moveTo.apply(e,Object(z.a)(t)),e.lineTo.apply(e,Object(z.a)(n)),e.stroke()},Et=function(e){var t=e.graph,n=e.grid,c=e.onTransform,a=e.canvasRef,i=e.width,s=e.height;return Object(r.useEffect)((function(){if(a&&a.current){var e=a.current.getContext("2d");if(e)return e.save(),e.clearRect(0,0,i,s),function(e,t,n,c){for(var r="#fff2",a=c,i=n,s=function(e){return 0===e?2:e%t.highlight===0?1:.5},o=0;o*t.distance+t.origin[0]<=i;){var u=o*t.distance+t.origin[0];u>=0&&Ct(e,[u,0],[u,a],{strokeStyle:r,lineWidth:s(o)}),o++}for(o=-1;o*t.distance+t.origin[0]>=0;){var l=o*t.distance+t.origin[0];l<=i&&Ct(e,[l,0],[l,a],{strokeStyle:r,lineWidth:s(o)}),o--}for(o=0;o*t.distance+t.origin[1]<=a;){var d=o*t.distance+t.origin[1];d>=0&&Ct(e,[0,d],[i,d],{strokeStyle:r,lineWidth:s(o)}),o++}for(o=-1;o*t.distance+t.origin[1]>=0;){var b=o*t.distance+t.origin[1];b<=a&&Ct(e,[0,b],[i,b],{strokeStyle:r,lineWidth:s(o)}),o--}}(e,n,i,s),function(e,t){t.links.forEach((function(t){var n=[t.source.x,t.source.y],c=[t.target.x,t.target.y],r=rt.a.sub(c,n),a=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)),i=rt.a.div(r,a);Ct(e,rt.a.add(n,rt.a.mul(i,t.source.r)),rt.a.sub(c,rt.a.mul(i,t.target.r)),{strokeStyle:"error"===t.style?"red":"white",lineWidth:.5})}));var n="violet",c="red",r="pink",a={node:"#fff8",label:"#fff4"},i=t.nodes.filter((function(e){return"accent"===e.style})),s=t.nodes.filter((function(e){return"focus"===e.style})),o=t.nodes.filter((function(e){return"focus2"===e.style})),u=t.nodes.filter((function(e){return!e.style}));u.forEach((function(t){var n=t.x,c=t.y,r=t.r;return Nt(e,[n,c],r,{fillStyle:a.node})})),u.forEach((function(t){var n=t.x,c=t.y,r=t.r,i=t.label;return kt(e,[n+r+5,c],i,{fillStyle:a.label})})),o.forEach((function(t){var n=t.x,c=t.y,a=t.r;return Nt(e,[n,c],a,{fillStyle:r})})),o.forEach((function(t){var n=t.x,c=t.y,a=t.r,i=t.label;return kt(e,[n+a+5,c],i,{fillStyle:r})})),s.forEach((function(t){var n=t.x,r=t.y,a=t.r;return Nt(e,[n,r],a,{fillStyle:c})})),s.forEach((function(t){var n=t.x,r=t.y,a=t.r,i=t.label;return kt(e,[n+a+5,r],i,{fillStyle:c})})),i.forEach((function(t){var c=t.x,r=t.y,a=t.r;return Nt(e,[c,r],a,{fillStyle:n})})),i.forEach((function(t){var c=t.x,r=t.y,a=t.r,i=t.label;return kt(e,[c+a+5,r],i,{fillStyle:n})}))}(e,t),function(){return e.restore()}}}),[i,s,t,a,n]),Object(r.useEffect)((function(){a&&a.current&&Object(yt.a)(a.current).call(Object(wt.a)().clickDistance(2).scaleExtent([.05,3]).on("zoom",(function(e){var t=e.transform,n=t.x,r=t.y,a=t.k;c([[a,0,n],[0,a,r],[0,0,1]])})))}),[a,c,s,i]),Object(r.useCallback)((function(e){return function(t){if(a&&a.current){var n=a.current.getBoundingClientRect(),c=t.clientX-n.left,r=t.clientY-n.top;e([c,r])}}}),[a])},It=function(e){var t=C(ye),n=Object(l.a)(t,2),c=n[0],a=n[1],i=C(we),s=C(ke),o=C(Ce),d=N(),b=xt(c),f=b.simulation,p=b.layout,O=Object(r.useRef)(null),v=ot(O),m=v.width,g=v.height,x=Object(r.useState)([[1,0,0],[0,1,0],[0,0,1]]),y=Object(l.a)(x,2),w=y[0],k=y[1],E=rt.a.dot(w,[[1,0,m/2],[0,1,g/2],[0,0,1]]),I=Object(r.useCallback)((function(e){k(e)}),[]),S=function(e){return function(t){var n,c=at(rt.a.inv(E),t),r=Object(l.a)(c,2),a=r[0],i=r[1];e(null===(n=f.selectNode({x:a,y:i}))||void 0===n?void 0:n.uri)}},L=S((function(e){return i!==e&&d(ve(e))})),D=S((function(e){return s!==e&&d(me(e))})),M=function(e,t,n,c,r,a){var i=Object.fromEntries(t.nodes.map((function(t){var n=at(e,[t.x,t.y]),c=Object(l.a)(n,2),r=c[0],a=c[1],i=e[0][0]*t.r;return[t.uri,Object(u.a)(Object(u.a)({},t),{},{x:r,y:a,r:i,style:""})]})));r.forEach((function(e){return i[e].style="focus2"})),n&&i[n]&&(i[n].style="accent"),c&&i[c]&&(i[c].style="focus");var s=a.map((function(e){return Q(e)})).flat(),o=t.links.map((function(e){var n="string"===typeof e.source?e.source:"number"===typeof e.source?t.nodes[e.source].uri:e.source.uri,c="string"===typeof e.target?e.target:"number"===typeof e.target?t.nodes[e.target].uri:e.target.uri,r=i[n],a=i[c],o=s.some((function(e){var t=Object(l.a)(e,2),n=t[0],c=t[1];return n===r.uri&&c===a.uri}))?"error":"";return{source:r,target:a,style:o}}));return{nodes:Object.values(i),links:o}}(E,p,i,s,o,a),P=function(e,t){for(var n=t.distance*e[0][0];n<20;)n*=5;return{origin:at(e,t.origin),distance:n,highlight:t.highlight}}(E,st),A=Et({graph:M,grid:P,onTransform:I,canvasRef:O,width:m,height:g}),F=A(L),T=A(D);return Object(h.jsx)("canvas",Object(u.a)(Object(u.a)({},e),{},{ref:O,onMouseMove:F,onMouseOut:function(){return L([1/0,1/0])},width:m,height:g,className:j()(e.className,"has-background-dark"),onClick:T}))},St=b.a.a(Ot||(Ot=Object(o.a)(["\n  color: lightgray;\n  &:hover {\n    color: white;\n  }\n"]))),Lt=b.a.footer(vt||(vt=Object(o.a)(["\n  color: gray;\n"]))),Dt=function(e){return Object(h.jsx)("div",Object(u.a)(Object(u.a)({},e),{},{children:Object(h.jsxs)(Lt,{children:["powered by ",Object(h.jsx)(St,{href:"https://solidproject.org",children:"Solid"})," \xb7"," ",Object(h.jsx)(St,{href:"https://github.com/livegraph-org/solid-math",children:"source"})]})}))},Mt=y((function(e){var t=Object.assign({},e);return Object(h.jsx)("a",Object(u.a)(Object(u.a)({},t),{},{children:"Add Document"}))}),(function(e){var t=e.onFinish,n=void 0===t?function(){}:t,c=C(Ze),a=N(),i=Object(r.useState)(!0),s=Object(l.a)(i,2),o=s[0],u=s[1],d=Object(r.useState)(""),b=Object(l.a)(d,2),f=b[0],j=b[1];return Object(h.jsx)("section",{children:Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a(Pe({uri:"".concat(c).concat(o?"public":"private","/math/").concat(f,".ttl"),isPublic:o})),n()},children:[Object(h.jsxs)("div",{className:"field buttons are-small has-addons",children:[Object(h.jsx)("input",{className:"button".concat(o?" is-success":""),type:"button",value:"Public",onClick:function(){return u(!0)}}),Object(h.jsx)("input",{className:"button".concat(o?"":" is-warning"),type:"button",value:"Private",onClick:function(){return u(!1)}})]}),Object(h.jsxs)("div",{className:"field",children:[c,o?"public":"private","/math/",Object(h.jsx)("input",{type:"text",value:f,placeholder:"set-theory",onChange:function(e){return j(e.target.value)}}),".ttl"]}),Object(h.jsxs)("div",{className:"field buttons",children:[Object(h.jsx)("input",{className:"button is-success",type:"submit",value:"Create"}),Object(h.jsx)("input",{className:"button is-danger",type:"reset",value:"Cancel",onClick:n})]})]})})}),"Add a document"),Pt=et((function(e){var t=Object.assign({},e);return Object(h.jsx)(O,Object(u.a)(Object(u.a)({},t),{},{children:Object(h.jsx)("i",{className:"icon icon-plus","aria-label":"add"})}))}),(function(e){var t=e.onAddMath,n=e.onClickClose;return Object(h.jsx)("div",{className:"menu box p-0",children:Object(h.jsxs)("ul",{className:"menu-list",children:[Object(h.jsx)("li",{children:Object(h.jsx)(Mt,{buttonProps:{onClick:n}})}),Object(h.jsx)("li",{children:Object(h.jsx)("a",{onClick:function(){n(),t()},children:"Add Math"})})]})})})),At=function(e){var t="";return e.read&&(t+="R"),e.write&&(t+="W"),e.append&&(t+="A"),t},Ft=function(e){var t=At(e.user);return e.public&&(t+=" ",t+=At(e.public)),t||"none"},Tt=function(){var e=C(Te),t=C(Re),n=N();return Object(h.jsx)("ul",{children:e.map((function(e){var c=e.uri,r=e.access;return Object(h.jsx)("li",{children:Object(h.jsxs)("button",{className:j()("button is-small",c===t&&"is-success"),disabled:!(r.user.write||r.user.append),onClick:function(){return n(Fe(c))},children:[c," ",Ft(r)]})},c)}))})},qt=y((function(e){var t=Object.assign({},e);return Object(h.jsx)(O,Object(u.a)(Object(u.a)({},t),{},{children:Object(h.jsx)("i",{className:"icon icon-document","aria-label":"Math Documents"})}))}),Tt,"Math Documents"),Rt=function(e){var t=Object.assign({},e),n=N(),c=C(He);return Object(h.jsxs)("div",Object(u.a)(Object(u.a)({},t),{},{children:[Object(h.jsx)(O,{"aria-label":"people",onClick:function(){return alert("people control not implemented")},children:Object(h.jsx)("i",{className:"icon icon-users"})}),Object(h.jsx)(qt,{}),c&&Object(h.jsx)(Pt,{buttonProps:{},menuProps:{onAddMath:function(){return n(ge(!0))}}})]}))},_t=Object(D.c)({name:"search",initialState:{query:"",queryAutocomplete:""},reducers:{setSearch:function(e,t){e.query=t.payload},setAutocomplete:function(e,t){e.queryAutocomplete=t.payload}}}),Wt=_t.actions,Ut=Wt.setSearch,zt=Wt.setAutocomplete,Bt=function(e){return e.search.query},$t=Object(M.a)(Bt,xe,(function(e,t){return e.length<2?[]:Object.values(t).filter((function(t){return t.label.en.toLowerCase().includes(e.toLowerCase())})).sort((function(e,t){var n=e.dependents,c=t.dependents;return Object.values(c).length-Object.values(n).length})).map((function(e){return{value:e.uri,label:e.label.en}})).slice(0,10)})),Gt=Object(M.a)((function(e){return e.search.queryAutocomplete}),xe,(function(e,t){return e.length<2?[]:Object.values(t).filter((function(t){return t.label.en.toLowerCase().includes(e.toLowerCase())})).sort((function(e,t){var n=e.dependents,c=t.dependents;return Object.values(c).length-Object.values(n).length})).slice(0,10)})),Yt=_t.reducer,Jt=function(e){var t=Object.assign({},e),n=C(Bt),c=C($t),a=N(),i=Object(r.useState)(!1),s=Object(l.a)(i,2),o=s[0],d=s[1],b=Object(r.useCallback)((function(){d(!1),a(Ut(""))}),[a]);return Object(r.useEffect)((function(){var e=function(e){"Escape"===e.key&&b()};return document.addEventListener("keydown",e,!1),function(){return document.removeEventListener("keydown",e,!1)}}),[b]),o?Object(h.jsxs)("div",Object(u.a)(Object(u.a)({},t),{},{className:"box p-0",children:[Object(h.jsxs)("p",{className:"control has-icons-right",children:[Object(h.jsx)("input",{autoFocus:!0,type:"text",className:"input",placeholder:"Search",value:n,onChange:function(e){return a(Ut(e.target.value))}}),Object(h.jsx)("span",{className:"icon is-right",children:Object(h.jsx)("i",{className:"icon icon-search"})})]}),Object(h.jsx)("div",{className:"menu",children:Object(h.jsx)("ul",{className:"menu-list",children:c.map((function(e){var t=e.value,n=e.label;return Object(h.jsx)("li",{title:t,onMouseEnter:function(){return a(ve(t))},onMouseLeave:function(){return a(ve(""))},children:Object(h.jsx)("a",{onClick:function(){a(me(t)),b()},children:n})},t)}))})})]})):Object(h.jsx)(O,{onClick:function(){return d(!0)},children:Object(h.jsx)("i",{className:"icon icon-search"})})},Xt=["info","onClose"],Ht=function(e){var t=e.info,n=e.onClose,c=Object(d.a)(e,Xt);if(!t.message)return null;var r="success"===t.type?"success":"error"===t.type?"danger":"info";return Object(h.jsx)("div",Object(u.a)(Object(u.a)({},c),{},{children:Object(h.jsxs)("div",{className:j()("notification","is-".concat(r)),children:[Object(h.jsx)("button",{className:"delete",onClick:n}),t.message]})}))},Zt=function(e){var t=Object.assign({},e),n=C(_),c=N();return Object(h.jsx)(Ht,Object(u.a)({info:n,onClose:function(){return c(R())}},t))},Kt=(n(481),n(244)),Qt=n(247),Vt=n(246),en=b.a.div(mt||(mt=Object(o.a)(["\n  img {\n    max-width: 100%;\n  }\n"])));function tn(e){var t={children:e.children,remarkPlugins:[Qt.a],rehypePlugins:[Vt.a]};return Object(h.jsx)(en,{children:Object(h.jsx)(Kt.a,Object(u.a)({},t))})}var nn,cn,rn,an,sn,on,un=function(e){var t=e.node;return Object(h.jsx)(tn,{children:t.description.en})},ln=function(e){var t=e.value,n=e.onChange;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("span",{className:"has-text-grey is-size-7",children:["You can use"," ",Object(h.jsx)("a",{href:"https://www.markdownguide.org/basic-syntax/",children:"Markdown"})," and"," ",Object(h.jsx)("a",{href:"http://asciimath.org/",children:"AsciiMath"})," (use $inline math$ and $$multiline math$$)."]}),Object(h.jsx)("textarea",{className:"textarea",placeholder:"description",value:t,onChange:function(e){return n(e.target.value)}}),Object(h.jsx)(tn,{children:t})]})},dn=function(e){var t=e.value,n=e.onChange;return Object(h.jsx)("input",{className:"input is-small",type:"text",placeholder:"label",value:t,onChange:function(e){return n(e.target.value)},size:10})},bn=function(e){var t=e.uri,n=e.label;return Object(h.jsx)("a",{href:t,children:n})},fn=n(243),jn=n.n(fn),hn=(n(499),function(e){var t=e.title,n=e.nodes,c=N();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("header",{className:"card-header",children:Object(h.jsxs)("p",{className:"card-header-title",children:[t,": ",n.length]})}),Object(h.jsx)("section",{className:"card-content",children:Object(h.jsx)("ul",{className:"buttons are-small",children:n.map((function(e){return Object(h.jsx)("li",{onClick:function(){return c(me(e.uri))},onMouseEnter:function(){return c(ve(e.uri))},onMouseLeave:function(){return c(ve(""))},className:"button is-link is-inverted",children:e.label.en},e.uri)}))})})]})}),pn=function(e){var t=e.title,n=e.nodes,c=e.onAddNode,r=e.onRemoveNode,a=N(),i=Object.values(n).map((function(e){return{id:e.uri,name:e.label.en}})),s=C(Gt),o=s.map((function(e){var t=e.label;return{id:e.uri,name:t.en}}));return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("header",{className:"card-header",children:Object(h.jsxs)("p",{className:"card-header-title",children:[t,": ",n.length]})}),Object(h.jsx)("section",{className:"card-content",children:Object(h.jsx)(jn.a,{suggestions:o,tags:i,onInput:function(e){return a(zt(e))},onAddition:function(e){var t=s.find((function(t){return t.uri===e.id}));t&&c(t)},onDelete:function(e){r(n[e])},placeholderText:"Add a dependency",removeButtonText:"Remove the dependency",classNames:{root:"react-tags",rootFocused:"is-focused",selected:"react-tags__selected tags",selectedTag:"react-tags__selected-tag",selectedTagName:"react-tags__selected-tag-name",search:"react-tags__search",searchInput:"react-tags__search-input",suggestions:"react-tags__suggestions",suggestionActive:"is-active",suggestionDisabled:"is-disabled"},allowBackspace:!1,tagComponent:On})})]})},On=function(e){var t=e.tag,n=e.removeButtonText,c=e.onDelete;return Object(h.jsxs)("span",{className:"tag is-info",children:[t.name,Object(h.jsx)("button",{title:n,onClick:c,className:"delete is-small"})]})},vn=function(e){var t=e.value,n=e.onChange;return Object(h.jsx)("div",{className:"tags",children:t?Object(h.jsxs)("span",{className:"tag is-info",children:[t,Object(h.jsx)("button",{className:"delete is-small",onClick:function(){return n("")}})]}):["definition","statement"].map((function(e){return Object(h.jsx)("span",{className:"tag is-info is-light",onClick:function(){return n(e)},children:e},e)}))})},mn=function(e){var t=e.value;return Object(h.jsx)("span",{className:"tag is-info",children:t})},gn=function(e,t){var n=t.split("/"),c=e.split("/"),r=c.findIndex((function(e,t){return e!==n[t]}));return r<3?e:c.slice(r).join("/")},xn=function(e){var t=e.onFinish,n=N(),c=C(Ne),a=C(Ee),i=C(qe),s=C(Re),o=C(Xe),u=Object(r.useState)(c?"":a.type),d=Object(l.a)(u,2),b=d[0],f=d[1],j=Object(r.useState)(c?"":a.label.en),p=Object(l.a)(j,2),O=p[0],v=p[1],m=Object(r.useState)(c?"":a.description.en),g=Object(l.a)(m,2),x=g[0],y=g[1],w=Object(r.useState)(c?[]:Object.values(a.dependencies)),k=Object(l.a)(w,2),E=k[0],I=k[1],S=b&&O&&x&&(s||a.document),L=Object(r.useCallback)((function(){f(c?"":a.type),v(c?"":a.label.en),y(c?"":a.description.en),I(c?[]:Object.values(a.dependencies))}),[a,c]),D=function(){if(!b)throw new Error("please select a type");if(!O)throw new Error("please specify a label");if(!x)throw new Error("please write a description");if(c&&!s)throw new Error("please select a document");n(c?je({type:b,label:{en:O},description:{en:x},dependencies:E.map((function(e){return e.uri})),document:s}):fe({type:b,label:{en:O},description:{en:x},dependencies:E.map((function(e){return e.uri})),id:a.uri,document:a.document.id})),M()};Object(r.useEffect)((function(){L()}),[a,L]);var M=function(){L(),t()};return Object(h.jsxs)("div",{className:"card",children:[Object(h.jsxs)("header",{className:"card-header",children:[Object(h.jsx)("div",{className:"card-header-title",children:Object(h.jsxs)("div",{className:"block is-flex-grow-1",children:[Object(h.jsx)("div",{className:"title is-6",children:c?"Create a new Math":Object(h.jsxs)(h.Fragment,{children:["Edit a ",a.type," ",Object(h.jsx)("i",{children:a.label.en})]})}),Object(h.jsx)("div",{className:"field",children:Object(h.jsx)(dn,{value:O,onChange:v})}),Object(h.jsx)("div",{className:"field",children:Object(h.jsx)(vn,{value:b,onChange:f})}),c&&Object(h.jsx)("div",{className:"field select",children:Object(h.jsxs)("select",{value:s,onChange:function(e){return n(Fe(e.target.value))},children:[Object(h.jsx)("option",{hidden:!0,disabled:!0,value:"",children:" -- select a document to save to -- "}),i.map((function(e){return Object(h.jsx)("option",{value:e.uri,children:gn(e.uri,o)},e.uri)}))]})})]})}),Object(h.jsx)("button",{className:"card-header-icon","aria-label":"cancel editing",title:"cancel editing",onClick:M,children:Object(h.jsx)("i",{className:"icon icon-cancel has-text-danger","aria-hidden":"true"})}),Object(h.jsx)("button",{className:"card-header-icon has-text-".concat(S?"success":"grey-light"),"aria-label":"save changes",title:"save changes",onClick:D,disabled:!S,children:Object(h.jsx)("i",{className:"icon icon-ok","aria-hidden":"true"})})]}),Object(h.jsx)("section",{className:"card-content",children:Object(h.jsx)(ln,{value:x,onChange:y})}),Object(h.jsx)(pn,{title:"dependencies",nodes:E,onAddNode:function(e){I((function(t){return[].concat(Object(z.a)(t),[e])}))},onRemoveNode:function(e){I((function(t){return t.filter((function(t){return t.uri!==e.uri}))}))}}),Object(h.jsxs)("footer",{className:"card-footer",children:[Object(h.jsxs)("button",{className:"card-header-icon card-footer-item","aria-label":"cancel editing",title:"cancel editing",onClick:M,children:[Object(h.jsx)("i",{className:"icon icon-cancel has-text-danger","aria-hidden":"true"})," ","Cancel"]}),Object(h.jsxs)("button",{className:"card-header-icon card-footer-item has-text-".concat(S?"success":"grey-light"),"aria-label":"save changes",title:"save changes",onClick:D,disabled:!S,children:[Object(h.jsx)("i",{className:"icon icon-ok","aria-hidden":"true"})," Save"]})]})]})},yn=["uri","onFinish","onDelete"],wn=y((function(e){var t=Object.assign({},e);return Object(h.jsx)("button",Object(u.a)(Object(u.a)({},t),{},{className:"button is-danger is-inverted",children:"Delete Node"}))}),(function(e){var t=e.uri,n=e.onFinish,c=void 0===n?function(){return null}:n,a=e.onDelete,i=Object(d.a)(e,yn),s=new URL(t).hash||String(Date.now()),o=Object(r.useState)(""),b=Object(l.a)(o,2),f=b[0],j=b[1],p=s!==f;return Object(h.jsxs)("div",Object(u.a)(Object(u.a)({},i),{},{children:["If yes, please retype the text ",Object(h.jsx)("code",{children:s})," below.",Object(h.jsx)("div",{className:"field",children:Object(h.jsx)("input",{maxLength:s.length,className:"input",type:"text",value:f,onChange:function(e){return j(e.target.value)}})}),Object(h.jsxs)("div",{className:"buttons",children:[Object(h.jsx)("button",{className:"button is-danger",disabled:p,onClick:function(){c(),a()},children:"Delete"}),Object(h.jsx)("button",{className:"button is-info is-inverted",onClick:c,children:"Cancel"})]})]}))})),kn=function(e){var t=e.onEdit,n=N(),c=C(Ee);"aa"===c.label.en&&console.log(c);var r=Object.values(c.dependencies),a=Object.values(c.dependents),i=c.document.access.user.write;return Object(h.jsxs)("div",{className:"card",children:[Object(h.jsxs)("header",{className:"card-header",children:[Object(h.jsx)("div",{className:"card-header-title",children:Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:Object(h.jsx)(bn,{uri:c.uri,label:c.label.en})}),Object(h.jsx)("div",{children:Object(h.jsx)(mn,{value:c.type})})]})}),i&&Object(h.jsx)("button",{className:"card-header-icon","aria-label":"edit label",onClick:t,children:Object(h.jsx)("i",{className:"icon icon-edit","aria-hidden":"true"})}),Object(h.jsx)("span",{className:"card-header-icon",children:Object(h.jsx)("button",{className:"delete","aria-label":"close",onClick:function(){return n(me(""))},children:"close"})})]}),Object(h.jsx)("section",{className:"card-content",children:Object(h.jsx)(un,{node:c})}),Object(h.jsx)(hn,{title:"dependencies",nodes:r}),Object(h.jsx)(hn,{title:"dependents",nodes:a}),i&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("header",{className:"card-header",children:Object(h.jsx)("p",{className:"card-header-title has-text-danger",children:"Danger Zone"})}),Object(h.jsx)("section",{className:"card-content has-background-danger",children:Object(h.jsx)(wn,{title:"Do you really want to delete ".concat(c.type," ").concat(c.label.en,"?"),contentProps:{uri:c.uri,onDelete:function(){return n(he(c))}}})})]})]})},Nn=function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1],a=C(ke),i=C(Ne),s=N();return Object(r.useEffect)((function(){c(!1)}),[a]),i?Object(h.jsx)(xn,{onFinish:function(){return s(ge(!1))}}):a?n?Object(h.jsx)(xn,{onFinish:function(){return c(!1)}}):Object(h.jsx)(kn,{onEdit:function(){return c(!0)}}):null},Cn=b.a.div(nn||(nn=Object(o.a)(["\n  position: fixed;\n  width: 100%;\n  top: 0;\n  bottom: 0;\n  pointer-events: none;\n  overflow-x: hidden;\n  overflow-y: auto;\n"]))),En=b.a.div(cn||(cn=Object(o.a)(["\n  pointer-events: all;\n  overflow-x: auto;\n  width: 100%;\n"]))),In=function(e){var t=e.children;return Object(h.jsx)(Cn,{children:Object(h.jsx)("div",{className:"columns mr-1 mt-6",children:Object(h.jsx)("div",{className:"column is-one-quarter is-offset-three-quarters",children:Object(h.jsx)(En,{children:t})})})})},Sn=Object(b.a)(Dt)(rn||(rn=Object(o.a)(["\n  position: fixed;\n  bottom: 1rem;\n  right: 1rem;\n"]))),Ln=Object(b.a)(Zt)(an||(an=Object(o.a)(["\n  position: fixed;\n  bottom: 0.5rem;\n  left: 0.5rem;\n"]))),Dn=Object(b.a)(It)(sn||(sn=Object(o.a)(["\n  height: 100vh;\n  width: 100vw;\n  display: block;\n"]))),Mn=b.a.nav(on||(on=Object(o.a)(["\n  display: flex;\n  position: absolute;\n  width: 100%;\n  pointer-events: none;\n  justify-content: space-between;\n  & > * {\n    pointer-events: all;\n  }\n  padding: 1rem;\n"]))),Pn=function(){return Object(h.jsx)(In,{children:Object(h.jsx)(Nn,{})})},An=function(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(Mn,{children:[Object(h.jsx)(Rt,{}),Object(h.jsxs)("div",{style:{display:"flex"},children:[Object(h.jsx)(Jt,{style:{display:"inline-block",position:"relative",zIndex:2}}),Object(h.jsx)(nt,{})]})]}),Object(h.jsx)(Sn,{}),Object(h.jsx)(Ln,{}),Object(h.jsx)(Pn,{}),Object(h.jsx)(Dn,{})]})},Fn=function(){var e=N();return Object(r.useEffect)((function(){e(Be())}),[e]),Object(h.jsx)(An,{})},Tn=Object(D.a)({reducer:{login:Qe,math:Ie,search:Yt,document:_e,info:W}}),qn=function(e){e&&e instanceof Function&&n.e(5).then(n.bind(null,544)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};if("object"===typeof document){var Rn=document.querySelector("#root");m.a.setAppElement(Rn)}s.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(k.a,{store:Tn,children:Object(h.jsx)(Fn,{})})}),document.getElementById("root")),qn()}},[[500,1,2]]]);
//# sourceMappingURL=main.ee0f27e5.chunk.js.map