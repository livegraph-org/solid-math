(this.webpackJsonpmath=this.webpackJsonpmath||[]).push([[0],{265:function(e,t,n){},266:function(e,t,n){},267:function(e,t,n){},468:function(e,t){},503:function(e,t,n){},504:function(e,t,n){"use strict";n.r(t);var r,c=n(3),a=n.n(c),i=n(78),s=n.n(i),o=(n(265),n(266),n(267),n(30)),u=n(6),l=n(7),d=n(33),b=n(31),f=n(44),j=n.n(f),h=n(1),p=["children","className"],O=Object(b.a)((function(e){var t=e.children,n=e.className,r=Object(d.a)(e,p);return Object(h.jsx)("button",Object(u.a)(Object(u.a)({className:j()(n,"button")},r),{},{children:t}))}))(r||(r=Object(o.a)(["\n  &:not(:hover) {\n    background-color: #0000;\n    border-color: #0000;\n    color: #fff;\n  }\n  &:hover {\n  }\n  &:active {\n    background-color: #eee;\n  }\n"]))),v=n(110),m=n.n(v),g=["buttonProps","contentProps","title"];function x(e){return e.displayName||e.name||"Component"}var y=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=function(r){var a=r.buttonProps,i=void 0===a?{}:a,s=r.contentProps,o=void 0===s?{}:s,b=r.title,f=void 0===b?"":b,p=Object(d.a)(r,g),O=Object(c.useState)(!1),v=Object(l.a)(O,2),x=v[0],y=v[1],w=f||n||"";return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(e,Object(u.a)(Object(u.a)(Object(u.a)({},i),p),{},{className:j()(null===i||void 0===i?void 0:i.className,null===p||void 0===p?void 0:p.className),onClick:function(e){e.preventDefault(),y(!0),i.onClick&&i.onClick(e)}})),x&&Object(h.jsxs)(m.a,{isOpen:x,onRequestClose:function(){return y(!1)},contentLabel:w,overlayClassName:{base:"modal modal-background is-active",afterOpen:"",beforeClose:""},className:{base:"modal-content",afterOpen:"",beforeClose:""},closeTimeoutMS:50,children:[Object(h.jsx)("button",{className:"modal-close",onClick:function(){return y(!1)},children:"close"}),Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("header",{className:"card-header",children:Object(h.jsx)("p",{className:"card-header-title",children:w})}),Object(h.jsx)("div",{className:"card-content",children:Object(h.jsx)(t,Object(u.a)(Object(u.a)({},o),{},{onFinish:function(){return y(!1)}}))})]})]})]})};return r.displayName="WithModal(".concat(x(e),")"),r},w=y((function(e){var t=Object.assign({},e);return Object(h.jsx)(O,Object(u.a)(Object(u.a)({},t),{},{children:"Login"}))}),(function(e){var t,n=e.onLogin,r=Object(c.useState)(null!==(t=localStorage.getItem("idp"))&&void 0!==t?t:"https://solidcommunity.net"),a=Object(l.a)(r,2),i=a[0],s=a[1];return Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),localStorage.setItem("idp",i),n(i)},children:[Object(h.jsx)("div",{className:"field",children:Object(h.jsx)("div",{className:"control",children:Object(h.jsx)("input",{id:"idp",className:"input",type:"url",value:i,onChange:function(e){e.preventDefault();var t=e.currentTarget.value;s(t)},placeholder:"Where is your Solid Pod?"})})}),Object(h.jsx)("div",{className:"field",children:Object(h.jsx)("div",{className:"control",children:Object(h.jsx)("input",{type:"submit",value:"Connect",className:"button is-link"})})})]})}),"Select your Solid identity provider"),k=n(86),N=function(){return Object(k.b)()},C=k.c,E=n(232),I=n(0),S=n.n(I),L=n(5),D=n(17),M=n(107),P={message:"",type:"info"},T=function(e){return function(){var t=Object(L.a)(S.a.mark((function t(n,r){var c;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(R(e)),t.next=3,new Promise((function(e){setTimeout(e,5e3)}));case 3:(c=_(r())).message===e.message&&c.type===e.type&&n(q());case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},A=Object(D.c)({name:"info",initialState:P,reducers:{setInfo:function(e,t){return t.payload},clearInfo:function(){return P}}}),F=A.actions,R=F.setInfo,q=F.clearInfo,_=function(e){return e.info},W=A.reducer,U=n(24),z=n(12),B=n(119),$=n.n(B),G=n(233),H=n.n(G),Y=n(234),J=n.n(Y);var X,Z=function(e){var t=new $.a.Graph;Object.values(e).forEach((function(e){t.setNode(e.uri),Object.values(e.dependencies).forEach((function(n){return t.setEdge(e.uri,n.uri)}))}));var n=Object.fromEntries(Object.entries(e).map((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1];return[n,Object(u.a)(Object(u.a)({},r),{},{dependencies:{},dependents:{}})]}))),r=function(e){if(!$.a.alg.isAcyclic(e))throw new Error("pruning is possible on DAG only");return e.edges().forEach((function(t){e.removeEdge(t),$.a.alg.dijkstra(e,t.v)[t.w].distance===1/0&&e.setEdge(t)})),e}(t).edges().map((function(e){return{source:e.v,target:e.w}}));return r.forEach((function(e){var t=e.source,r=e.target;n[t].dependencies[r]=n[r],n[r].dependents[t]=n[t]})),n},K=function(e){var t=function(e){var t=Object.keys(e).sort(),n=Array(t.length).fill(null).map((function(){return[]}));return t.forEach((function(r,c){n[c]=Object.keys(e[r].dependencies).map((function(e){return t.findIndex((function(t){return t===e}))}))})),[n,t]}(e),n=Object(l.a)(t,2),r=n[0],c=n[1],a=function(e){return e.map((function(e,t){return[e,t]})).filter((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1];return n.includes(r)})).map((function(e){return[Object(l.a)(e,2)[1]]}))}(r),i=H()(r).filter((function(e){return e.length>2})).map((function(e){return e.slice(0,-1)}));return[].concat(Object(z.a)(a),Object(z.a)(i)).map((function(e){return e.map((function(e){return c[e]}))}))},Q=function(e){return e.map((function(e,t,n){return[n[t],n[(t+1)%n.length]]}))},V=function(e,t){return t.forEach((function(t){var n=Object(l.a)(t,2),r=n[0],c=n[1];delete e[r].dependencies[c],delete e[c].dependents[r]})),e},ee=function(e,t){return t.forEach((function(t){var n=Object(l.a)(t,2),r=n[0],c=n[1];e[r].dependencies[c]=e[c],e[c].dependents[r]=e[r]})),e},te=n(10),ne=n(18),re=n(19),ce={definition:"https://terms.math.livegraph.org#Definition",statement:"https://terms.math.livegraph.org#Statement",dependsOn:"https://terms.math.livegraph.org#dependsOn"},ae=function(){var e=Object(L.a)(S.a.mark((function e(t){var n,r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.g)(t,{fetch:ne.fetch});case 2:return n=e.sent,r=Object(te.k)(n),c={nodes:[],links:[]},r.forEach((function(e){var n=le(e,t);c.nodes.push(n),Object(te.i)(e,ce.dependsOn).forEach((function(e){c.links.push([n.id,e.value])}))})),e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(L.a)(S.a.mark((function e(t){var n,r,c,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.g)(t.document,{fetch:ne.fetch});case 2:if(n=e.sent,!(r=Object(te.j)(n,t.id))){e.next=15;break}if(c=r,t.label&&(c=Object(te.r)(c,re.c.label,t.label.en,"en")),t.type&&(c=Object(te.t)(c,re.b.type,ce[t.type])),t.description&&(c=Object(te.r)(c,re.b.value,t.description.en,"en")),t.dependencies&&(c=Object(te.n)(c,ce.dependsOn),t.dependencies.forEach((function(e){c=Object(te.a)(c,ce.dependsOn,e)}))),c===r){e.next=14;break}return a=Object(te.s)(n,c),e.next=14,Object(te.q)(t.document,a,{fetch:ne.fetch});case 14:return e.abrupt("return",le(c,t.document));case 15:throw new Error("node to update not found");case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(L.a)(S.a.mark((function e(t){var n,r,c,a,i;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.g)(t.document,{fetch:ne.fetch});case 2:return n=e.sent,r=oe(t.document,n,t.label.en),c=Object(te.c)({url:r}).setStringWithLocale(re.c.label,t.label.en,"en").setUrl(re.b.type,ce[t.type]).setStringWithLocale(re.b.value,t.description.en,"en"),t.dependencies.forEach((function(e){c.addUrl(ce.dependsOn,e)})),a=c.build(),i=Object(te.s)(n,a),e.next=10,Object(te.q)(t.document,i,{fetch:ne.fetch});case 10:return e.abrupt("return",le(a,t.document));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(e,t,n){for(var r="".concat(e,"#").concat(function(e){return e.toLowerCase().trim().replace(/[^a-z0-9.\s_-]/g,"").trim().replace(/\s/g,"_").replace(/\./g,"_")}(n)),c=function(e){return e>0?"".concat(r,"_").concat(e):r},a=0;Object(te.j)(t,c(a));)a++;return c(a)},ue=function(){var e=Object(L.a)(S.a.mark((function e(t){var n,r,c,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.g)(t.document.uri,{fetch:ne.fetch});case 2:if(n=e.sent,r=Object(te.j)(n,t.uri),c=Object(te.k)(n).filter((function(e){return e.url!==t.uri})).filter((function(e){return Object(te.l)(e,ce.dependsOn)})).map((function(e){return Object(te.p)(e,ce.dependsOn,t.uri)})),!r){e.next=10;break}return a=Object(te.o)(n,r),c.forEach((function(e){a=Object(te.s)(a,e)})),e.next=10,Object(te.q)(t.document.uri,a,{fetch:ne.fetch});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(e,t){var n,r,c,a,i,s,o=Object(te.b)(e),u=null!==(n=null===(r=Object(te.h)(e,re.b.type))||void 0===r?void 0:r.value)&&void 0!==n?n:"",l=null!==(c=null===(a=Object(te.h)(e,re.b.value))||void 0===a?void 0:a.value)&&void 0!==c?c:"",d=null!==(i=null===(s=Object(te.h)(e,re.c.label))||void 0===s?void 0:s.value)&&void 0!==i?i:"",b=Object(te.m)(e,ce.dependsOn);switch(u){case ce.definition:return{id:o,type:"definition",label:{en:d},description:{en:l},dependencies:b,dependents:[],examples:[],created:0,updated:0,document:t};case ce.statement:return{id:o,type:"statement",label:{en:d},description:{en:l},dependencies:b,dependents:[],examples:[],proofs:[],created:0,updated:0,document:t};default:throw new Error("thing is not a Definition or Statement")}},de=["id","document"],be=Object(D.b)("math/addGraph",function(){var e=Object(L.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),fe=Object(D.b)("math/updateNode",function(){var e=Object(L.a)(S.a.mark((function e(t,n){var r,c,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=n.dispatch)(T({type:"info",message:"saving ..."})),e.prev=2,e.next=5,ie(t);case 5:return c=e.sent,r(T({type:"success",message:"... saved"})),e.abrupt("return",c);case 10:throw e.prev=10,e.t0=e.catch(2),a="updating failed",e.t0 instanceof Error&&(a+=": ".concat(e.t0.message)),r(T({type:"error",message:a})),e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n){return e.apply(this,arguments)}}()),je=Object(D.b)("math/createNode",function(){var e=Object(L.a)(S.a.mark((function e(t,n){var r,c,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=n.dispatch)(T({type:"info",message:"saving ..."})),e.prev=2,e.next=5,se(t);case 5:return c=e.sent,r(T({type:"success",message:"... saved"})),e.abrupt("return",c);case 10:throw e.prev=10,e.t0=e.catch(2),a="creating failed",e.t0 instanceof Error&&(a+=": ".concat(e.t0.message)),r(T({type:"error",message:a})),e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n){return e.apply(this,arguments)}}()),he=Object(D.b)("math/deleteNode",function(){var e=Object(L.a)(S.a.mark((function e(t,n){var r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=n.dispatch)(T({type:"info",message:"deleting ..."})),e.prev=2,e.next=5,ue(t);case 5:return r(T({type:"success",message:"... deleted"})),e.abrupt("return",Object(u.a)(Object(u.a)({},t),{},{id:t.uri,dependencies:Object.keys(t.dependencies),dependents:Object.keys(t.dependents),document:t.document.uri}));case 9:throw e.prev=9,e.t0=e.catch(2),c="deleting failed",e.t0 instanceof Error&&(c+=": ".concat(e.t0.message)),r(T({type:"error",message:c})),e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}()),pe=Object(D.c)({name:"math",initialState:{entities:{node:{byId:{},allIds:[]}},ui:{highlighted:"",selected:"",create:!1}},reducers:{highlight:function(e,t){e.ui.highlighted=t.payload},select:function(e,t){e.ui.selected=t.payload},createMath:function(e,t){e.ui.create=t.payload}},extraReducers:function(e){e.addCase(be.fulfilled,(function(e,t){var n=t.payload,r=n.nodes,c=n.links;r.forEach((function(t){e.entities.node.byId[t.id]=Object(u.a)(Object(u.a)({},t),{},{dependencies:[]}),e.entities.node.allIds.push(t.id)})),c.forEach((function(t){var n=Object(l.a)(t,2),r=n[0],c=n[1];e.entities.node.byId[c]&&e.entities.node.byId[r]&&(e.entities.node.byId[c].dependents.push(r),e.entities.node.byId[r].dependencies.push(c))}))})).addCase(he.fulfilled,(function(e,t){var n=t.payload,r=n.dependents,c=n.dependencies,a=n.id;r.forEach((function(t){var n=e.entities.node.byId[t].dependencies.filter((function(e){return e!==a}));e.entities.node.byId[t].dependencies=n})),c.forEach((function(t){e.entities.node.byId[t].dependents=e.entities.node.byId[t].dependents.filter((function(e){return e!==a}))})),delete e.entities.node.byId[a],e.entities.node.allIds=e.entities.node.allIds.filter((function(e){return e!==a})),e.ui.selected=""})).addMatcher(Object(D.d)(fe.fulfilled,je.fulfilled),(function(e,t){var n,r,c,a=t.payload;e.entities.node.allIds.includes(a.id)||(e.entities.node.allIds.push(a.id),e.entities.node.byId[a.id]=a),e.entities.node.byId[a.id].label=a.label,e.entities.node.byId[a.id].type=a.type,e.entities.node.byId[a.id].description=a.description,e.entities.node.byId[a.id].dependencies=a.dependencies;var i=null!==(n=null===(r=Object(U.f)(e))||void 0===r||null===(c=r.entities.node.byId[a.id])||void 0===c?void 0:c.dependencies)&&void 0!==n?n:[],s=i.filter((function(e){return!a.dependencies.includes(e)}));a.dependencies.filter((function(e){return!i.includes(e)})).forEach((function(t){e.entities.node.byId[t].dependents.push(a.id)})),s.forEach((function(t){e.entities.node.byId[t].dependents=e.entities.node.byId[t].dependents.filter((function(e){return e!==a.id}))})),e.ui.selected=a.id}))}}),Oe=pe.actions,ve=Oe.highlight,me=Oe.select,ge=Oe.createMath,xe=Object(M.a)((function(e){return e.math.entities.node}),(function(e){return e.document.entities.document}),(function(e,t){var n=e.byId,r=t.byId,c=Object.fromEntries(Object.entries(n).map((function(e){var t=Object(l.a)(e,2),n=t[0],c=t[1],a=c.id,i=c.document,s=Object(d.a)(c,de);return[n,Object(u.a)(Object(u.a)({},s),{},{uri:a,dependencies:{},dependents:{},document:r[i]})]})));return Object.entries(c).forEach((function(e){var t=Object(l.a)(e,2),r=t[0],a=t[1];a.dependencies=Object.fromEntries(n[r].dependencies.map((function(e){return[e,c[e]]}))),a.dependents=Object.fromEntries(n[r].dependents.map((function(e){return[e,c[e]]})))})),c})),ye=Object(M.a)(xe,(function(e){return function(e){e=J()(e);var t=K(e),n=t.map((function(e){return Q(e)})).flat().filter((function(e,t,n){var r=Object(l.a)(e,2),c=r[0],a=r[1];return n.findIndex((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1];return c===n&&a===r}))===t})),r=V(e,n),c=Z(r);return[ee(c,n),t]}(e)})),we=(Object(M.a)(xe,(function(e){return Z(e)})),function(e){return e.math.ui.highlighted}),ke=function(e){return e.math.ui.selected},Ne=function(e){return e.math.ui.create},Ce=Object(M.a)(ke,xe,(function(e,t){var n,r;return e?Object.values(null!==(n=null===(r=t[e])||void 0===r?void 0:r.dependencies)&&void 0!==n?n:{}).map((function(e){return e.uri})):[]})),Ee=Object(M.a)(ke,xe,(function(e,t){return t[e]})),Ie=pe.reducer,Se=function(){var e=Object(L.a)(S.a.mark((function e(t){var n,r,c,a,i,s,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],!t){e.next=13;break}return e.next=4,De(t);case 4:if(r=e.sent,!(c=r.public)){e.next=13;break}return e.next=9,Object(te.g)(c,{fetch:ne.fetch});case 9:a=e.sent,i=Object(te.k)(a),s=i.filter((function(e){return Object(te.i)(e,re.d.forClass).map((function(e){return e.value})).includes("https://terms.math.livegraph.org#Definition")})).map((function(e){return Object(te.i)(e,re.d.instance)})).flat().map((function(e){return e.value})),n=s;case 13:return 0===n.length&&(n=["https://mrkvon.solidcommunity.net/public/math/graph-theory.ttl"]),e.t0=Object,e.next=17,Promise.all(n.map(function(){var e=Object(L.a)(S.a.mark((function e(t){var n,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.g)(t,{fetch:ne.fetch});case 2:return n=e.sent,r=Object(te.f)(n),e.abrupt("return",[t,r]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 17:return e.t1=e.sent,o=e.t0.fromEntries.call(e.t0,e.t1),e.abrupt("return",n.map((function(e){return{id:e,uri:e,access:o[e]}})));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Le=function(){var e=Object(L.a)(S.a.mark((function e(t,n,r){var c,a,i,s,o,u,l,d,b,f,j;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.g)(t,{fetch:ne.fetch});case 3:e.next=29;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=9,Object(te.q)(t,Object(te.d)(),{fetch:ne.fetch});case 9:return e.next=11,Object(te.g)(t,{fetch:ne.fetch});case 11:return c=e.sent,a={id:t,uri:t,access:Object(te.f)(c)},e.next=15,De(n);case 15:if(i=e.sent,!(s=r?i.public:i.private)){e.next=28;break}return e.next=20,Object(te.g)(s,{fetch:ne.fetch});case 20:return u=e.sent,l=null!==(o=Object(te.j)(u,s))&&void 0!==o?o:Object(te.e)({url:s}),d="".concat(s,"#").concat(Date.now()),b=Object(te.c)(l).addUrl(re.a.references,d).build(),f=Object(te.c)(Object(te.e)({url:d})).addUrl(re.b.type,re.d.TypeRegistration).addUrl(re.d.forClass,"https://terms.math.livegraph.org#Definition").addUrl(re.d.forClass,"https://terms.math.livegraph.org#Statement").addUrl(re.d.instance,t).build(),j=Object(te.s)(Object(te.s)(u,b),f),e.next=28,Object(te.q)(s,j,{fetch:ne.fetch});case 28:return e.abrupt("return",a);case 29:throw new Error("document already exists");case 30:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n,r){return e.apply(this,arguments)}}(),De=function(){var e=Object(L.a)(S.a.mark((function e(t){var n,r,c,a,i,s,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.g)(t,{fetch:ne.fetch});case 2:return n=e.sent,r=Object(te.j)(n,t),c={public:"",private:""},r&&(c.public=null!==(a=null===(i=Object(te.h)(r,re.d.publicTypeIndex))||void 0===i?void 0:i.value)&&void 0!==a?a:"",c.private=null!==(s=null===(o=Object(te.h)(r,re.d.privateTypeIndex))||void 0===o?void 0:o.value)&&void 0!==s?s:""),e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=Object(D.b)("math/addDocuments",function(){var e=Object(L.a)(S.a.mark((function e(t,n){var r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,e.next=3,Se(t);case 3:return(c=e.sent).forEach((function(e){return r(be(e.uri))})),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),Pe=Object(D.b)("math/createDocument",function(){var e=Object(L.a)(S.a.mark((function e(t,n){var r,c,a,i,s,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.uri,c=t.isPublic,a=n.getState,i=n.dispatch,s=Je(a()),e.prev=3,i(T({type:"info",message:"creating a new document"})),e.next=7,Le(r,s,c);case 7:return o=e.sent,i(T({type:"success",message:"created a new document"})),e.abrupt("return",o);case 12:throw e.prev=12,e.t0=e.catch(3),e.t0 instanceof Error&&i(T({type:"error",message:e.t0.message})),e.t0;case 16:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t,n){return e.apply(this,arguments)}}()),Te=Object(D.c)({name:"document",initialState:{entities:{document:{byId:{},allIds:[]}},selected:""},reducers:{selectDocument:function(e,t){e.selected=t.payload}},extraReducers:function(e){e.addCase(Me.fulfilled,(function(e,t){e.entities.document={byId:Object.fromEntries(t.payload.map((function(e){return[e.id,e]}))),allIds:t.payload.map((function(e){return e.id}))}})).addCase(Pe.fulfilled,(function(e,t){e.entities.document.allIds.push(t.payload.id),e.entities.document.byId[t.payload.id]=t.payload}))}}),Ae=Te.actions.selectDocument,Fe=Object(M.a)((function(e){return e.document.entities.document}),(function(e){var t=e.byId;return e.allIds.map((function(e){return t[e]}))})),Re=(X=["write","append"],Object(M.a)(Fe,(function(e){return e.filter((function(e){return X.some((function(t){return e.access.user[t]}))}))}))),qe=function(e){return e.document.selected},_e=Te.reducer,We=function(){var e=Object(L.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.handleIncomingRedirect)({url:window.location.href,restorePreviousSession:!0});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(L.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(ne.login)({oidcIssuer:t,redirectUrl:window.location.href,clientName:"Friends Crawler"});case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),alert("Could not find a Solid Pod at ".concat(t)),localStorage.removeItem("idp");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),ze=function(){var e=Object(L.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.logout)();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Be=Object(D.b)("login/init",function(){var e=Object(L.a)(S.a.mark((function e(t,n){var r,c,a,i,s,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.dispatch,e.next=3,We();case 3:return i=e.sent,s=null!==(r=null===i||void 0===i?void 0:i.webId)&&void 0!==r?r:"",o=null!==(c=null===i||void 0===i?void 0:i.isLoggedIn)&&void 0!==c&&c,a(Me(s)),e.abrupt("return",{webId:s,isLoggedIn:o});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),$e=Object(D.b)("login/login",function(){var e=Object(L.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ge=Object(D.b)("login/logout",Object(L.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ze();case 2:case"end":return e.stop()}}),e)})))),He=Object(D.c)({name:"login",initialState:{webId:"",isLoggedIn:!1,status:"loading"},reducers:{},extraReducers:function(e){e.addCase(Be.pending,(function(e){e.status="loading"})).addCase(Be.fulfilled,(function(e,t){e.status="idle",e.webId=t.payload.webId,e.isLoggedIn=t.payload.isLoggedIn})).addCase($e.pending,(function(e){e.status="loading"})).addCase($e.fulfilled,(function(e){e.status="idle"})).addCase(Ge.pending,(function(e){e.status="loading"})).addCase(Ge.fulfilled,(function(e){e.status="idle",e.webId="",e.isLoggedIn=!1}))}}),Ye=function(e){return{webId:e.login.webId,isLoggedIn:e.login.isLoggedIn}},Je=function(e){return e.login.webId},Xe=function(e){return e.login.isLoggedIn},Ze=Object(M.a)(Je,(function(e){var t=Object(E.a)(/^(.*)profile\/card#me$/g,{storage:1}).exec(e);return(null===t||void 0===t?void 0:t.groups)?t.groups.storage:""})),Ke=function(e){return e.login.status},Qe=He.reducer,Ve=["buttonProps","menuProps"];var et=function(e,t){var n,r=function(n){var r=n.buttonProps,a=n.menuProps,i=Object(d.a)(n,Ve),s=Object(c.useState)(!1),o=Object(l.a)(s,2),b=o[0],f=o[1];return Object(h.jsxs)("div",Object(u.a)(Object(u.a)({},i),{},{style:{position:"relative",flexDirection:"column",display:"inline-flex",alignItems:"end",zIndex:3},onMouseLeave:function(){return f(!1)},onBlur:function(e){e.currentTarget.contains(e.relatedTarget)||f(!1)},children:[Object(h.jsx)(e,Object(u.a)(Object(u.a)({},r),{},{onMouseEnter:function(){return f(!0)},onFocus:function(){return f(!0)}})),Object(h.jsx)("div",{style:{position:"relative",width:0,height:0,visibility:b?"visible":"hidden"},children:Object(h.jsx)("div",{className:"box p-0",style:{position:"absolute",right:0,overflow:"hidden"},children:Object(h.jsx)(t,Object(u.a)(Object(u.a)({},a),{},{onClickClose:function(){return f(!1)}}))})})]}))};return r.displayName="WithMenu(".concat((n=e).displayName||n.name||"Component",")"),r},tt=et((function(e){var t=Object.assign({},e);return Object(h.jsx)(O,Object(u.a)(Object(u.a)({},t),{},{children:Object(h.jsx)("i",{className:"icon icon-user"})}))}),(function(e){var t=e.user,n=e.onLogout;return Object(h.jsx)("div",{className:"menu box p-0",children:Object(h.jsxs)("ul",{className:"menu-list",children:[Object(h.jsx)("li",{children:Object(h.jsx)("a",{className:"disabled",children:t.webId})}),Object(h.jsx)("li",{children:Object(h.jsx)("a",{onClick:n,children:"Logout"})})]})})})),nt=function(e){var t=Object.assign({},e),n=N(),r=C(Ye);return"loading"===C(Ke)?Object(h.jsx)(O,Object(u.a)(Object(u.a)({},t),{},{disabled:!0,children:Object(h.jsx)("i",{className:"icon icon-spinner animate-pulse"})})):r.isLoggedIn?Object(h.jsx)(tt,{menuProps:{user:r,onLogout:function(){return n(Ge())}},buttonProps:t}):Object(h.jsx)(w,Object(u.a)(Object(u.a)({},t),{},{contentProps:{onLogin:function(e){n($e(e))}},buttonProps:{}}))},rt=n(28),ct=n.n(rt),at=function(e,t){var n=ct.a.dot(e,ct.a.transpose([[].concat(Object(z.a)(t),[1])])),r=Object(l.a)(n,2);return[Object(l.a)(r[0],1)[0],Object(l.a)(r[1],1)[0]]},it=function(e){var t,n=null!==(t=Object.entries(e.dependents).length)&&void 0!==t?t:0;return n=n<1?1:n,5*Math.pow(n,.42)},st={origin:[0,0],distance:20,highlight:5},ot=n(22),ut=n(164),lt=n(514),dt=n(515),bt=n(516),ft=n(517),jt=n(518),ht=n(519);var pt=function e(){var t=this;Object(ot.a)(this,e),this.nodes=[],this.links=[],this.runs=!1,this.simulation=Object(ut.a)().alphaDecay(.005).force("link",Object(lt.a)().id((function(e){return e.uri})).distance(50).strength(.1)).force("linkGravity",function(){var e=[],t=3;function n(n){var r=t*n;e.forEach((function(e){var t=e.source,n=e.target;if("object"===typeof t&&"object"===typeof n&&t.y&&n.y&&t.vy&&n.vy&&t.y<n.y+50){var c=(n.y+50-t.y)/50;t.vy+=r*c,n.vy-=r*c}}))}return n.links=function(t){return e=t,n},n.strength=function(e){return t=e,n},n}().strength(50)).force("charge",Object(dt.a)().strength(-150).distanceMax(500)).force("gravityX",Object(bt.a)(0).strength(.01)).force("gravityY",Object(ft.a)(0).strength(.01)).force("collide",Object(jt.a)((function(e){return e.r+5}))).force("center",Object(ht.a)(0,0)).stop(),this.start=function(e){var n=e.nodes,r=e.links,c=e.onTick;t.nodes=n,t.links=r.map((function(e){return Object(u.a)({},e)})),t.simulation.nodes(t.nodes),t.simulation.force("link").links(t.links),t.simulation.force("linkGravity").links(t.links),t.simulation.on("tick",(function(){c({nodes:t.nodes,links:t.links})})),t.simulation.restart(),t.runs=!0},this.stop=function(){return t.runs=!1,t.simulation.stop()},this.update=function(e){var n=e.nodes,r=e.links;t.simulation.stop();var c=Object.fromEntries(t.nodes.map((function(e){return[e.uri,e]}))),a=n.map((function(e){return Object(u.a)(Object(u.a)(Object(u.a)({},e),{},{x:800*(.5-Math.random()),y:800*(.5-Math.random())},c[e.uri]),{},{r:e.r})}));t.nodes=a,t.links=r.map((function(e){return Object(u.a)({},e)})),t.simulation.nodes(t.nodes),t.simulation.force("link").links(t.links),t.simulation.force("linkGravity").links(t.links),t.simulation.alpha(1).restart()},this.selectNode=function(e){var n=e.x,r=e.y;return t.simulation.find(n,r,40)}},Ot=function(e){var t=Object(c.useState)(new pt),n=Object(l.a)(t,1)[0],r=Object(c.useState)({nodes:[],links:[]}),a=Object(l.a)(r,2),i=a[0],s=a[1];return Object(c.useEffect)((function(){var e=Date.now()-20;return n.start({nodes:[],links:[],onTick:function(t){var n=t.nodes,r=t.links,c=Date.now();c>e+20&&(s({nodes:Object(z.a)(n),links:Object(z.a)(r)}),e=c)}}),function(){n.stop()}}),[n]),Object(c.useEffect)((function(){var t=Object.values(e).map((function(e){return{label:e.label.en,x:400*Math.random(),y:400*Math.random(),r:it(e),uri:e.uri}})),r=Object.values(e).reduce((function(e,t){var n=t.uri,r=t.dependencies;return Object.keys(r).forEach((function(t){return e.push({source:n,target:t})})),e}),[]);n.update({nodes:t,links:r})}),[e,n]),{simulation:n,layout:i}},vt=function(e){var t=Object(c.useState)({width:0,height:0}),n=Object(l.a)(t,2),r=n[0],a=r.width,i=r.height,s=n[1],o=Object(c.useCallback)((function(){var t=function(e){if(e&&e.current){var t=e.current;return{height:t.clientHeight,width:t.clientWidth}}return{height:0,width:0}}(e);s(t)}),[e]);return Object(c.useEffect)((function(){return o(),window.addEventListener("load",o),window.addEventListener("resize",o),function(){window.removeEventListener("resize",o),window.removeEventListener("load",o)}}),[a,i,o]),{width:a,height:i}};var mt,gt,xt,yt=n(522),wt=n(250),kt=n(247),Nt=function(e,t,n,r){var c=Object(l.a)(t,2),a=c[0],i=c[1];e.font="20px Arial",e.textBaseline="middle",e.textAlign="left",Object.assign(e,r),e.fillText(n,a,i)},Ct=function(e,t,n,r){var c=Object(l.a)(t,2),a=c[0],i=c[1];Object.assign(e,r),e.beginPath(),e.arc(a,i,n,0,2*Math.PI),e.fill()},Et=function(e,t,n,r){Object.assign(e,r),e.beginPath(),e.moveTo.apply(e,Object(z.a)(t)),e.lineTo.apply(e,Object(z.a)(n)),e.stroke()},It=function(e){var t=e.graph,n=e.grid,r=e.onTransform,a=e.canvasRef,i=e.width,s=e.height,o=Object(c.useRef)();return Object(c.useEffect)((function(){if(a&&a.current){var e=a.current.getContext("2d");if(e){var r=[i/2,s/2];return e.save(),e.translate.apply(e,r),e.clearRect(-r[0],-r[1],i,s),function(e,t,n,r){for(var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0],a="#fff2",i=-c[1],s=r-c[1],o=-c[0],u=n-c[0],l=function(e){return 0===e?2:e%t.highlight===0?1:.5},d=0;d*t.distance+t.origin[0]<=u;){var b=d*t.distance+t.origin[0];b>=o&&Et(e,[b,i],[b,s],{strokeStyle:a,lineWidth:l(d)}),d++}for(d=-1;d*t.distance+t.origin[0]>=o;){var f=d*t.distance+t.origin[0];f<=u&&Et(e,[f,i],[f,s],{strokeStyle:a,lineWidth:l(d)}),d--}for(d=0;d*t.distance+t.origin[1]<=s;){var j=d*t.distance+t.origin[1];j>=i&&Et(e,[o,j],[u,j],{strokeStyle:a,lineWidth:l(d)}),d++}for(d=-1;d*t.distance+t.origin[1]>=i;){var h=d*t.distance+t.origin[1];h<=s&&Et(e,[o,h],[u,h],{strokeStyle:a,lineWidth:l(d)}),d--}}(e,n,i,s,r),function(e,t){t.links.forEach((function(t){var n=[t.source.x,t.source.y],r=[t.target.x,t.target.y],c=ct.a.sub(r,n),a=Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)),i=ct.a.div(c,a);Et(e,ct.a.add(n,ct.a.mul(i,t.source.r)),ct.a.sub(r,ct.a.mul(i,t.target.r)),{strokeStyle:"error"===t.style?"red":"white",lineWidth:.5})}));var n="violet",r="red",c="pink",a={node:"#fff8",label:"#fff4"},i=t.nodes.filter((function(e){return"accent"===e.style})),s=t.nodes.filter((function(e){return"focus"===e.style})),o=t.nodes.filter((function(e){return"focus2"===e.style})),u=t.nodes.filter((function(e){return!e.style}));u.forEach((function(t){var n=t.x,r=t.y,c=t.r;return Ct(e,[n,r],c,{fillStyle:a.node})})),u.forEach((function(t){var n=t.x,r=t.y,c=t.r,i=t.label;return Nt(e,[n+c+5,r],i,{fillStyle:a.label})})),o.forEach((function(t){var n=t.x,r=t.y,a=t.r;return Ct(e,[n,r],a,{fillStyle:c})})),o.forEach((function(t){var n=t.x,r=t.y,a=t.r,i=t.label;return Nt(e,[n+a+5,r],i,{fillStyle:c})})),s.forEach((function(t){var n=t.x,c=t.y,a=t.r;return Ct(e,[n,c],a,{fillStyle:r})})),s.forEach((function(t){var n=t.x,c=t.y,a=t.r,i=t.label;return Nt(e,[n+a+5,c],i,{fillStyle:r})})),i.forEach((function(t){var r=t.x,c=t.y,a=t.r;return Ct(e,[r,c],a,{fillStyle:n})})),i.forEach((function(t){var r=t.x,c=t.y,a=t.r,i=t.label;return Nt(e,[r+a+5,c],i,{fillStyle:n})}))}(e,t),function(){return e.restore()}}}}),[i,s,t,a,n]),Object(c.useEffect)((function(){a&&a.current&&(Object(wt.a)(a.current).call(Object(yt.a)().clickDistance(2).on("start drag end",(function(e){r([[1,0,e.dx],[0,1,e.dy],[0,0,1]])}))),Object(wt.a)(a.current).call(Object(kt.a)().clickDistance(2).scaleExtent([.05,3]).on("zoom",(function(e){var t;o.current=null!==(t=o.current)&&void 0!==t?t:[[1,0,-i/2],[0,1,-s/2],[0,0,1]];var n=e.transform,c=n.x,a=n.y,u=n.k,l=[[u,0,c-i/2],[0,u,a-s/2],[0,0,1]],d=ct.a.dot(l,ct.a.inv(o.current));o.current=l,r(d)}))))}),[a,r,s,i]),Object(c.useCallback)((function(e){return function(t){if(a&&a.current){var n=a.current.getBoundingClientRect(),r=t.clientX-n.left,c=t.clientY-n.top;e([r-i/2,c-s/2])}}}),[i,s,a])},St=["graph","grid","onTransform","onHover","onSelectNode"],Lt=function(e){var t=e.graph,n=e.grid,r=e.onTransform,a=e.onHover,i=e.onSelectNode,s=Object(d.a)(e,St),o=Object(c.useRef)(null),l=vt(o),b=l.width,f=l.height,p=It({graph:t,grid:n,onTransform:r,canvasRef:o,width:b,height:f}),O=p(a),v=p(i);return Object(h.jsx)("canvas",Object(u.a)(Object(u.a)({},s),{},{ref:o,onMouseMove:O,onMouseOut:function(){return a([1/0,1/0])},width:b,height:f,className:j()(s.className,"has-background-dark"),onClick:v}))},Dt=function(e){var t=C(ye),n=Object(l.a)(t,2),r=n[0],a=n[1],i=C(we),s=C(ke),o=C(Ce),d=N(),b=Ot(r),f=b.simulation,j=b.layout,p=Object(c.useState)([[1,0,0],[0,1,0],[0,0,1]]),O=Object(l.a)(p,2),v=O[0],m=O[1],g=Object(c.useCallback)((function(e){m((function(t){return ct.a.dot(e,t)}))}),[]),x=function(e){return function(t){var n,r=at(ct.a.inv(v),t),c=Object(l.a)(r,2),a=c[0],i=c[1];e(null===(n=f.selectNode({x:a,y:i}))||void 0===n?void 0:n.uri)}},y=x((function(e){return i!==e&&d(ve(e))})),w=x((function(e){return s!==e&&d(me(e))})),k=function(e,t,n,r,c,a){var i=Object.fromEntries(t.nodes.map((function(t){var n=at(e,[t.x,t.y]),r=Object(l.a)(n,2),c=r[0],a=r[1],i=e[0][0]*t.r;return[t.uri,Object(u.a)(Object(u.a)({},t),{},{x:c,y:a,r:i,style:""})]})));c.forEach((function(e){return i[e].style="focus2"})),n&&i[n]&&(i[n].style="accent"),r&&i[r]&&(i[r].style="focus");var s=a.map((function(e){return Q(e)})).flat(),o=t.links.map((function(e){var n="string"===typeof e.source?e.source:"number"===typeof e.source?t.nodes[e.source].uri:e.source.uri,r="string"===typeof e.target?e.target:"number"===typeof e.target?t.nodes[e.target].uri:e.target.uri,c=i[n],a=i[r],o=s.some((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1];return n===c.uri&&r===a.uri}))?"error":"";return{source:c,target:a,style:o}}));return{nodes:Object.values(i),links:o}}(v,j,i,s,o,a),E=function(e,t){for(var n=t.distance*e[0][0];n<20;)n*=5;return{origin:at(e,t.origin),distance:n,highlight:t.highlight}}(v,st);return Object(h.jsx)(Lt,Object(u.a)({graph:k,grid:E,onTransform:g,onHover:y,onSelectNode:w},e))},Mt=b.a.a(mt||(mt=Object(o.a)(["\n  color: lightgray;\n  &:hover {\n    color: white;\n  }\n"]))),Pt=b.a.footer(gt||(gt=Object(o.a)(["\n  color: gray;\n"]))),Tt=function(e){return Object(h.jsx)("div",Object(u.a)(Object(u.a)({},e),{},{children:Object(h.jsxs)(Pt,{children:["powered by ",Object(h.jsx)(Mt,{href:"https://solidproject.org",children:"Solid"})," \xb7"," ",Object(h.jsx)(Mt,{href:"https://github.com/livegraph-org/solid-math",children:"source"})]})}))},At=y((function(e){var t=Object.assign({},e);return Object(h.jsx)("a",Object(u.a)(Object(u.a)({},t),{},{children:"Add Document"}))}),(function(e){var t=e.onFinish,n=void 0===t?function(){}:t,r=C(Ze),a=N(),i=Object(c.useState)(!0),s=Object(l.a)(i,2),o=s[0],u=s[1],d=Object(c.useState)(""),b=Object(l.a)(d,2),f=b[0],j=b[1];return Object(h.jsx)("section",{children:Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a(Pe({uri:"".concat(r).concat(o?"public":"private","/math/").concat(f,".ttl"),isPublic:o})),n()},children:[Object(h.jsxs)("div",{className:"field buttons are-small has-addons",children:[Object(h.jsx)("input",{className:"button".concat(o?" is-success":""),type:"button",value:"Public",onClick:function(){return u(!0)}}),Object(h.jsx)("input",{className:"button".concat(o?"":" is-warning"),type:"button",value:"Private",onClick:function(){return u(!1)}})]}),Object(h.jsxs)("div",{className:"field",children:[r,o?"public":"private","/math/",Object(h.jsx)("input",{type:"text",value:f,placeholder:"set-theory",onChange:function(e){return j(e.target.value)}}),".ttl"]}),Object(h.jsxs)("div",{className:"field buttons",children:[Object(h.jsx)("input",{className:"button is-success",type:"submit",value:"Create"}),Object(h.jsx)("input",{className:"button is-danger",type:"reset",value:"Cancel",onClick:n})]})]})})}),"Add a document"),Ft=et((function(e){var t=Object.assign({},e);return Object(h.jsx)(O,Object(u.a)(Object(u.a)({},t),{},{children:Object(h.jsx)("i",{className:"icon icon-plus","aria-label":"add"})}))}),(function(e){var t=e.onAddMath,n=e.onClickClose;return Object(h.jsx)("div",{className:"menu box p-0",children:Object(h.jsxs)("ul",{className:"menu-list",children:[Object(h.jsx)("li",{children:Object(h.jsx)(At,{buttonProps:{onClick:n}})}),Object(h.jsx)("li",{children:Object(h.jsx)("a",{onClick:function(){n(),t()},children:"Add Math"})})]})})})),Rt=function(e){var t="";return e.read&&(t+="R"),e.write&&(t+="W"),e.append&&(t+="A"),t},qt=function(e){var t=Rt(e.user);return e.public&&(t+=" ",t+=Rt(e.public)),t||"none"},_t=function(){var e=C(Fe),t=C(qe),n=N();return Object(h.jsx)("ul",{children:e.map((function(e){var r=e.uri,c=e.access;return Object(h.jsx)("li",{children:Object(h.jsxs)("button",{className:j()("button is-small",r===t&&"is-success"),disabled:!(c.user.write||c.user.append),onClick:function(){return n(Ae(r))},children:[r," ",qt(c)]})},r)}))})},Wt=y((function(e){var t=Object.assign({},e);return Object(h.jsx)(O,Object(u.a)(Object(u.a)({},t),{},{children:Object(h.jsx)("i",{className:"icon icon-document","aria-label":"Math Documents"})}))}),_t,"Math Documents"),Ut=function(e){var t=Object.assign({},e),n=N(),r=C(Xe);return Object(h.jsxs)("div",Object(u.a)(Object(u.a)({},t),{},{children:[Object(h.jsx)(O,{"aria-label":"people",onClick:function(){return alert("people control not implemented")},children:Object(h.jsx)("i",{className:"icon icon-users"})}),Object(h.jsx)(Wt,{}),r&&Object(h.jsx)(Ft,{buttonProps:{},menuProps:{onAddMath:function(){return n(ge(!0))}}})]}))},zt=Object(D.c)({name:"search",initialState:{query:"",queryAutocomplete:""},reducers:{setSearch:function(e,t){e.query=t.payload},setAutocomplete:function(e,t){e.queryAutocomplete=t.payload}}}),Bt=zt.actions,$t=Bt.setSearch,Gt=Bt.setAutocomplete,Ht=function(e){return e.search.query},Yt=Object(M.a)(Ht,xe,(function(e,t){return e.length<2?[]:Object.values(t).filter((function(t){return t.label.en.toLowerCase().includes(e.toLowerCase())})).sort((function(e,t){var n=e.dependents,r=t.dependents;return Object.values(r).length-Object.values(n).length})).map((function(e){return{value:e.uri,label:e.label.en}})).slice(0,10)})),Jt=Object(M.a)((function(e){return e.search.queryAutocomplete}),xe,(function(e,t){return e.length<2?[]:Object.values(t).filter((function(t){return t.label.en.toLowerCase().includes(e.toLowerCase())})).sort((function(e,t){var n=e.dependents,r=t.dependents;return Object.values(r).length-Object.values(n).length})).slice(0,10)})),Xt=zt.reducer,Zt=function(e){var t=Object.assign({},e),n=C(Ht),r=C(Yt),a=N(),i=Object(c.useState)(!1),s=Object(l.a)(i,2),o=s[0],d=s[1],b=Object(c.useCallback)((function(){d(!1),a($t(""))}),[a]);return Object(c.useEffect)((function(){var e=function(e){"Escape"===e.key&&b()};return document.addEventListener("keydown",e,!1),function(){return document.removeEventListener("keydown",e,!1)}}),[b]),o?Object(h.jsxs)("div",Object(u.a)(Object(u.a)({},t),{},{className:"box p-0",children:[Object(h.jsxs)("p",{className:"control has-icons-right",children:[Object(h.jsx)("input",{autoFocus:!0,type:"text",className:"input",placeholder:"Search",value:n,onChange:function(e){return a($t(e.target.value))}}),Object(h.jsx)("span",{className:"icon is-right",children:Object(h.jsx)("i",{className:"icon icon-search"})})]}),Object(h.jsx)("div",{className:"menu",children:Object(h.jsx)("ul",{className:"menu-list",children:r.map((function(e){var t=e.value,n=e.label;return Object(h.jsx)("li",{title:t,onMouseEnter:function(){return a(ve(t))},onMouseLeave:function(){return a(ve(""))},children:Object(h.jsx)("a",{onClick:function(){a(me(t)),b()},children:n})},t)}))})})]})):Object(h.jsx)(O,{onClick:function(){return d(!0)},children:Object(h.jsx)("i",{className:"icon icon-search"})})},Kt=["info","onClose"],Qt=function(e){var t=e.info,n=e.onClose,r=Object(d.a)(e,Kt);if(!t.message)return null;var c="success"===t.type?"success":"error"===t.type?"danger":"info";return Object(h.jsx)("div",Object(u.a)(Object(u.a)({},r),{},{children:Object(h.jsxs)("div",{className:j()("notification","is-".concat(c)),children:[Object(h.jsx)("button",{className:"delete",onClick:n}),t.message]})}))},Vt=function(e){var t=Object.assign({},e),n=C(_),r=N();return Object(h.jsx)(Qt,Object(u.a)({info:n,onClose:function(){return r(q())}},t))},en=(n(485),n(246)),tn=n(249),nn=n(248),rn=b.a.div(xt||(xt=Object(o.a)(["\n  img {\n    max-width: 100%;\n  }\n"])));function cn(e){var t={children:e.children,remarkPlugins:[tn.a],rehypePlugins:[nn.a]};return Object(h.jsx)(rn,{children:Object(h.jsx)(en.a,Object(u.a)({},t))})}var an,sn,on,un,ln,dn,bn=function(e){var t=e.node;return Object(h.jsx)(cn,{children:t.description.en})},fn=function(e){var t=e.value,n=e.onChange;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("span",{className:"has-text-grey is-size-7",children:["You can use"," ",Object(h.jsx)("a",{href:"https://www.markdownguide.org/basic-syntax/",children:"Markdown"})," and"," ",Object(h.jsx)("a",{href:"http://asciimath.org/",children:"AsciiMath"})," (use $inline math$ and $$multiline math$$)."]}),Object(h.jsx)("textarea",{className:"textarea",placeholder:"description",value:t,onChange:function(e){return n(e.target.value)}}),Object(h.jsx)(cn,{children:t})]})},jn=function(e){var t=e.value,n=e.onChange;return Object(h.jsx)("input",{className:"input is-small",type:"text",placeholder:"label",value:t,onChange:function(e){return n(e.target.value)},size:10})},hn=function(e){var t=e.uri,n=e.label;return Object(h.jsx)("a",{href:t,children:n})},pn=n(245),On=n.n(pn),vn=(n(503),function(e){var t=e.title,n=e.nodes,r=N();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("header",{className:"card-header",children:Object(h.jsxs)("p",{className:"card-header-title",children:[t,": ",n.length]})}),Object(h.jsx)("section",{className:"card-content",children:Object(h.jsx)("ul",{className:"buttons are-small",children:n.map((function(e){return Object(h.jsx)("li",{onClick:function(){return r(me(e.uri))},onMouseEnter:function(){return r(ve(e.uri))},onMouseLeave:function(){return r(ve(""))},className:"button is-link is-inverted",children:e.label.en},e.uri)}))})})]})}),mn=function(e){var t=e.title,n=e.nodes,r=e.onAddNode,c=e.onRemoveNode,a=N(),i=Object.values(n).map((function(e){return{id:e.uri,name:e.label.en}})),s=C(Jt),o=s.map((function(e){var t=e.label;return{id:e.uri,name:t.en}}));return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("header",{className:"card-header",children:Object(h.jsxs)("p",{className:"card-header-title",children:[t,": ",n.length]})}),Object(h.jsx)("section",{className:"card-content",children:Object(h.jsx)(On.a,{suggestions:o,tags:i,onInput:function(e){return a(Gt(e))},onAddition:function(e){var t=s.find((function(t){return t.uri===e.id}));t&&r(t)},onDelete:function(e){c(n[e])},placeholderText:"Add a dependency",removeButtonText:"Remove the dependency",classNames:{root:"react-tags",rootFocused:"is-focused",selected:"react-tags__selected tags",selectedTag:"react-tags__selected-tag",selectedTagName:"react-tags__selected-tag-name",search:"react-tags__search",searchInput:"react-tags__search-input",suggestions:"react-tags__suggestions",suggestionActive:"is-active",suggestionDisabled:"is-disabled"},allowBackspace:!1,tagComponent:gn})})]})},gn=function(e){var t=e.tag,n=e.removeButtonText,r=e.onDelete;return Object(h.jsxs)("span",{className:"tag is-info",children:[t.name,Object(h.jsx)("button",{title:n,onClick:r,className:"delete is-small"})]})},xn=function(e){var t=e.value,n=e.onChange;return Object(h.jsx)("div",{className:"tags",children:t?Object(h.jsxs)("span",{className:"tag is-info",children:[t,Object(h.jsx)("button",{className:"delete is-small",onClick:function(){return n("")}})]}):["definition","statement"].map((function(e){return Object(h.jsx)("span",{className:"tag is-info is-light",onClick:function(){return n(e)},children:e},e)}))})},yn=function(e){var t=e.value;return Object(h.jsx)("span",{className:"tag is-info",children:t})},wn=function(e,t){var n=t.split("/"),r=e.split("/"),c=r.findIndex((function(e,t){return e!==n[t]}));return c<3?e:r.slice(c).join("/")},kn=function(e){var t=e.onFinish,n=N(),r=C(Ne),a=C(Ee),i=C(Re),s=C(qe),o=C(Je),u=Object(c.useState)(r?"":a.type),d=Object(l.a)(u,2),b=d[0],f=d[1],j=Object(c.useState)(r?"":a.label.en),p=Object(l.a)(j,2),O=p[0],v=p[1],m=Object(c.useState)(r?"":a.description.en),g=Object(l.a)(m,2),x=g[0],y=g[1],w=Object(c.useState)(r?[]:Object.values(a.dependencies)),k=Object(l.a)(w,2),E=k[0],I=k[1],S=b&&O&&x&&(s||a.document),L=Object(c.useCallback)((function(){f(r?"":a.type),v(r?"":a.label.en),y(r?"":a.description.en),I(r?[]:Object.values(a.dependencies))}),[a,r]),D=function(){if(!b)throw new Error("please select a type");if(!O)throw new Error("please specify a label");if(!x)throw new Error("please write a description");if(r&&!s)throw new Error("please select a document");n(r?je({type:b,label:{en:O},description:{en:x},dependencies:E.map((function(e){return e.uri})),document:s}):fe({type:b,label:{en:O},description:{en:x},dependencies:E.map((function(e){return e.uri})),id:a.uri,document:a.document.id})),M()};Object(c.useEffect)((function(){L()}),[a,L]);var M=function(){L(),t()};return Object(h.jsxs)("div",{className:"card",children:[Object(h.jsxs)("header",{className:"card-header",children:[Object(h.jsx)("div",{className:"card-header-title",children:Object(h.jsxs)("div",{className:"block is-flex-grow-1",children:[Object(h.jsx)("div",{className:"title is-6",children:r?"Create a new Math":Object(h.jsxs)(h.Fragment,{children:["Edit a ",a.type," ",Object(h.jsx)("i",{children:a.label.en})]})}),Object(h.jsx)("div",{className:"field",children:Object(h.jsx)(jn,{value:O,onChange:v})}),Object(h.jsx)("div",{className:"field",children:Object(h.jsx)(xn,{value:b,onChange:f})}),r&&Object(h.jsx)("div",{className:"field select",children:Object(h.jsxs)("select",{value:s,onChange:function(e){return n(Ae(e.target.value))},children:[Object(h.jsx)("option",{hidden:!0,disabled:!0,value:"",children:" -- select a document to save to -- "}),i.map((function(e){return Object(h.jsx)("option",{value:e.uri,children:wn(e.uri,o)},e.uri)}))]})})]})}),Object(h.jsx)("button",{className:"card-header-icon","aria-label":"cancel editing",title:"cancel editing",onClick:M,children:Object(h.jsx)("i",{className:"icon icon-cancel has-text-danger","aria-hidden":"true"})}),Object(h.jsx)("button",{className:"card-header-icon has-text-".concat(S?"success":"grey-light"),"aria-label":"save changes",title:"save changes",onClick:D,disabled:!S,children:Object(h.jsx)("i",{className:"icon icon-ok","aria-hidden":"true"})})]}),Object(h.jsx)("section",{className:"card-content",children:Object(h.jsx)(fn,{value:x,onChange:y})}),Object(h.jsx)(mn,{title:"dependencies",nodes:E,onAddNode:function(e){I((function(t){return[].concat(Object(z.a)(t),[e])}))},onRemoveNode:function(e){I((function(t){return t.filter((function(t){return t.uri!==e.uri}))}))}}),Object(h.jsxs)("footer",{className:"card-footer",children:[Object(h.jsxs)("button",{className:"card-header-icon card-footer-item","aria-label":"cancel editing",title:"cancel editing",onClick:M,children:[Object(h.jsx)("i",{className:"icon icon-cancel has-text-danger","aria-hidden":"true"})," ","Cancel"]}),Object(h.jsxs)("button",{className:"card-header-icon card-footer-item has-text-".concat(S?"success":"grey-light"),"aria-label":"save changes",title:"save changes",onClick:D,disabled:!S,children:[Object(h.jsx)("i",{className:"icon icon-ok","aria-hidden":"true"})," Save"]})]})]})},Nn=["uri","onFinish","onDelete"],Cn=y((function(e){var t=Object.assign({},e);return Object(h.jsx)("button",Object(u.a)(Object(u.a)({},t),{},{className:"button is-danger is-inverted",children:"Delete Node"}))}),(function(e){var t=e.uri,n=e.onFinish,r=void 0===n?function(){return null}:n,a=e.onDelete,i=Object(d.a)(e,Nn),s=new URL(t).hash||String(Date.now()),o=Object(c.useState)(""),b=Object(l.a)(o,2),f=b[0],j=b[1],p=s!==f;return Object(h.jsxs)("div",Object(u.a)(Object(u.a)({},i),{},{children:["If yes, please retype the text ",Object(h.jsx)("code",{children:s})," below.",Object(h.jsx)("div",{className:"field",children:Object(h.jsx)("input",{maxLength:s.length,className:"input",type:"text",value:f,onChange:function(e){return j(e.target.value)}})}),Object(h.jsxs)("div",{className:"buttons",children:[Object(h.jsx)("button",{className:"button is-danger",disabled:p,onClick:function(){r(),a()},children:"Delete"}),Object(h.jsx)("button",{className:"button is-info is-inverted",onClick:r,children:"Cancel"})]})]}))})),En=function(e){var t=e.onEdit,n=N(),r=C(Ee);"aa"===r.label.en&&console.log(r);var c=Object.values(r.dependencies),a=Object.values(r.dependents),i=r.document.access.user.write;return Object(h.jsxs)("div",{className:"card",children:[Object(h.jsxs)("header",{className:"card-header",children:[Object(h.jsx)("div",{className:"card-header-title",children:Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:Object(h.jsx)(hn,{uri:r.uri,label:r.label.en})}),Object(h.jsx)("div",{children:Object(h.jsx)(yn,{value:r.type})})]})}),i&&Object(h.jsx)("button",{className:"card-header-icon","aria-label":"edit label",onClick:t,children:Object(h.jsx)("i",{className:"icon icon-edit","aria-hidden":"true"})}),Object(h.jsx)("span",{className:"card-header-icon",children:Object(h.jsx)("button",{className:"delete","aria-label":"close",onClick:function(){return n(me(""))},children:"close"})})]}),Object(h.jsx)("section",{className:"card-content",children:Object(h.jsx)(bn,{node:r})}),Object(h.jsx)(vn,{title:"dependencies",nodes:c}),Object(h.jsx)(vn,{title:"dependents",nodes:a}),i&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("header",{className:"card-header",children:Object(h.jsx)("p",{className:"card-header-title has-text-danger",children:"Danger Zone"})}),Object(h.jsx)("section",{className:"card-content has-background-danger",children:Object(h.jsx)(Cn,{title:"Do you really want to delete ".concat(r.type," ").concat(r.label.en,"?"),contentProps:{uri:r.uri,onDelete:function(){return n(he(r))}}})})]})]})},In=function(){var e=Object(c.useState)(!1),t=Object(l.a)(e,2),n=t[0],r=t[1],a=C(ke),i=C(Ne),s=N();return Object(c.useEffect)((function(){r(!1)}),[a]),i?Object(h.jsx)(kn,{onFinish:function(){return s(ge(!1))}}):a?n?Object(h.jsx)(kn,{onFinish:function(){return r(!1)}}):Object(h.jsx)(En,{onEdit:function(){return r(!0)}}):null},Sn=b.a.div(an||(an=Object(o.a)(["\n  position: fixed;\n  width: 100%;\n  top: 0;\n  bottom: 0;\n  pointer-events: none;\n  overflow-x: hidden;\n  overflow-y: auto;\n"]))),Ln=b.a.div(sn||(sn=Object(o.a)(["\n  pointer-events: all;\n  overflow-x: auto;\n  width: 100%;\n"]))),Dn=function(e){var t=e.children;return Object(h.jsx)(Sn,{children:Object(h.jsx)("div",{className:"columns mr-1 mt-6",children:Object(h.jsx)("div",{className:"column is-one-quarter is-offset-three-quarters",children:Object(h.jsx)(Ln,{children:t})})})})},Mn=Object(b.a)(Tt)(on||(on=Object(o.a)(["\n  position: fixed;\n  bottom: 1rem;\n  right: 1rem;\n"]))),Pn=Object(b.a)(Vt)(un||(un=Object(o.a)(["\n  position: fixed;\n  bottom: 0.5rem;\n  left: 0.5rem;\n"]))),Tn=Object(b.a)(Dt)(ln||(ln=Object(o.a)(["\n  height: 100vh;\n  width: 100vw;\n  display: block;\n"]))),An=b.a.nav(dn||(dn=Object(o.a)(["\n  display: flex;\n  position: absolute;\n  width: 100%;\n  pointer-events: none;\n  justify-content: space-between;\n  & > * {\n    pointer-events: all;\n  }\n  padding: 1rem;\n"]))),Fn=function(){return Object(h.jsx)(Dn,{children:Object(h.jsx)(In,{})})},Rn=function(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(An,{children:[Object(h.jsx)(Ut,{}),Object(h.jsxs)("div",{style:{display:"flex"},children:[Object(h.jsx)(Zt,{style:{display:"inline-block",position:"relative",zIndex:2}}),Object(h.jsx)(nt,{})]})]}),Object(h.jsx)(Mn,{}),Object(h.jsx)(Pn,{}),Object(h.jsx)(Fn,{}),Object(h.jsx)(Tn,{})]})},qn=function(){var e=N();return Object(c.useEffect)((function(){e(Be())}),[e]),Object(h.jsx)(Rn,{})},_n=Object(D.a)({reducer:{login:Qe,math:Ie,search:Xt,document:_e,info:W}}),Wn=function(e){e&&e instanceof Function&&n.e(5).then(n.bind(null,548)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))};if("object"===typeof document){var Un=document.querySelector("#root");m.a.setAppElement(Un)}s.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(k.a,{store:_n,children:Object(h.jsx)(qn,{})})}),document.getElementById("root")),Wn()}},[[504,1,2]]]);
//# sourceMappingURL=main.c7ee6ae3.chunk.js.map