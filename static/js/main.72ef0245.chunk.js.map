{"version":3,"sources":["features/login/LoginPrompt.tsx","app/hooks.ts","features/math/algorithms.ts","features/math/visualization/Visualization.tsx","features/math/mathAPI.ts","features/math/mathSlice.ts","features/login/loginAPI.ts","features/login/loginSlice.ts","features/login/Login.tsx","features/math/visualization/helpers/draw.ts","features/math/visualization/simulation/index.ts","features/math/visualization/simulation/gravity.ts","features/math/Math.tsx","features/math/Statement.tsx","features/math/Search.tsx","features/math/InfoContainer.tsx","features/math/visualization/helpers/transform.ts","features/math/visualization/VisualizationContainer.tsx","components/About.tsx","components/Layout.tsx","App.tsx","app/store.ts","reportWebVitals.ts","index.tsx"],"names":["LoginPrompt","onLogin","props","useState","promptOpen","setPromptOpen","localStorage","getItem","idp","setIdp","isOpen","onRequestClose","contentLabel","overlayClassName","base","afterOpen","beforeClose","className","closeTimeoutMS","onClick","onSubmit","e","preventDefault","setItem","id","type","value","onChange","newValue","currentTarget","placeholder","useAppDispatch","useDispatch","useAppSelector","useSelector","old","prune","input","graph","graphlib","Graph","Object","values","forEach","node","setNode","uri","dependencies","dependency","setEdge","output","fromEntries","entries","map","alg","isAcyclic","Error","edges","edge","removeEdge","dijkstra","v","w","distance","Infinity","pruneCore","source","target","fetchGraph","a","getSolidDataset","fetch","dataset","things","getThingAll","nodes","links","thing","asUrl","getTerm","rdf","description","label","rdfs","push","en","dependents","examples","created","updated","proofs","getTermAll","findMathDocumentsOfPerson","webId","me","getThing","publicTypeIndex","solid","index","mathDocuments","filter","forClass","includes","instance","flat","addDocuments","createAsyncThunk","dispatch","api","documents","doc","addGraph","mathSlice","createSlice","name","initialState","entities","byId","allIds","document","ui","highlighted","selected","search","query","reducers","highlight","state","action","payload","select","setSearch","extraReducers","builder","addCase","fulfilled","dependent","actions","selectGraph","createSelector","math","enrichedNodes","enrichedNode","selectPrunedGraph","selectSearch","selectHighlighted","selectSelected","selectSelectedNodeDependencies","selectSearchResults","length","toLowerCase","sort","b","slice","selectSelectedNode","init","handleIncomingRedirect","url","window","location","href","restorePreviousSession","sessionInfo","login","oidcIssuer","solidLogin","redirectUrl","clientName","alert","removeItem","logout","solidLogout","isLoggedIn","status","_","response","loginSlice","pending","selectSession","selectLoginStatus","Login","info","commonProps","disabled","drawText","context","text","options","x","y","font","textBaseline","textAlign","assign","fillText","drawCircle","radius","beginPath","arc","Math","PI","fill","drawLine","start","end","moveTo","lineTo","stroke","Visualization","grid","onTransform","onHover","onSelectNode","canvasEl","useRef","width","height","setVisualizationSize","useEffect","current","getContext","offset","save","translate","clearRect","strokeStyle","min1","max1","min0","max0","getLineWidth","i","origin","lineWidth","drawGrid","link","s","t","numeric","sub","size","sqrt","div","add","mul","r","color","accented","style","focused","focused2","rest","fillStyle","drawGraph","restore","updateCanvasSize","elementRef","clientHeight","clientWidth","getElementSize","addEventListener","removeEventListener","call","drag","clickDistance","on","dx","dy","zoom","scaleExtent","transform","k","dot","inv","withCanvasPosition","func","rect","getBoundingClientRect","clientX","left","clientY","top","handleMouseMove","handleClick","ref","onMouseMove","onMouseOut","classnames","Simulation","runs","simulation","forceSimulation","alphaDecay","force","forceLink","strength","alpha","d","vy","optimumDifference","forceGravity","forceManyBody","distanceMax","forceX","forceY","forceCollide","forceCenter","stop","onTick","restart","update","thisNodeDict","updatedNodes","random","selectNode","find","Styler","styled","children","remarkPlugins","remarkMath","rehypePlugins","rehypeKatex","NodeList","title","onMouseEnter","onMouseLeave","Statement","Search","ICOutside","ICInside","InfoContainer","matrix","vector","raw","transpose","nodeRadius","count","basicGrid","VisualizationContainer","prunedGraph","highlightedNode","selectedNode","selectedNodeDependencies","layout","setLayout","setMatrix","lastUpdate","Date","now","reduce","keys","withNode","position","handleHover","handleSelect","transformedLayout","selectedDependencies","transformedNodesDict","sourceUri","targetUri","transformLayout","transformGrid","prevMatrix","Link","Footer","footer","About","PositionedLogin","PositionedAbout","FullSizeVisualization","Layout","App","initLogin","store","configureStore","reducer","loginReducer","mathReducer","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","appElement","querySelector","Modal","setAppElement","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.72ef0245.chunk.js","sourcesContent":["import React, { useState } from 'react'\nimport Modal from 'react-modal'\n\ninterface Props {\n  onLogin: (oidcIssuer: string) => void\n}\n\nconst LoginPrompt: React.FC<Props> = ({ onLogin, ...props }: Props) => {\n  const [promptOpen, setPromptOpen] = useState(false)\n  const [idp, setIdp] = useState(\n    localStorage.getItem('idp') ?? 'https://solidcommunity.net',\n  )\n\n  const onSubmit: React.FormEventHandler = e => {\n    e.preventDefault()\n    localStorage.setItem('idp', idp)\n    onLogin(idp)\n  }\n\n  const onChangeInput = (e: React.FormEvent<HTMLInputElement>) => {\n    e.preventDefault()\n    const newValue = e.currentTarget.value\n    setIdp(newValue)\n  }\n\n  if (!promptOpen) {\n    return (\n      <>\n        <button\n          {...props}\n          onClick={e => {\n            e.preventDefault()\n            setPromptOpen(true)\n          }}\n        >\n          Login\n        </button>\n      </>\n    )\n  }\n\n  return (\n    <>\n      <Modal\n        isOpen={promptOpen}\n        onRequestClose={() => setPromptOpen(false)}\n        contentLabel=\"Connect your Solid Pod\"\n        overlayClassName={{\n          base: 'modal modal-background is-active',\n          afterOpen: '',\n          beforeClose: '',\n        }}\n        className={{\n          base: 'modal-content',\n          afterOpen: '',\n          beforeClose: '',\n        }}\n        closeTimeoutMS={50}\n      >\n        <button className=\"modal-close\" onClick={() => setPromptOpen(false)}>\n          close\n        </button>\n\n        <div className=\"card\">\n          <header className=\"card-header\">\n            <p className=\"card-header-title\">\n              Select your Solid identity provider\n            </p>\n          </header>\n          <div className=\"card-content\">\n            <form onSubmit={onSubmit}>\n              <div className=\"field\">\n                <div className=\"control\">\n                  <input\n                    id=\"idp\"\n                    className=\"input\"\n                    type=\"url\"\n                    value={idp}\n                    onChange={onChangeInput}\n                    placeholder=\"Where is your Solid Pod?\"\n                  />\n                </div>\n              </div>\n              <div className=\"field\">\n                <div className=\"control\">\n                  <input\n                    type=\"submit\"\n                    value=\"Connect\"\n                    className=\"button is-link\"\n                  />\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </Modal>\n    </>\n  )\n}\n\nexport default LoginPrompt\n","import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux'\nimport type { RootState, AppDispatch } from './store'\n\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\nexport const useAppDispatch = () => useDispatch<AppDispatch>()\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector\n","import graphlib, { Graph } from 'graphlib'\n// import { Dependency } from './simulation/types'\n// import findCyclesAdjacency from 'elementary-circuits-directed-graph'\nimport { Graph as AbstractGraph } from './mathSlice'\n\nfunction pruneCore(graph: Graph) {\n  if (!graphlib.alg.isAcyclic(graph)) {\n    // const cycles = graphlib.alg.findCycles(graph);\n    throw new Error('pruning is possible on DAG only')\n  }\n  const edges = graph.edges()\n  edges.forEach(edge => {\n    // remove edge\n    graph.removeEdge(edge)\n    // see if another path exists\n    const paths = graphlib.alg.dijkstra(graph, edge.v)\n    // if the other path doesn't exist, add the node back\n    if (paths[edge.w].distance === Infinity) {\n      graph.setEdge(edge)\n    }\n  })\n  return graph\n}\n\nexport const prune = (input: AbstractGraph): AbstractGraph => {\n  const graph = new graphlib.Graph()\n\n  Object.values(input).forEach(node => {\n    graph.setNode(node.uri)\n\n    Object.values(node.dependencies).forEach(dependency =>\n      graph.setEdge(node.uri, dependency.uri),\n    )\n  })\n\n  const output: AbstractGraph = Object.fromEntries(\n    Object.entries(input).map(([uri, node]) => [\n      uri,\n      { ...node, dependencies: {} },\n    ]),\n  )\n\n  const prunedEdges = pruneCore(graph)\n    .edges()\n    .map(({ v: source, w: target }) => ({ source, target }))\n\n  prunedEdges.forEach(({ source, target }) => {\n    output[source].dependencies[target] = output[target]\n  })\n\n  return output\n}\n\n/*\nexport function getCycles(dependencies: Dependency[]): Dependency[][] {\n  const nodes = Array.from(\n    new Set([\n      ...dependencies.map(d => d.dependent),\n      ...dependencies.map(d => d.dependency),\n    ]),\n  )\n  const nodeIndexes = Object.fromEntries(\n    Object.entries(nodes).map(([key, value]) => [value, +key]),\n  )\n\n  const adjacency = Array(nodes.length)\n    .fill(null)\n    .map(() => [] as number[])\n  dependencies.forEach(({ dependent, dependency }) => {\n    const dependentIndex = nodeIndexes[dependent]\n    const dependencyIndex = nodeIndexes[dependency]\n    adjacency[dependentIndex].push(dependencyIndex)\n  })\n\n  // try to detect loops (cycles of length 1)\n  // this is due to the limits of the findCyclesAdjacency, which fails to detect loops\n  // https://github.com/antoinerg/elementary-circuits-directed-graph/issues/13\n  // @TODO remove loop detection when the issue is fixed\n  const loops = adjacency.reduce((loops, adj, i) => {\n    if (adj.includes(i)) loops.push([i, i])\n    return loops\n  }, [] as number[][])\n\n  const rawCycles = loops.length > 0 ? loops : findCyclesAdjacency(adjacency)\n\n  const simpleCycles = rawCycles.map(cycle =>\n    cycle.slice(0, -1).map(i => nodes[i]),\n  )\n\n  return simpleCycles\n    .map(cycle => simpleCycleToCycle(cycle, dependencies))\n    .sort((a, b) => a.length - b.length)\n    .slice(0, 5)\n}\n\nfunction simpleCycleToCycle(\n  simpleCycle: string[],\n  dependencies: Dependency[],\n): Dependency[] {\n  return simpleCycle.map((uri, index) => {\n    const dependent = simpleCycle[index]\n    const dependency = simpleCycle[(index + 1) % simpleCycle.length]\n    return (\n      dependencies.find(\n        d => d.dependency === dependency && d.dependent === dependent,\n      ) || {\n        dependent,\n        dependency,\n        doc: '',\n      }\n    )\n  })\n  }\n  */\n","import React, { useRef, useEffect, useState } from 'react'\nimport { drawGrid, drawGraph } from './helpers/draw'\nimport classnames from 'classnames'\nimport { drag } from 'd3-drag'\nimport { zoom } from 'd3-zoom'\nimport { select } from 'd3-selection'\nimport numeric from 'numeric'\nimport { VisualizationGraph, Vector, Grid, Matrix } from './types'\n\ntype Props = Partial<React.CanvasHTMLAttributes<HTMLCanvasElement>> & {\n  graph: VisualizationGraph\n  grid: Grid\n  onTransform: (matrix: Matrix) => void\n  onHover: (position: Vector) => void\n  onSelectNode: (position: Vector) => void\n}\n\nlet old: Matrix\n\nconst Visualization: React.FC<Props> = ({\n  graph,\n  grid,\n  onTransform,\n  onHover,\n  onSelectNode,\n  ...props\n}: Props) => {\n  const canvasEl = useRef<HTMLCanvasElement>(null)\n  const [{ width, height }, setVisualizationSize] = useState({\n    width: 0,\n    height: 0,\n  })\n\n  useEffect(() => {\n    if (canvasEl && canvasEl.current) {\n      const context = canvasEl.current.getContext('2d')\n      if (context) {\n        const offset: Vector = [width / 2, height / 2]\n        context.save()\n        context.translate(...offset)\n        context.clearRect(-offset[0], -offset[1], width, height)\n        drawGrid(context, grid, width, height, offset)\n        drawGraph(context, graph)\n        return () => context.restore()\n      }\n    }\n  }, [width, height, graph, canvasEl, grid])\n\n  useEffect(() => {\n    const updateCanvasSize = () => {\n      if (canvasEl && canvasEl.current) {\n        const size = getElementSize(canvasEl)\n        setVisualizationSize(size)\n      }\n    }\n\n    updateCanvasSize()\n    window.addEventListener('load', updateCanvasSize)\n    window.addEventListener('resize', updateCanvasSize)\n\n    return () => {\n      window.removeEventListener('resize', updateCanvasSize)\n      window.removeEventListener('load', updateCanvasSize)\n    }\n  }, [width, height, canvasEl])\n\n  useEffect(() => {\n    if (canvasEl && canvasEl.current) {\n      select(canvasEl.current).call(\n        drag<HTMLCanvasElement, unknown>()\n          .clickDistance(2)\n          //.on('start', console.log)\n          .on('drag', e => {\n            onTransform([\n              [1, 0, e.dx],\n              [0, 1, e.dy],\n              [0, 0, 1],\n            ])\n          }),\n        //.on('end', console.log),\n      )\n\n      select(canvasEl.current).call(\n        zoom<HTMLCanvasElement, unknown>()\n          .clickDistance(2)\n          .scaleExtent([0.05, 3])\n          .on('zoom', e => {\n            old = old ?? [\n              [1, 0, -width / 2],\n              [0, 1, -height / 2],\n              [0, 0, 1],\n            ]\n            const { x, y, k } = e.transform\n\n            const zoom = [\n              [k, 0, x - width / 2],\n              [0, k, y - height / 2],\n              [0, 0, 1],\n            ]\n\n            const transform = numeric.dot(zoom, numeric.inv(old)) as Matrix\n            old = zoom\n\n            onTransform(transform)\n          }),\n      )\n    }\n  }, [canvasEl, onTransform, height, width])\n\n  const withCanvasPosition =\n    (\n      func: (position: Vector) => void,\n    ): React.MouseEventHandler<HTMLCanvasElement> =>\n    e => {\n      // https://stackoverflow.com/a/42111623\n      if (canvasEl && canvasEl.current) {\n        const rect = canvasEl.current.getBoundingClientRect()\n        const x = e.clientX - rect.left //x position within the element.\n        const y = e.clientY - rect.top //y position within the element.\n        func([x - width / 2, y - height / 2])\n      }\n    }\n\n  const handleMouseMove = withCanvasPosition(onHover)\n  const handleClick = withCanvasPosition(onSelectNode)\n\n  return (\n    <canvas\n      {...props}\n      ref={canvasEl}\n      onMouseMove={handleMouseMove}\n      // @TODO this piece is very inefficient, we search for a nonexistent node, just to unhighlight everything; but it works\n      onMouseOut={() => onHover([Infinity, Infinity])}\n      width={width}\n      height={height}\n      className={classnames(props.className, 'has-background-dark')}\n      onClick={handleClick}\n    />\n  )\n}\n\nexport default Visualization\n\nfunction getElementSize(elementRef: React.RefObject<HTMLCanvasElement>) {\n  if (elementRef && elementRef.current) {\n    const { clientHeight: height, clientWidth: width } = elementRef.current\n    return { height, width }\n  } else return { height: 0, width: 0 }\n}\n","import {\n  getSolidDataset,\n  UrlString,\n  getThingAll,\n  getTermAll,\n  getTerm,\n  getThing,\n  asUrl,\n} from '@inrupt/solid-client'\nimport { fetch } from '@inrupt/solid-client-authn-browser'\nimport { rdf, rdfs, solid } from 'rdf-namespaces'\nimport { Definition, Statement } from './mathSlice'\n\ninterface Graph {\n  nodes: (Definition | Statement)[]\n  links: [string, string][]\n}\n\nexport const fetchGraph = async (uri: UrlString): Promise<Graph> => {\n  const dataset = await getSolidDataset(uri, { fetch })\n  const things = getThingAll(dataset)\n  const graph: Graph = { nodes: [], links: [] }\n  things.forEach(thing => {\n    const uri = asUrl(thing)\n    const type = getTerm(thing, rdf.type)?.value ?? ''\n    const description = getTerm(thing, rdf.value)?.value ?? ''\n    const label = getTerm(thing, rdfs.label)?.value ?? ''\n    switch (type) {\n      case 'https://terms.math.livegraph.org#Definition':\n        graph.nodes.push({\n          id: uri,\n          type: 'definition',\n          label: { en: label },\n          description: { en: description },\n          dependencies: [],\n          dependents: [],\n          examples: [],\n          created: 0,\n          updated: 0,\n        })\n        break\n      case 'https://terms.math.livegraph.org#Statement':\n        graph.nodes.push({\n          id: uri,\n          type: 'statement',\n          label: { en: label },\n          description: { en: description },\n          dependencies: [],\n          dependents: [],\n          examples: [],\n          proofs: [],\n          created: 0,\n          updated: 0,\n        })\n        break\n      default:\n        break\n    }\n    getTermAll(thing, 'https://terms.math.livegraph.org#dependsOn').forEach(\n      dependency => {\n        graph.links.push([uri, dependency.value])\n      },\n    )\n  })\n  return graph\n}\n\nexport const findMathDocumentsOfPerson = async (\n  webId: string,\n): Promise<string[]> => {\n  if (webId) {\n    const dataset = await getSolidDataset(webId, { fetch })\n    const me = getThing(dataset, webId)\n    if (me) {\n      const publicTypeIndex = getTerm(me, solid.publicTypeIndex)?.value\n      if (publicTypeIndex) {\n        const index = await getSolidDataset(publicTypeIndex, { fetch })\n        const things = getThingAll(index)\n        const mathDocuments = things\n          .filter(thing =>\n            getTermAll(thing, solid.forClass)\n              .map(a => a.value)\n              .includes('https://terms.math.livegraph.org#Definition'),\n          )\n          .map(thing => getTermAll(thing, solid.instance))\n          .flat()\n          .map(a => a.value)\n        return mathDocuments\n      }\n    }\n  }\n  return ['https://mrkvon.solidcommunity.net/public/math/graph-theory.ttl']\n}\n","import {\n  createSlice,\n  createAsyncThunk,\n  createSelector,\n  PayloadAction,\n} from '@reduxjs/toolkit'\nimport { prune } from './algorithms'\nimport { RootState } from '../../app/store'\nimport * as api from './mathAPI'\nimport { Dictionary } from '../../app/types'\n\ninterface LanguageString extends Dictionary<string> {\n  en: string // a default language, we always expect it to be there\n  // eventually we'll generalize this\n}\n\ninterface Node {\n  id: string\n  description: LanguageString\n  label: LanguageString\n  type: string\n  created: number\n  updated: number\n  // there'll also be citation here\n  // examples and proofs will probably extend this\n  // and we need to figure out where to keep solid documents\n}\n\ninterface DefinitionOrStatement extends Node {\n  dependencies: string[]\n  dependents: string[]\n  examples: string[] // to be implemented\n}\n\nexport interface Definition extends DefinitionOrStatement {\n  type: 'definition'\n}\n\nexport interface Statement extends DefinitionOrStatement {\n  type: 'statement'\n  proofs: string[] // to be implemented\n}\n\nexport interface MathDocument {\n  id: string\n}\n\ninterface Entity<EntityType> {\n  byId: Dictionary<EntityType>\n  allIds: string[]\n}\n\nexport interface MathState {\n  entities: {\n    node: Entity<Definition | Statement>\n    document: Entity<MathDocument>\n    // we'll add examples and proofs and citations here\n  }\n  ui: {\n    highlighted: string\n    selected: string\n  }\n  search: {\n    query: string\n  }\n}\n\nconst initialState: MathState = {\n  entities: {\n    node: {\n      byId: {},\n      allIds: [],\n    },\n    document: {\n      byId: {},\n      allIds: [],\n    },\n  },\n  ui: {\n    highlighted: '',\n    selected: '',\n  },\n  search: {\n    query: '',\n  },\n}\n\n// Thunks\nexport const addDocuments = createAsyncThunk(\n  'math/addDocuments',\n  async (webId: string, { dispatch }) => {\n    const documents = await api.findMathDocumentsOfPerson(webId)\n    documents.forEach(doc => dispatch(addGraph(doc)))\n    return documents\n  },\n)\n\nexport const addGraph = createAsyncThunk(\n  'math/addGraph',\n  async (uri: string) => {\n    return await api.fetchGraph(uri)\n  },\n)\n\nexport const mathSlice = createSlice({\n  name: 'math',\n  initialState,\n  reducers: {\n    highlight: (state, action: PayloadAction<string>) => {\n      state.ui.highlighted = action.payload\n    },\n    select: (state, action: PayloadAction<string>) => {\n      state.ui.selected = action.payload\n    },\n    setSearch: (state, action: PayloadAction<string>) => {\n      state.search.query = action.payload\n    },\n  },\n  extraReducers: builder => {\n    builder\n      .addCase(addDocuments.fulfilled, (state, action) => {\n        state.entities.document = {\n          byId: Object.fromEntries(action.payload.map(id => [id, { id }])),\n          allIds: action.payload,\n        }\n      })\n      .addCase(addGraph.fulfilled, (state, action) => {\n        const { nodes, links } = action.payload\n        nodes.forEach(node => {\n          state.entities.node.byId[node.id] = node\n          state.entities.node.allIds.push(node.id)\n        })\n        links.forEach(([dependent, dependency]) => {\n          state.entities.node.byId[dependent].dependencies.push(dependency)\n          state.entities.node.byId[dependency].dependents.push(dependent)\n        })\n      })\n  },\n})\n\nexport const { highlight, select, setSearch } = mathSlice.actions\n\n// Selectors\nconst selectGraphNodes = (state: RootState) => state.math.entities.node\n\ninterface EnrichedDefinition\n  extends Omit<Definition, 'dependents' | 'dependencies' | 'id'> {\n  uri: string\n  dependents: Dictionary<EnrichedDefinition | EnrichedStatement>\n  dependencies: Dictionary<EnrichedDefinition | EnrichedStatement>\n}\n\ninterface EnrichedStatement\n  extends Omit<Statement, 'dependents' | 'dependencies' | 'id'> {\n  uri: string\n  dependents: Dictionary<EnrichedDefinition | EnrichedStatement>\n  dependencies: Dictionary<EnrichedDefinition | EnrichedStatement>\n}\n\nexport type GraphNode = EnrichedDefinition | EnrichedStatement\n\nexport type Graph = Dictionary<GraphNode>\n\nexport const selectGraph = createSelector(selectGraphNodes, ({ byId }) => {\n  const enrichedNodes: Graph = Object.fromEntries(\n    Object.entries(byId).map(([id, { id: uri, ...node }]) => [\n      id,\n      {\n        ...node,\n        uri,\n        dependencies: {},\n        dependents: {},\n      },\n    ]),\n  )\n\n  Object.entries(enrichedNodes).forEach(([id, enrichedNode]) => {\n    enrichedNode.dependencies = Object.fromEntries(\n      byId[id].dependencies.map(id => [id, enrichedNodes[id]]),\n    )\n    enrichedNode.dependents = Object.fromEntries(\n      byId[id].dependents.map(id => [id, enrichedNodes[id]]),\n    )\n  })\n\n  return enrichedNodes\n})\n\nexport const selectPrunedGraph = createSelector(selectGraph, graph =>\n  prune(graph),\n)\n\nexport const selectSearch = (state: RootState) => state.math.search.query\n\nexport const selectHighlighted = (state: RootState) => state.math.ui.highlighted\nexport const selectSelected = (state: RootState) => state.math.ui.selected\n\nconst selectNodeDependencies = (uri: string, graph: Graph): string[] =>\n  uri ? Object.values(graph[uri]?.dependencies ?? {}).map(node => node.uri) : []\n\nexport const selectSelectedNodeDependencies = createSelector(\n  selectSelected,\n  selectGraph,\n  selectNodeDependencies,\n)\n\nexport const selectSearchResults = createSelector(\n  selectSearch,\n  selectGraph,\n  (query: string, graph: Graph): { label: string; value: string }[] => {\n    if (query.length < 2) return []\n    return Object.values(graph)\n      .filter(\n        ({ label }) => label.en.toLowerCase().includes(query.toLowerCase()),\n        //*|| uri.toLowerCase().includes(query.toLowerCase()),\n      )\n      .sort(\n        ({ dependents: a }, { dependents: b }) =>\n          Object.values(b).length - Object.values(a).length,\n      )\n      .map(({ uri, label: { en: label } }) => ({ value: uri, label }))\n      .slice(0, 10)\n  },\n)\n\nexport const selectSelectedNode = createSelector(\n  selectSelected,\n  selectGraph,\n  (uri, graph) => graph[uri],\n)\n\nexport default mathSlice.reducer\n","import {\n  login as solidLogin,\n  logout as solidLogout,\n  handleIncomingRedirect,\n} from '@inrupt/solid-client-authn-browser'\n\nexport const init = async () => {\n  const sessionInfo = await handleIncomingRedirect({\n    url: window.location.href,\n    restorePreviousSession: true,\n  })\n  return sessionInfo\n}\n\nexport const login = async (oidcIssuer: string) => {\n  try {\n    await solidLogin({\n      oidcIssuer,\n      redirectUrl: window.location.href,\n      clientName: 'Friends Crawler',\n    })\n  } catch (error) {\n    alert(`Could not find a Solid Pod at ${oidcIssuer}`)\n    localStorage.removeItem('idp')\n  }\n}\n\nexport const logout = async () => {\n  await solidLogout()\n}\n","import { createAsyncThunk, createSlice } from '@reduxjs/toolkit'\nimport { RootState } from '../../app/store'\nimport { addDocuments } from '../math/mathSlice'\nimport * as api from './loginAPI'\n\n// State\nexport interface LoginState {\n  webId: string\n  isLoggedIn: boolean\n  status: 'idle' | 'loading' | 'failed'\n}\n\nconst initialState: LoginState = {\n  webId: '',\n  isLoggedIn: false,\n  status: 'idle',\n}\n\n// Thunks\nexport const init = createAsyncThunk('login/init', async (_, { dispatch }) => {\n  const response = await api.init()\n  const webId = response?.webId ?? ''\n  const isLoggedIn = response?.isLoggedIn ?? false\n  dispatch(addDocuments(webId))\n  return { webId, isLoggedIn }\n})\n\nexport const login = createAsyncThunk(\n  'login/login',\n  async (oidcIssuer: string) => {\n    await api.login(oidcIssuer)\n  },\n)\n\nexport const logout = createAsyncThunk('login/logout', async () => {\n  await api.logout()\n})\n\n// Slice\nexport const loginSlice = createSlice({\n  name: 'login',\n  initialState,\n  reducers: {},\n  extraReducers: builder => {\n    builder\n      .addCase(init.pending, state => {\n        state.status = 'loading'\n      })\n      .addCase(init.fulfilled, (state, action) => {\n        state.status = 'idle'\n        state.webId = action.payload.webId\n        state.isLoggedIn = action.payload.isLoggedIn\n      })\n      .addCase(login.pending, state => {\n        state.status = 'loading'\n      })\n      .addCase(login.fulfilled, state => {\n        state.status = 'idle'\n      })\n      .addCase(logout.pending, state => {\n        state.status = 'loading'\n      })\n      .addCase(logout.fulfilled, () => {\n        return initialState\n      })\n  },\n})\n\n// Selectors\nexport const selectSession = (state: RootState) => ({\n  webId: state.login.webId,\n  isLoggedIn: state.login.isLoggedIn,\n})\n\nexport const selectLoginStatus = (state: RootState) => state.login.status\n\nexport default loginSlice.reducer\n","import React from 'react'\nimport LoginPrompt from './LoginPrompt'\nimport { useAppDispatch, useAppSelector } from '../../app/hooks'\nimport { login, logout, selectLoginStatus, selectSession } from './loginSlice'\n\ninterface Props {\n  className?: string\n}\n\nconst Login: React.FC<Props> = (\n  { className, ...props }: Props = { className: '' },\n) => {\n  const dispatch = useAppDispatch()\n  const info = useAppSelector(selectSession)\n  const status = useAppSelector(selectLoginStatus)\n\n  const commonProps = {\n    ...props,\n    className: `${className} button`,\n  }\n\n  return status === 'loading' ? (\n    <button {...commonProps} disabled>\n      Loading\n    </button>\n  ) : info.isLoggedIn ? (\n    <button {...commonProps} onClick={() => dispatch(logout())}>\n      {info.webId} Logout\n    </button>\n  ) : (\n    <LoginPrompt\n      {...commonProps}\n      onLogin={oidcIssuer => dispatch(login(oidcIssuer))}\n    />\n  )\n}\n\nexport default Login\n","import { Vector, Grid, VisualizationGraph } from '../types'\nimport numeric from 'numeric'\n\ntype Options = Partial<CanvasRenderingContext2D>\n\nconst drawText = (\n  context: CanvasRenderingContext2D,\n  [x, y]: Vector,\n  text: string,\n  options: Options,\n) => {\n  context.font = '20px Arial'\n  context.textBaseline = 'middle'\n  context.textAlign = 'left'\n  // context.fillStyle = '#fff7'\n  Object.assign(context, options)\n  context.fillText(text, x, y)\n}\n\nconst drawCircle = (\n  context: CanvasRenderingContext2D,\n  [x, y]: Vector,\n  radius: number,\n  options: Options,\n) => {\n  Object.assign(context, options)\n  context.beginPath()\n  context.arc(x, y, radius, 0, 2 * Math.PI)\n  context.fill()\n}\n\nconst drawLine = (\n  context: CanvasRenderingContext2D,\n  start: Vector,\n  end: Vector,\n  options: Options,\n) => {\n  Object.assign(context, options)\n\n  context.beginPath()\n  context.moveTo(...start)\n  context.lineTo(...end)\n  context.stroke()\n}\n\nexport const drawGraph = (\n  context: CanvasRenderingContext2D,\n  graph: VisualizationGraph,\n) => {\n  graph.links.forEach(link => {\n    // we're counting a unit vector to make links that don't overlap nodes\n    // source point\n    const s = [link.source.x, link.source.y]\n    // target point\n    const t = [link.target.x, link.target.y]\n    // vector\n    const v = numeric.sub(t, s)\n    // vector size\n    const size = Math.sqrt(v[0] ** 2 + v[1] ** 2)\n    // unit vector\n    const i = numeric.div(v, size)\n    drawLine(\n      context,\n      // links don't overlap circles\n      numeric.add(s, numeric.mul(i, link.source.r)) as Vector,\n      numeric.sub(t, numeric.mul(i, link.target.r)) as Vector,\n      {\n        strokeStyle: 'white',\n        lineWidth: 0.5,\n      },\n    )\n  })\n\n  const color = {\n    accent: 'violet',\n    focus: 'red',\n    focus2: 'pink',\n    rest: {\n      node: '#fff8',\n      label: '#fff4',\n    },\n  }\n\n  const accented = graph.nodes.filter(({ style }) => style === 'accent')\n  const focused = graph.nodes.filter(({ style }) => style === 'focus')\n  const focused2 = graph.nodes.filter(({ style }) => style === 'focus2')\n  const rest = graph.nodes.filter(({ style }) => !style)\n\n  // draw all the nodes which are not special\n  rest.forEach(({ x, y, r }) =>\n    drawCircle(context, [x, y], r, { fillStyle: color.rest.node }),\n  )\n\n  rest.forEach(({ x, y, r, label }) =>\n    drawText(context, [x + r + 5, y], label, {\n      fillStyle: color.rest.label,\n    }),\n  )\n\n  // draw focused nodes\n  focused2.forEach(({ x, y, r }) =>\n    drawCircle(context, [x, y], r, { fillStyle: color.focus2 }),\n  )\n\n  focused2.forEach(({ x, y, r, label }) =>\n    drawText(context, [x + r + 5, y], label, { fillStyle: color.focus2 }),\n  )\n\n  // draw focused nodes\n  focused.forEach(({ x, y, r }) =>\n    drawCircle(context, [x, y], r, { fillStyle: color.focus }),\n  )\n\n  focused.forEach(({ x, y, r, label }) =>\n    drawText(context, [x + r + 5, y], label, { fillStyle: color.focus }),\n  )\n\n  // draw accented nodes\n  accented.forEach(({ x, y, r }) =>\n    drawCircle(context, [x, y], r, { fillStyle: color.accent }),\n  )\n\n  accented.forEach(({ x, y, r, label }) =>\n    drawText(context, [x + r + 5, y], label, {\n      fillStyle: color.accent,\n    }),\n  )\n}\n\nexport const drawGrid = (\n  context: CanvasRenderingContext2D,\n  grid: Grid,\n  width: number,\n  height: number,\n  offset: Vector = [0, 0],\n) => {\n  const strokeStyle = '#fff2'\n  const min1 = -offset[1]\n  const max1 = height - offset[1]\n  const min0 = -offset[0]\n  const max0 = width - offset[0]\n\n  const getLineWidth = (i: number) =>\n    i === 0 ? 2 : i % grid.highlight === 0 ? 1 : 0.5\n\n  let i = 0\n  while (i * grid.distance + grid.origin[0] <= max0) {\n    const x = i * grid.distance + grid.origin[0]\n    if (x >= min0) {\n      drawLine(context, [x, min1], [x, max1], {\n        strokeStyle,\n        lineWidth: getLineWidth(i),\n      })\n    }\n    i++\n  }\n\n  i = -1\n  while (i * grid.distance + grid.origin[0] >= min0) {\n    const x = i * grid.distance + grid.origin[0]\n    if (x <= max0) {\n      drawLine(context, [x, min1], [x, max1], {\n        strokeStyle,\n        lineWidth: getLineWidth(i),\n      })\n    }\n    i--\n  }\n\n  i = 0\n  while (i * grid.distance + grid.origin[1] <= max1) {\n    const y = i * grid.distance + grid.origin[1]\n    if (y >= min1) {\n      drawLine(context, [min0, y], [max0, y], {\n        strokeStyle,\n        lineWidth: getLineWidth(i),\n      })\n    }\n    i++\n  }\n\n  i = -1\n  while (i * grid.distance + grid.origin[1] >= min1) {\n    const y = i * grid.distance + grid.origin[1]\n    if (y <= max1) {\n      drawLine(context, [min0, y], [max0, y], {\n        strokeStyle,\n        lineWidth: getLineWidth(i),\n      })\n    }\n    i--\n  }\n}\n","import {\n  forceSimulation,\n  forceCollide,\n  forceLink,\n  forceManyBody,\n  forceCenter,\n  forceX,\n  forceY,\n  ForceLink,\n} from 'd3-force'\nimport { Dictionary } from '../../../../app/types'\nimport forceGravity from './gravity'\nimport {\n  Coords,\n  SimulationNode,\n  SimulationLink,\n  Node,\n  SimulationNodeExt,\n  SimulationLinkExt,\n} from './types'\n\nexport default class Simulation {\n  nodes: SimulationNodeExt[] = []\n  links: SimulationLinkExt[] = []\n\n  runs = false\n\n  simulation = forceSimulation()\n    .alphaDecay(0.005)\n    .force(\n      'link',\n      forceLink()\n        .id(node => (node as SimulationNodeExt).uri)\n        .distance(50)\n        .strength(0.1),\n    )\n    .force('linkGravity', forceGravity().strength(50))\n    .force('charge', forceManyBody().strength(-150).distanceMax(500))\n    .force('gravityX', forceX(0).strength(0.01))\n    .force('gravityY', forceY(0).strength(0.01))\n    .force(\n      'collide',\n      forceCollide(({ r }: SimulationNodeExt) => r + 5),\n    )\n    .force('center', forceCenter(0, 0))\n    .stop()\n\n  start = ({\n    nodes,\n    links,\n    onTick,\n  }: {\n    nodes: SimulationNode[]\n    links: SimulationLink[]\n    onTick: (simulation: {\n      nodes: SimulationNode[]\n      links: SimulationLinkExt[]\n    }) => void\n  }) => {\n    this.nodes = nodes as SimulationNodeExt[]\n    this.links = links.map(link => ({ ...link })) as SimulationLinkExt[]\n\n    this.simulation.nodes(this.nodes)\n    ;(\n      this.simulation.force('link') as ForceLink<\n        SimulationNodeExt,\n        SimulationLinkExt\n      >\n    ).links(this.links)\n    ;(\n      this.simulation.force('linkGravity') as ForceLink<\n        SimulationNodeExt,\n        SimulationLinkExt\n      >\n    ).links(this.links)\n\n    this.simulation.on('tick', () => {\n      onTick({\n        nodes: this.nodes as SimulationNode[],\n        links: this.links,\n      })\n    })\n\n    this.simulation.restart()\n    this.runs = true\n  }\n\n  stop = () => {\n    this.runs = false\n    return this.simulation.stop()\n  }\n\n  update = ({ nodes, links }: { nodes: Node[]; links: SimulationLink[] }) => {\n    this.simulation.stop()\n    // combine current nodes and the old nodes\n    const thisNodeDict: Dictionary<SimulationNodeExt> = Object.fromEntries(\n      this.nodes.map(node => [node.uri, node]),\n    )\n    const updatedNodes: SimulationNodeExt[] = nodes.map(node => ({\n      ...node,\n      x: (0.5 - Math.random()) * 800,\n      y: (0.5 - Math.random()) * 800,\n      ...thisNodeDict[node.uri],\n      r: node.r,\n    }))\n    this.nodes = updatedNodes\n    this.links = links.map(link => ({ ...link })) as SimulationLinkExt[]\n\n    this.simulation.nodes(this.nodes)\n    ;(\n      this.simulation.force('link') as ForceLink<\n        SimulationNodeExt,\n        SimulationLinkExt\n      >\n    ).links(this.links)\n    ;(\n      this.simulation.force('linkGravity') as ForceLink<\n        SimulationNodeExt,\n        SimulationLinkExt\n      >\n    ).links(this.links)\n\n    this.simulation.alpha(1).restart()\n  }\n\n  selectNode = ({ x, y }: Coords) =>\n    this.simulation.find(x, y, 40) as SimulationNodeExt\n}\n","import { SimulationLinkExt } from './types'\n\nexport default function gravity() {\n  let links: SimulationLinkExt[] = []\n  let strength = 3\n  function force(alpha: number) {\n    const k = strength * alpha\n    links.forEach(function (d) {\n      //// this works\n      // d.source.y = Math.max(d.target.y + 50, d.source.y);\n      //// this is original\n      // d.source.vy += k;\n      // d.target.vy -= k;\n      //\n      //// this works with velocities, so the graph looks less layered\n      const { source, target } = d\n      if (typeof source === 'object' && typeof target === 'object') {\n        if (\n          source.y &&\n          target.y &&\n          source.vy &&\n          target.vy &&\n          source.y < target.y + 50\n        ) {\n          const optimumDifference = (target.y + 50 - source.y) / 50\n          source.vy += k * optimumDifference\n          target.vy -= k * optimumDifference\n        }\n      }\n    })\n  }\n\n  force.links = (_: SimulationLinkExt[]) => {\n    links = _\n    return force\n  }\n\n  force.strength = (_: number) => {\n    strength = _\n    return force\n  }\n\n  return force\n}\n","/*\n * based on the following example\n * https://github.com/rexxars/react-markdown/issues/10#issuecomment-347763068\n */\n\nimport React from 'react'\nimport 'katex/dist/katex.min.css'\nimport ReactMarkdown from 'react-markdown'\nimport remarkMath from 'remark-math'\nimport styled from 'styled-components'\nimport rehypeKatex from 'rehype-katex'\n\nconst Styler = styled.div`\n  img {\n    max-width: 100%;\n  }\n`\n\nexport default function Math({ children }: { children: string }) {\n  const props = {\n    children,\n    remarkPlugins: [remarkMath],\n    rehypePlugins: [rehypeKatex],\n  }\n  return (\n    <Styler>\n      <ReactMarkdown {...props} />\n    </Styler>\n  )\n}\n","import React from 'react'\nimport { GraphNode, highlight, select, selectSelectedNode } from './mathSlice'\nimport Math from './Math'\nimport { useAppDispatch, useAppSelector } from '../../app/hooks'\n\ninterface NodeListProps {\n  title: string\n  nodes: GraphNode[]\n}\n\nconst NodeList: React.FC<NodeListProps> = ({ title, nodes }: NodeListProps) => {\n  const dispatch = useAppDispatch()\n  return (\n    <>\n      <header className=\"card-header\">\n        <p className=\"card-header-title\">\n          {title}: {nodes.length}\n        </p>\n      </header>\n      <section className=\"card-content\">\n        <ul className=\"buttons are-small\">\n          {nodes.map(node => (\n            <li\n              onClick={() => dispatch(select(node.uri))}\n              onMouseEnter={() => dispatch(highlight(node.uri))}\n              onMouseLeave={() => dispatch(highlight(''))}\n              key={node.uri}\n              className=\"button is-link is-inverted\"\n            >\n              {node.label.en}\n            </li>\n          ))}\n        </ul>\n      </section>\n    </>\n  )\n}\n\nconst Statement = () => {\n  const dispatch = useAppDispatch()\n  const onSelectNode = (uri: string) => dispatch(select(uri))\n  const node = useAppSelector(selectSelectedNode)\n\n  const dependencies: GraphNode[] = Object.values(node.dependencies)\n  const dependents: GraphNode[] = Object.values(node.dependents)\n\n  return (\n    <div className=\"card\">\n      <header className=\"card-header\">\n        <p className=\"card-header-title\">\n          <a href={node.uri}>{node.label.en}</a>\n        </p>\n        <span className=\"card-header-icon\">\n          <button\n            className=\"delete\"\n            aria-label=\"close\"\n            onClick={() => onSelectNode('')}\n          >\n            close\n          </button>\n        </span>\n      </header>\n      <section className=\"card-content\">\n        <Math>{node.description.en}</Math>\n      </section>\n      <NodeList title=\"dependencies\" nodes={dependencies} />\n      <NodeList title=\"dependents\" nodes={dependents} />\n    </div>\n  )\n}\n\nexport default Statement\n","import React from 'react'\nimport { useAppDispatch, useAppSelector } from '../../app/hooks'\nimport {\n  highlight,\n  select,\n  selectSearch,\n  selectSearchResults,\n  setSearch,\n} from './mathSlice'\n\nconst Search: React.FC = ({ ...props }) => {\n  const value = useAppSelector(selectSearch)\n  const options = useAppSelector(selectSearchResults)\n  const dispatch = useAppDispatch()\n\n  return (\n    <div {...props} className=\"box p-0\">\n      <input\n        type=\"text\"\n        className=\"input\"\n        placeholder=\"Search\"\n        value={value}\n        onChange={e => dispatch(setSearch(e.target.value))}\n      />\n      <div className=\"menu\">\n        <ul className=\"menu-list\">\n          {options.map(({ value, label }) => (\n            <li\n              key={value}\n              title={value}\n              onMouseEnter={() => dispatch(highlight(value))}\n              onMouseLeave={() => dispatch(highlight(''))}\n            >\n              <a\n                onClick={() => {\n                  dispatch(select(value))\n                  dispatch(setSearch(''))\n                }}\n              >\n                {label}\n              </a>\n            </li>\n          ))}\n        </ul>\n      </div>\n    </div>\n  )\n}\n\nexport default Search\n","import React from 'react'\nimport styled from 'styled-components'\n\nconst ICOutside = styled.div`\n  position: fixed;\n  width: 100%;\n  top: 0;\n  bottom: 0;\n  pointer-events: none;\n  overflow-x: hidden;\n  overflow-y: auto;\n`\nconst ICInside = styled.div`\n  pointer-events: all;\n  overflow-x: auto;\n  width: 100%;\n`\n\nconst InfoContainer = ({ children }: { children: React.ReactNode }) => (\n  <ICOutside>\n    <div className=\"columns mr-1 mt-6\">\n      <div className=\"column is-one-quarter is-offset-three-quarters\">\n        <ICInside>{children}</ICInside>\n      </div>\n    </div>\n  </ICOutside>\n)\n\nexport default InfoContainer\n","import { Grid, Matrix, Vector } from '../types'\nimport { VisualizationGraph } from '../types'\nimport { GraphNode } from '../../mathSlice'\nimport { SimulationGraph } from '../simulation/types'\nimport numeric from 'numeric'\n\nexport const transform = (matrix: Matrix, vector: Vector): Vector => {\n  const raw = numeric.dot(matrix, numeric.transpose([[...vector, 1]])) as Matrix\n  const [[x], [y]] = raw\n  return [x, y]\n}\n\nexport const nodeRadius = (node: GraphNode): number => {\n  let count = Object.entries(node.dependents).length ?? 0\n  count = count < 1 ? 1 : count\n  return count ** 0.42 * 5\n}\n\nexport const basicGrid: Grid = {\n  origin: [0, 0],\n  distance: 20,\n  highlight: 5,\n}\n\nexport const transformGrid = (matrix: Matrix, grid: Grid): Grid => {\n  let distance = grid.distance * matrix[0][0]\n  while (distance < 20) {\n    distance *= 5\n  }\n  return {\n    origin: transform(matrix, grid.origin),\n    distance,\n    highlight: grid.highlight,\n  }\n}\n\nexport const transformLayout = (\n  matrix: Matrix,\n  graph: SimulationGraph,\n  highlighted: string,\n  selected: string,\n  selectedDependencies: string[],\n): VisualizationGraph => {\n  const transformedNodesDict = Object.fromEntries(\n    graph.nodes.map(node => {\n      const [x, y] = transform(matrix, [node.x, node.y])\n      const r = matrix[0][0] * node.r\n      return [node.uri, { ...node, x, y, r, style: '' }]\n    }),\n  )\n\n  selectedDependencies.forEach(\n    uri => (transformedNodesDict[uri].style = 'focus2'),\n  )\n\n  if (highlighted) {\n    transformedNodesDict[highlighted].style = 'accent'\n  }\n\n  if (selected) {\n    transformedNodesDict[selected].style = 'focus'\n  }\n\n  const links = graph.links.map(link => {\n    const sourceUri =\n      typeof link.source === 'string'\n        ? link.source\n        : typeof link.source === 'number'\n        ? graph.nodes[link.source].uri\n        : link.source.uri\n    const targetUri =\n      typeof link.target === 'string'\n        ? link.target\n        : typeof link.target === 'number'\n        ? graph.nodes[link.target].uri\n        : link.target.uri\n    const source = transformedNodesDict[sourceUri]\n    const target = transformedNodesDict[targetUri]\n    return { source, target }\n  })\n\n  return { nodes: Object.values(transformedNodesDict), links }\n}\n","import React, { useEffect, useState } from 'react'\nimport Visualization from './Visualization'\nimport {\n  highlight,\n  select,\n  selectHighlighted,\n  selectSelected,\n  selectSelectedNodeDependencies,\n} from '../mathSlice'\nimport Simulation from './simulation'\nimport { SimulationGraph, SimulationLink } from './simulation/types'\nimport { Matrix, Vector } from './types'\nimport numeric from 'numeric'\nimport Statement from '../Statement'\nimport Search from '../Search'\nimport { useAppDispatch, useAppSelector } from '../../../app/hooks'\nimport { selectPrunedGraph } from '../mathSlice'\nimport InfoContainer from '../InfoContainer'\nimport {\n  basicGrid,\n  nodeRadius,\n  transform,\n  transformGrid,\n  transformLayout,\n} from './helpers/transform'\n\nconst VisualizationContainer: React.FC = props => {\n  const prunedGraph = useAppSelector(selectPrunedGraph)\n  const highlightedNode = useAppSelector(selectHighlighted)\n  const selectedNode = useAppSelector(selectSelected)\n  const selectedNodeDependencies = useAppSelector(\n    selectSelectedNodeDependencies,\n  )\n  const dispatch = useAppDispatch()\n\n  const [simulation] = useState(new Simulation())\n  const [layout, setLayout] = useState<SimulationGraph>({\n    nodes: [],\n    links: [],\n  })\n  // transformation matrix\n  const [matrix, setMatrix] = useState<Matrix>([\n    [1, 0, 0],\n    [0, 1, 0],\n    [0, 0, 1],\n  ])\n\n  // initialize simulation\n  useEffect(() => {\n    let lastUpdate = Date.now() - 20\n    simulation.start({\n      nodes: [],\n      links: [],\n      onTick: ({ nodes, links }) => {\n        const now = Date.now()\n        if (now > lastUpdate + 20) {\n          setLayout({ nodes: [...nodes], links: [...links] })\n          lastUpdate = now\n        }\n      },\n    })\n    return () => {\n      simulation.stop()\n    }\n  }, [simulation])\n\n  // when graph changes, update simulation\n  useEffect(() => {\n    const nodes = Object.values(prunedGraph).map(node => ({\n      label: node.label.en,\n      x: Math.random() * 400,\n      y: Math.random() * 400,\n      r: nodeRadius(node),\n      uri: node.uri,\n    }))\n\n    const links: SimulationLink[] = Object.values(prunedGraph).reduce(\n      (links, { uri: source, dependencies }) => {\n        Object.keys(dependencies).forEach(target =>\n          links.push({ source, target }),\n        )\n        return links\n      },\n      [] as SimulationLink[],\n    )\n\n    simulation.update({ nodes, links })\n  }, [prunedGraph, simulation])\n\n  const handleTransform = (matrix: Matrix): void => {\n    setMatrix(prevMatrix => numeric.dot(matrix, prevMatrix) as Matrix)\n  }\n\n  const withNode = (action: (uri: string) => unknown) => {\n    return (position: Vector): void => {\n      // first transform to local coordinates\n      const [x, y] = transform(numeric.inv(matrix), position)\n      // then find the node in simulation\n      action(simulation.selectNode({ x, y })?.uri)\n    }\n  }\n\n  const handleHover = withNode(uri => dispatch(highlight(uri)))\n  const handleSelect = withNode(uri => dispatch(select(uri)))\n\n  // transform layout to TransformedLayout\n  const transformedLayout = transformLayout(\n    matrix,\n    layout,\n    highlightedNode,\n    selectedNode,\n    selectedNodeDependencies,\n  )\n\n  const grid = transformGrid(matrix, basicGrid)\n\n  return (\n    <>\n      <Visualization\n        graph={transformedLayout}\n        grid={grid}\n        onTransform={handleTransform}\n        onHover={handleHover}\n        onSelectNode={handleSelect}\n        {...props}\n      />\n\n      {\n        // @TODO maybe move this stuff out, it's more of a Layout component\n      }\n      <InfoContainer>{selectedNode ? <Statement /> : <Search />}</InfoContainer>\n    </>\n  )\n}\n\nexport default VisualizationContainer\n","import React from 'react'\nimport styled from 'styled-components'\n\nconst Link = styled.a`\n  color: lightgray;\n  &:hover {\n    color: white;\n  }\n`\nconst Footer = styled.footer`\n  color: gray;\n`\n\nconst About: React.FC = props => (\n  <div {...props}>\n    <Footer>\n      powered by <Link href=\"https://solidproject.org\">Solid</Link> &middot;{' '}\n      <Link href=\"https://github.com/livegraph-org/solid-math\">source</Link>\n    </Footer>\n  </div>\n)\n\nexport default About\n","import React from 'react'\nimport Login from '../features/login/Login'\nimport VisualizationContainer from '../features/math/visualization/VisualizationContainer'\nimport styled from 'styled-components'\nimport About from './About'\n\nconst PositionedLogin = styled(Login)`\n  position: fixed;\n  top: 1rem;\n  right: 1rem;\n  display: block;\n`\n\nconst PositionedAbout = styled(About)`\n  position: fixed;\n  bottom: 1rem;\n  right: 1rem;\n`\n\nconst FullSizeVisualization = styled(VisualizationContainer)`\n  height: 100vh;\n  width: 100vw;\n  display: block;\n`\n\nconst Layout: React.FC = () => {\n  return (\n    <>\n      <PositionedLogin />\n\n      <PositionedAbout />\n\n      <FullSizeVisualization />\n    </>\n  )\n}\n\nexport default Layout\n","import React, { useEffect } from 'react'\nimport Layout from './components/Layout'\nimport { init as initLogin } from './features/login/loginSlice'\nimport { useAppDispatch } from './app/hooks'\n\nconst App: React.FC = () => {\n  const dispatch = useAppDispatch()\n  useEffect(() => {\n    dispatch(initLogin())\n  }, [dispatch])\n\n  return <Layout />\n}\n\nexport default App\n","import { configureStore, ThunkAction, Action } from '@reduxjs/toolkit'\nimport loginReducer from '../features/login/loginSlice'\nimport mathReducer from '../features/math/mathSlice'\n\nexport const store = configureStore({\n  reducer: {\n    login: loginReducer,\n    math: mathReducer,\n  },\n})\n\nexport type AppDispatch = typeof store.dispatch\nexport type RootState = ReturnType<typeof store.getState>\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>\n","import { ReportHandler } from 'web-vitals'\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry)\n      getFID(onPerfEntry)\n      getFCP(onPerfEntry)\n      getLCP(onPerfEntry)\n      getTTFB(onPerfEntry)\n    })\n  }\n}\n\nexport default reportWebVitals\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.scss'\nimport App from './App'\nimport { store } from './app/store'\nimport reportWebVitals from './reportWebVitals'\nimport { Provider } from 'react-redux'\nimport Modal from 'react-modal'\n\nif (typeof document === 'object') {\n  const appElement = document.querySelector('#root') as HTMLElement\n\n  Modal.setAppElement(appElement)\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root'),\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}